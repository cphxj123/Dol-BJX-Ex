:: Transformation Widgets [widget]

<<widget "setupTransformationPiecesObject">>
	<<if $transformationParts is undefined>>
		<<set $transformationParts to {
			traits: {fangs:"disabled", sharpEyes:"disabled", mateForLife:"disabled", flaunting:"disabled"},
			angel: {halo:"disabled", wings:"disabled"},
			fallenAngel: {halo:"disabled", wings:"disabled"},
			demon: {horns:"disabled", wings:"disabled", tail: "disabled"},
			cat: {ears:"disabled", tail:"disabled", heterochromia:"disabled"},
			cow: {horns:"disabled", ears:"disabled", tail:"disabled"},
			wolf: {ears:"disabled", tail:"disabled", pubes:"disabled", pits:"disabled"},
			bird: {tail:"disabled", wings:"disabled", eyes:"disabled", malar:"disabled", plumage:"disabled", pubes:"disabled"},
			fox: {ears:"disabled", tail:"disabled", cheeks:"disabled"},
		}>>
		/* 北极星模组 */
		<<run $.extend($transformationParts.traits, {lungs:"disabled", incognito:"disabled", aquatic:"disabled", vigorous:"disabled", webbedfeet:"disabled", kicks:"disabled", longtongue:"disabled", strongnose:"disabled", bearbuild:"disabled"})>>
		<<run $.extend($transformationParts, {
			bee: {ears:"disabled", tail:"disabled", wings:"disabled"},
			sheep: {ears:"disabled", tail:"disabled", horns:"disabled"},
			deer: {ears:"disabled", tail:"disabled", horns:"disabled"},
			bear: {ears:"disabled", tail:"disabled"},
			dragon: {tail:"disabled", wings:"disabled", eyes:"disabled", horns:"disabled", claws:"disabled"},
			lizard: {horns:"disabled", tail:"disabled", eyes:"disabled"},
			dolphin: {tail:"disabled"},
			dog: {ears:"disabled", tail:"disabled"},
			raccoon: {mask:"disabled", ears: "disabled", tail: "disabled"},
			fish: {fins:"disabled", tail:"disabled"},
			horse: {ears:"disabled", tail:"disabled"},
			frog: {eyes:"disabled", cheeks: "disabled"},
			spider: {eyes:"disabled", tail:"disabled"},
			pig: {ears:"disabled", tail:"disabled"},
			ghost: {eyes:"disabled", hitodama:"disabled", mist:"disabled"},
			slime: {bubble:"disabled", stream:"disabled", core:"disabled"},
			mushroom: {cap:"disabled", eyes:"disabled", spores:"disabled", mushrooms:"disabled"},
		})>>
		/* 北极星 */
		<<if $specialTransform is 1>>
			<<if $angel gte 4>>
				<<set $transformationParts.angel.halo to "default">>
			<</if>>
			<<if $angel gte 6>>
				<<set $transformationParts.angel.wings to "default">>
			<</if>>
			<<if $fallenangel gte 2>>
				<<set $transformationParts.fallenAngel.halo to "default">>
				<<set $transformationParts.fallenAngel.wings to "default">>
			<</if>>
			<<if $demon gte 2>>
				<<set $transformationParts.demon.horns to "default">>
			<</if>>
			<<if $demon gte 4>>
				<<set $transformationParts.demon.tail to "default">>
			<</if>>
			<<if $demon gte 6>>
				<<set $transformationParts.demon.wings to "default">>
			<</if>>
		<</if>>
		<<if $physicalTransform is 1>>
			<<if $wolfgirl gte 2>>
				<<set $transformationParts.traits.fangs to "default">>
			<</if>>
			<<if $wolfgirl gte 4>>
				<<set $transformationParts.wolf.ears to "default">>
				<<set $transformationParts.wolf.pubes to "default">>
				<<set $transformationParts.wolf.pits to "default">>
			<</if>>
			<<if $wolfgirl gte 6>>
				<<set $transformationParts.wolf.tail to "default">>
			<</if>>
			<<if $cat gte 2>>
				<<set $transformationParts.traits.fangs to "default">>
			<</if>>
			<<if $cat gte 4>>
				<<set $transformationParts.cat.ears to "default">>
			<</if>>
			<<if $cat gte 6>>
				<<set $transformationParts.cat.tail to "default">>
			<</if>>
			<<if $cat gte 7>>
				<<set $transformationParts.cat.heterochromia to "default">>
			<</if>>
			<<if $cow gte 2>>
				<<set $transformationParts.cow.horns to "default">>
			<</if>>
			<<if $cow gte 4>>
				<<set $transformationParts.cow.ears to "default">>
			<</if>>
			<<if $cow gte 6>>
				<<set $transformationParts.cow.tail to "default">>
		    <</if>>
		<</if>>
	<</if>>
	<<if $transformationParts.fallenAngel.halo is 1>>
		<<set $transformationParts.fallenAngel.halo to "default">>
		<<set $transformationParts.fallenAngel.wings to "default">>
	<</if>>
	<<if $transformationParts.demon.horns is 1>>
		<<set $transformationParts.demon.horns to "default">>
		<<set $transformationParts.demon.tail to "default">>
		<<set $transformationParts.demon.wings to "default">>
	<</if>>
	<<if $angel lt 4>>
		<<set $transformationParts.angel.halo to "disabled">>
	<</if>>
	<<if $angel lt 6>>
		<<set $transformationParts.angel.wings to "disabled">>
	<</if>>
	<<if $fallenangel is 1>>
		<<set $transformationParts.fallenAngel.halo to "disabled">>
		<<set $transformationParts.fallenAngel.wings to "disabled">>
	<</if>>
	<<if $transformationParts.wolf.cheeks is undefined>>
		<<if $wolfgirl gte 6>>
		    /* 北极星模组 */
			<<set $transformationParts.wolf.cheeks to "feral">>
			/* 北极星 */
		<<else>>
			<<set $transformationParts.wolf.cheeks to "disabled">>
		<</if>>
	<</if>>
	<<if $transformationParts.bird is undefined>>
		<<set $transformationParts.bird to {tail:"disabled", wings:"disabled", eyes:"disabled", malar:"disabled", plumage:"disabled"}>>
	<</if>>
	<<if $transformationParts.bird.pubes is undefined>>
		<<if $harpy gte 6>>
			<<set $transformationParts.bird.pubes to "hidden">>
		<<else>>
			<<set $transformationParts.bird.pubes to "disabled">>
		<</if>>
	<</if>>
	<<if $transformationParts.fox is undefined>>
		<<set $transformationParts.fox to {ears:"disabled", tail:"disabled", cheeks:"disabled"}>>
	<</if>>
	<<if $transformationParts.traits is undefined>>
		<<set $transformationParts.traits to {fangs:"disabled", sharpEyes:"disabled", mateForLife:"disabled", flaunting:"disabled"}>>
		/* 北极星模组 */
		<<run $.extend($transformationParts.traits, {lungs:"disabled", incognito:"disabled", aquatic:"disabled", vigorous:"disabled", webbedfeet:"disabled", kicks:"disabled", longtongue:"disabled", strongnose:"disabled", bearbuild:"disabled"})>>
		/* 北极星 */
		<<if $wolfgirl gte 2 or $cat gte 2 or $fox gte 2>>
			<<set $transformationParts.traits.fangs to "default">>
		<</if>>
		<<if $cat gte 2 or $harpy gte 2 or $fox gte 2>>
			<<set $transformationParts.traits.sharpEyes to "default">>
		<</if>>
	<</if>>
	/* Setup chimera's config */
	<<set _defaultChimeraConfig to {
		demoncat: {
			tail: true
		},
		demoncow: {
			horns: true
		},
		demonharpy: {
			wings: true
		},
	}>>
	/* Convert chimera obj back to an object if it was something else. Necessary for object.assign next. */
	<<if typeof $chimera !== 'object'>>
		<<set $chimera to {}>>
	<</if>>
	/* Takes default object, and transposes chimera config ontop of it, assigning the result to chimera config. */
	<<set $chimera to Object.assign(_defaultChimeraConfig, $chimera || {})>>
<</widget>>

/* 北极星模组 */
<<widget "toggleTransform">>
    <<set $countTransform to 0>>
    <<if $wolf gte 1 or $cat gte 1 or $harpy gte 1 or $cow gte 1 or $fox gte 1 or $sheep gte 1 or $bee gte 1 or $deer gte 1 or $bear gte 1 or $dragon gte 1 or $lizard gte 1 or $dolphin gte 1 or $dog gte 1 or $raccoon gte 1 or $fish gte 1 or $horse gte 1 or $pig gte 1 or $spider gte 1 or $frog gte 1>>
		<<set $physicalTransform to 1>>
		<<set $countTransform = $countTransform + ($wolf gte 1 ? 1:0) + ($cat gte 1 ? 1:0) + ($harpy gte 1 ? 1:0) + ($cow gte 1 ? 1:0) + ($fox gte 1 ? 1:0) + ($sheep gte 1 ? 1:0) + ($bee gte 1 ? 1:0) + ($deer gte 1 ? 1:0) + ($bear gte 1 ? 1:0) + ($dragon gte 1 ? 1:0) + ($lizard gte 1 ? 1:0) + ($dolphin gte 1 ? 1:0) + ($dog gte 1 ? 1:0) + ($raccoon gte 1 ? 1:0) + ($fish gte 1 ? 1:0) + ($horse gte 1 ? 1:0) + ($pig gte 1 ? 1:0) + ($spider gte 1 ? 1:0) + ($frog gte 1 ? 1:0)>>
	<<else>>
		<<set $physicalTransform to 0>>
	<</if>>
	<<if $angel gte 1 or $fallenangel gte 2 or $demon gte 1 or $demonhunter gte 2>>
		<<set $specialTransform to 1>>
	<<else>>
		<<set $specialTransform to 0>>
	<</if>>
	<<if $slime gte 1 or $ghost gte 1 or $mushroom gte 1>>
		<<set $eventTransform to 1>>
	<<else>>
		<<set $eventTransform to 0>>
	<</if>>
<</widget>>
/* 北极星 */

<<widget "transform">>/*First arg is transformation, second is the intensity of change.*/
	<<if _args[1]>>
		<<switch _args[0]>>
			<<case "wolf">>  <<set $wolfbuild  = Math.clamp($wolfbuild  + _args[1], 0, 100)>>
			<<case "cat">>   <<set $catbuild   = Math.clamp($catbuild   + _args[1], 0, 100)>>
			<<case "cow">>   <<set $cowbuild   = Math.clamp($cowbuild   + _args[1], 0, 100)>>
			<<case "bird">>  <<set $birdbuild  = Math.clamp($birdbuild  + _args[1], 0, 100)>>
			<<case "fox">>   <<set $foxbuild   = Math.clamp($foxbuild   + _args[1], 0, 100)>>
			<<case "angel">> <<set $angelbuild = Math.clamp($angelbuild + _args[1], 0, 100)>>
			<<case "fallen">> <<set $fallenbuild = Math.clamp($fallenbuild + _args[1], 0, 100)>>
			<<case "demon">> <<set $demonbuild = Math.clamp($demonbuild + _args[1], 0, 100)>>
			/* 北极星模组 */
			<<case "hunter">> <<set $hunterbuild = Math.clamp($hunterbuild + _args[1], 0, 100)>>
			<<case "bee">> <<set $beebuild = Math.clamp($beebuild + _args[1], 0, 100)>>
			<<case "sheep">> <<set $sheepbuild = Math.clamp($sheepbuild + _args[1], 0, 100)>>
			<<case "deer">> <<set $deerbuild = Math.clamp($deerbuild + _args[1], 0, 100)>>
			<<case "bear">> <<set $bearbuild = Math.clamp($bearbuild + _args[1], 0, 100)>>
			<<case "dragon">> <<set $dragonbuild = Math.clamp($dragonbuild + _args[1], 0, 100)>>
			<<case "lizard">> <<set $lizardbuild = Math.clamp($lizardbuild + _args[1], 0, 100)>>
			<<case "dolphin">> <<set $dolphinbuild = Math.clamp($dolphinbuild + _args[1], 0, 100)>>
			<<case "dog">> <<set $dogbuild = Math.clamp($dogbuild + _args[1], 0, 100)>>
			<<case "raccoon">> <<set $raccoonbuild = Math.clamp($raccoonbuild + _args[1], 0, 100)>>
			<<case "fish">> <<set $fishbuild = Math.clamp($fishbuild + _args[1], 0, 100)>>
			<<case "horse">> <<set $horsebuild = Math.clamp($horsebuild + _args[1], 0, 100)>>
			<<case "spider">> <<set $spiderbuild = Math.clamp($spiderbuild + _args[1], 0, 100)>>
			<<case "frog">> <<set $frogbuild = Math.clamp($frogbuild + _args[1], 0, 100)>>
			<<case "pig">> <<set $pigbuild = Math.clamp($pigbuild + _args[1], 0, 100)>>
			/* 北极星 */
		<</switch>>
	<</if>>
	/* 北极星模组 */
	<<if !["angel", "demon", "fallen", "hunter"].includes(_args[0]) and _args[1] gte 1>>
	    <<set _protects to []>>
	    <<for _active_clothes range Object.keys($worn)>>
			<<if $worn[_active_clothes].type.includes("eerie") and $worn[_active_clothes].eerie isnot undefined>>
				<<set _protects to _protects.concat($worn[_active_clothes].eerie)>>
			<</if>>
		<</for>>
		<<if _args[0] isnot "wolf" and !_protects.includes("wolf")>>
			<<set $wolfbuild = Math.clamp($wolfbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "cat" and !_protects.includes("cat")>>
			<<set $catbuild  = Math.clamp($catbuild  - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "cow" and !_protects.includes("cow")>>
			<<set $cowbuild  = Math.clamp($cowbuild  - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "bird" and !_protects.includes("bird")>>
			<<set $birdbuild = Math.clamp($birdbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "fox" and !_protects.includes("fox")>>
			<<set $foxbuild = Math.clamp($foxbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "bee" and !_protects.includes("bee")>>
			<<set $beebuild = Math.clamp($beebuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "sheep" and !_protects.includes("sheep")>>
			<<set $sheepbuild = Math.clamp($sheepbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "deer" and !_protects.includes("deer")>>
			<<set $deerbuild = Math.clamp($deerbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "bear" and !_protects.includes("bear")>>
			<<set $bearbuild = Math.clamp($bearbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "dragon" and !_protects.includes("dragon")>>
			<<set $dragonbuild = Math.clamp($dragonbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "lizard" and !_protects.includes("lizard")>>
			<<set $lizardbuild = Math.clamp($lizardbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "dolphin" and !_protects.includes("dolphin")>>
			<<set $dolphinbuild = Math.clamp($dolphinbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "dog" and !_protects.includes("dog")>>
			<<set $dogbuild = Math.clamp($dogbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "raccoon" and !_protects.includes("raccoon")>>
			<<set $raccoonbuild = Math.clamp($raccoonbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "fish" and !_protects.includes("fish")>>
			<<set $fishbuild = Math.clamp($fishbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "horse" and !_protects.includes("horse")>>
			<<set $horsebuild = Math.clamp($horsebuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "spider" and !_protects.includes("spider")>>
			<<set $spiderbuild = Math.clamp($spiderbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "frog" and !_protects.includes("frog")>>
			<<set $frogbuild = Math.clamp($frogbuild - _args[1], 0, 100)>>
		<</if>>
		<<if _args[0] isnot "pig" and !_protects.includes("pig")>>
			<<set $pigbuild = Math.clamp($pigbuild - _args[1], 0, 100)>>
		<</if>>
	<</if>>
	/* 北极星 */
<</widget>>


<<widget "transformationStateUpdate">>
    /* 北极星模组 */
    <<toggleTransform>>
    <<set _protects to []>>
    <<for _active_clothes range Object.keys($worn)>>
		<<if $worn[_active_clothes].type.includes("eerie") and $worn[_active_clothes].eerie isnot undefined>>
			<<set _protects to _protects.concat($worn[_active_clothes].eerie)>>
		<</if>>
	<</for>>
	
	<<if $wolfbuild gte 1 and playerNormalPregnancyType() isnot "wolf" and !_protects.includes("wolf")>>
		<<transform wolf `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $catbuild gte 1 and playerNormalPregnancyType() isnot "cat" and !_protects.includes("cat")>>
		<<transform cat `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $cowbuild gte 1 and playerNormalPregnancyType() isnot "cow" and !_protects.includes("cow")>>
		<<transform cow `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $birdbuild gte 1 and playerNormalPregnancyType() isnot "bird" and !_protects.includes("bird")>>
		<<transform bird `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $foxbuild gte 1 and playerNormalPregnancyType() isnot "fox" and !_protects.includes("fox")>>
		<<transform fox `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>
	
    <<if $sheepbuild gte 1 and playerNormalPregnancyType() isnot "sheep" and !_protects.includes("sheep")>>
		<<transform sheep `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $beebuild gte 1 and playerNormalPregnancyType() isnot "bee" and !_protects.includes("bee")>>
		<<transform bee `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $deerbuild gte 1 and playerNormalPregnancyType() isnot "deer" and !_protects.includes("deer")>>
		<<transform deer `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $bearbuild gte 1 and playerNormalPregnancyType() isnot "bear" and !_protects.includes("bear")>>
		<<transform bear `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $dragonbuild gte 1 and playerNormalPregnancyType() isnot "dragon" and !_protects.includes("dragon")>>
		<<transform dragon `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $lizardbuild gte 1 and playerNormalPregnancyType() isnot "lizard" and !_protects.includes("lizard")>>
		<<transform lizard `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $dolphinbuild gte 1 and playerNormalPregnancyType() isnot "dolphin" and !_protects.includes("dolphin")>>
		<<transform dolphin `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $raccoonbuild gte 1 and playerNormalPregnancyType() isnot "raccoon" and !_protects.includes("raccoon")>>
		<<transform raccoon `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $fishbuild gte 1 and playerNormalPregnancyType() isnot "fish" and !_protects.includes("fish")>>
		<<transform fish `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $horsebuild gte 1 and playerNormalPregnancyType() isnot "horse" and !_protects.includes("horse")>>
		<<transform horse `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $spiderbuild gte 1 and playerNormalPregnancyType() isnot "spider" and !_protects.includes("spider")>>
		<<transform spider `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $frogbuild gte 1 and playerNormalPregnancyType() isnot "frog" and !_protects.includes("frog")>>
		<<transform frog `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $pigbuild gte 1 and playerNormalPregnancyType() isnot "pig" and !_protects.includes("pig")>>
		<<transform pig `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>

	<<if $dogbuild gte 1 and playerNormalPregnancyType() isnot "dog" and !_protects.includes("dog")>>
		<<transform dog `-($options.bjx_animal ? $countTransform : 1)`>>
	<</if>>
	
	<<if $wolfgirl gte 6 and !$options.bjx_animal>>
		<<def 5>>
	<</if>>

	<<transformationAlteration>>

	<<toggleTransform>>
	
	/* 北极星 */
<</widget>>

<<widget "transformationAlteration">>
	<<if $transformdisabledivine is "f">>
		<<if ($demonbuild gte 5 and $specialTransform isnot 1) or ($demon gte 1 and $specialTransform is 1)>>
			<<demonTransform $demon>>
			/* 北极星模组 */
			<<if $demonhunter gte 2>>
			    <<hunterButNotOut $demonhunter>>
			<</if>>
			/* 北极星 */
		<<elseif ($angelbuild gte 5 and $specialTransform isnot 1) or ($angel gte 1 and $specialTransform is 1)>>
			<<angelTransform $angel>>
 		<<elseif $fallenangel gte 2>>
			<<fallenButNotOut $fallenangel>>
		<</if>>
	<</if>>

	<<if $transformdisable is "f">>
	    /* 北极星模组 */
		<<if ($wolfbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($wolfgirl gte 1 and $physicalTransform is 1)>>
			<<wolfTransform $wolfgirl>>
		<</if>>
		<<if ($catbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($cat gte 1 and $physicalTransform is 1)>>
			<<catTransform $cat>>
		<</if>>
		<<if ($cowbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($cow gte 1 and $physicalTransform is 1)>>
			<<cowTransform $cow>>
		<</if>>
		<<if ($birdbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($harpy gte 1 and $physicalTransform is 1)>>
			<<harpyTransform $harpy>>
		<</if>>
		<<if ($foxbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($fox gte 1 and $physicalTransform is 1)>>
			<<foxTransform $fox>>
		<</if>>
		<<if ($beebuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($bee gte 1 and $physicalTransform is 1)>>
			<<beeTransform $bee>>
		<</if>>
		<<if ($sheepbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($sheep gte 1 and $physicalTransform is 1)>>
			<<sheepTransform $sheep>>
		<</if>>
		<<if ($deerbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($deer gte 1 and $physicalTransform is 1)>>
			<<deerTransform $deer>>
		<</if>>
		<<if ($bearbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($bear gte 1 and $physicalTransform is 1)>>
			<<bearTransform $bear>>
		<</if>>
		<<if ($dragonbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($dragon gte 1 and $physicalTransform is 1)>>
			<<dragonTransform $dragon>>
		<</if>>
		<<if ($lizardbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($lizard gte 1 and $physicalTransform is 1)>>
			<<lizardTransform $lizard>>
		<</if>>
		<<if ($dolphinbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($dolphin gte 1 and $physicalTransform is 1)>>
			<<dolphinTransform $dolphin>>
		<</if>>
		<<if ($dogbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($dog gte 1 and $physicalTransform is 1)>>
			<<dogTransform $dog>>
		<</if>>
		<<if ($fishbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($fish gte 1 and $physicalTransform is 1)>>
			<<fishTransform $fish>>
		<</if>>
		<<if ($raccoonbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($raccoon gte 1 and $physicalTransform is 1)>>
			<<raccoonTransform $raccoon>>
		<</if>>
		<<if ($horsebuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($horse gte 1 and $physicalTransform is 1)>>
			<<horseTransform $horse>>
		<</if>>
		<<if ($spiderbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($spider gte 1 and $physicalTransform is 1)>>
			<<spiderTransform $spider>>
		<</if>>
		<<if ($frogbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($frog gte 1 and $physicalTransform is 1)>>
			<<frogTransform $frog>>
		<</if>>
		<<if ($pigbuild gte 5 and ($physicalTransform isnot 1 or $options.bjx_animal)) or ($pig gte 1 and $physicalTransform is 1)>>
			<<pigTransform $pig>>
		<</if>>
		/* 北极星 */
	<</if>>
<</widget>>

<<widget "hirsuteHideCheck">>
	<<if $pbdisable is "t" and !["hidden", "disabled"].includes($transformationParts.wolf.pubes)>>
		<<set $transformationParts.wolf.pubes to "hidden">>
	<</if>>
	<<if $pbdisable is "t" and !["hidden", "disabled"].includes($transformationParts.wolf.pits)>>
		<<set $transformationParts.wolf.pits to "hidden">>
	<</if>>
	<<if $pbdisable is "t" and !["hidden", "disabled"].includes($transformationParts.bird.pubes)>>
		<<set $transformationParts.bird.pubes to "hidden">>
	<</if>>
<</widget>>

/* Used to temporarily hide all transformation parts, such as when needing to turn the player into Janet. showTransformations will bring back all parts this widget hid. */
<<widget "hideTransformations">>
	<<set $saveTransformtaions to clone($transformationParts)>>
	<<for _transformation, _parts range $transformationParts>>
		<<for _part, _value range _parts>>
			<<if _value isnot "disabled" and _value isnot "hidden">>
				<<set $transformationParts[_transformation][_part] to "hidden">>
			<</if>>
		<</for>>
	<</for>>
<</widget>>

<<widget "showTransformations">>
	<<if $saveTransformtaions isnot undefined>>
		<<set $transformationParts to clone($saveTransformtaions)>>
		<<unset $saveTransformtaions>>
	<</if>>
<</widget>>

/* 北极星模组 */
<<widget "fallenstart">>
	<<clearDivineTransformations>>
	<<set $angel to 6>>
	<<fallenTransform>>
<</widget>>

<<widget "hunterstart">>
	<<clearDivineTransformations>>
	<<set $demonbuild to 30>>
	<<set $demon to 6>>
	<<hunterTransform>>
<</widget>>

<<widget "hunterTransform">>
	<<if $demon gte 6>>
	    <br>
		<span class="lustful">长久得不到爱液滋养的恶魔身体发生了变异，仿佛复仇的怒火在血管里熊熊燃烧。你身披变异恶魔之力，誓要成为恶魔克星。</span>
		<<set $demonhunter to 2>>
		<<earnFeat "Demon Hunter">>
	<<elseif $demonbuild lte 30>>
	    <br>
	    <span class="lustful">被玷污的身体早已堕入深渊，但你眼里掩藏着不甘的怒火，你学习恶魔的力量，但拒绝沉沦，等待着复仇时刻的到来。</span>
		<<set $demonbuild += 1>>
	<</if>>
	<<if $demonhunter is 2>>
		<<set $specialTransform to 1>>
	<</if>>
<</widget>>
/* 北极星 */

<<widget "fallenTransform">>
	<<if $angel gte 6>>
		<span class="red">Your halo shatters and your wings blacken. An overwhelming sense of loss overcomes you.</span>
		<<set $trauma to $traumamax>>
		<<set $fallenangel to 2>>
		/* 北极星模组 */
		<<clearhalo>>
		<<clearwings>>
		<<set $transformationParts.fallenAngel.halo to "default">>
		/* 北极星 */
		<<set $transformationParts.fallenAngel.wings to "default">>
		<<earnFeat "Fallen Angel">>
	<<elseif $angel gte 4>>
		<span class="red">Your halo shatters and fades.</span>
	<</if>>
	<<if $angel gt 0>>
		<<angelTransform 99>>
	<</if>>
	<<if $fallenangel is 2>>
		<<set $specialTransform to 1>>
	<</if>>
<</widget>>

/* 北极星模组 */
<<widget "hunterButNotOut">>
	<<if _args[0] gte 0>>
	 	<<switch _args[0]>>
			<<case 2>>
				<<if $hunterbuild gte 20>>
					<<set $demonhunter to 3>>
					<br>
					<span class="lustful">你的体液变得愈发灼热。</span>
					<br>
				<</if>>
			<<case 3>>
				<<if $hunterbuild gte 30>>
					<<set $demonhunter to 4>>
					<br>
					<span class="lustful">你的体液仿佛岩浆般沸腾。</span>
					<br>
				<</if>>
		    <<case 5>>
				<<if $hunterbuild gte 30 and $demonbuild gte 90>>
					<<set $demonhunter to 6>>
					<br>
					<span class="lustful">你的身体在变异体液不断地冲刷下愈发坚韧。</span>
					<br>
				<</if>>
			<<case 99>>
				<<set $demonhunter to 0>>
		<</switch>>
	<</if>>
<</widget>>
/* 北极星 */

<<widget "fallenButNotOut">>
	<<if _args[0] gte 0>>
	 	<<switch _args[0]>>
			<<case 2>>
				<<if $fallenbuild gte 20>>
					<<set $fallenangel to 3>>
					<span class="gold">Your wings have grown some new feathers.</span>
				<</if>>
			<<case 3>>
				<<if $fallenbuild gte 30>>
					<<set $fallenangel to 4>>
					<span class="gold">The familiar feeling of soft feathers fills you with hope.</span>
					/* 北极星模组 */
					<<clearwings>>
					/* 北极星 */
					<<set $transformationParts.fallenAngel.wings to "fallenplus">>
					<<if $transformationParts.bird.wings is "default">>
						<<set $transformationParts.fallenAngel.wings to "hidden">>
					<</if>>
				<</if>>
			/* 北极星模组 */
			<<case 5>>
				<<if $fallenbuild gte 30 and $angelbuild gte 30>>
					<<set $fallenangel to 6>>
					<span class="gold">在光明与黑暗的交织中，你体会到了混沌的真谛。</span>
					<<clearwings>>
					<<set $transformationParts.fallenAngel.wings to "fallenplus">>
				<</if>>
            /* 北极星 */
			<<case 99>>
			    /* 北极星模组 */
				<<toggleTransform>>
				/* 北极星 */
				<<set $fallenangel to 0>>
				<<set $transformationParts.fallenAngel.halo to "disabled">>
				<<set $transformationParts.fallenAngel.wings to "disabled">>
		<</switch>>
	<</if>>
<</widget>>

<<widget "fallenDescend">>
	<<set $demonbuild to 30>>
	<<set $demon to 6>>
	<<set $fallenangel to 1>>
	<<set $specialTransform to 1>>
	<span class="gold">Your blackened wings turn blacker still. Your shattered halo fades. Horns sprout from your scalp and a tail sprouts from your lower back. Your sense of loss is replaced with a desire for revenge.</span>
    
    /* 北极星模组 */
    <<clearhalo>>
	<<clearwings>>
	<<cleartail>>
	<<clearwings>>
	/* 北极星 */
	<<set $transformationParts.fallenAngel.halo to "disabled">>
	<<set $transformationParts.fallenAngel.wings to "disabled">>

	<<set $transformationParts.demon.horns to "default">>
	<<set $transformationParts.demon.tail to "default">>
	/* 北极星模组 */
	<<set $hastail to "true">>
	/* 北极星 */
	<<set $transformationParts.demon.wings to "default">>
	<<earnFeat "Demon">>
	<<garousal>><<arousal 600>>
<</widget>>


/* <<angelTransform step>> If neither is provided, force full transformation */
<<widget "angelTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
			    /* 北极星模组 */
				<<if $angelbuild gte 25 and $transformdisabledivine is "f" and $specialTransform isnot 1>>
				/* 北极星 */
					<<set $angel to 1>>
					<<set $specialTransform to 1>>
					<span class="gold">Despite everything, you have managed to remain a pure <<gender>>. The thought makes you happy.</span>
					<br><br>
				<</if>>
			<<case 1>>
			    /* 北极星模组 */
				<<if $angelbuild gte 30 and $transformdisabledivine is "f">>
				/* 北极星 */
					<<set $angel to 2>>
					<span class="gold">You are pure and feel determined to keep it that way.</span>
					<br><br>
				<<elseif $angelbuild lt 25>>
				    /* 北极星模组 */
					<<set $angel to 0>>
    				<<toggleTransform>>
    				/* 北极星 */
					<span class="gold">You feel soiled.</span>
					<br><br>
				<</if>>
			<<case 2>>
			    /* 北极星模组 */
				<<if $angelbuild gte 35 and $transformdisabledivine is "f">>
				/* 北极星 */
					<<set $angel to 3>>
					<span class="gold">You feel a weight lift from your shoulders.</span>
					<br><br>
				<<elseif $angelbuild lt 30>>
					<<set $angel to 1>>
					<span class="gold">You feel dirty.</span>
					<br><br>
				<</if>>
			<<case 3>>
			    /* 北极星模组 */
				<<if $angelbuild gte 40 and $transformdisabledivine is "f">>
				/* 北极星 */
					<<set $angel to 4>>
					<span class="gold">A golden light shines down on you.</span>
					/* 北极星模组 */
					<<clearhalo>>
					/* 北极星 */
					<<set $transformationParts.angel.halo to "default">>
					<br><br>
				<<elseif $angelbuild lt 35>>
					<<set $angel to 2>>
					<span class="gold">You feel a weight bear down on you.</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $angelbuild gte 45 and $transformdisabledivine is "f">>
					<<set $angel to 5>>
					<span class="gold">You feel a soothing warmth in your back.</span>
					<br><br>
				<<elseif $angelbuild lt 40>>
					<<set $angel to 3>>
					<span class="gold">The light above you fades.</span>
					<<set $transformationParts.angel.halo to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $angelbuild gte 50 and $transformdisabledivine is "f">>
					<<set $angel to 6>>
					<span class="gold">You feel lighter. Your new wings caress your face.</span>
					/* 北极星模组 */
					<<clearwings>>
					/* 北极星 */
					<<set $transformationParts.angel.wings to "default">>
					<<if $transformationParts.bird.wings is "default">>
						<<set $transformationParts.angel.wings to "hidden">>
					<</if>>
					<<earnFeat "Angel">>
					<br><br>
				<<elseif $angelbuild lt 45>>
					<<set $angel to 4>>
					<span class="gold">The soothing warmth in your back fades.</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $angelbuild lt 50>>
					<span class="gold">Your wings fade away.</span>
					<<set $angel to 5>>
					<<set $transformationParts.angel.wings to "disabled">>
					<br><br>
				<</if>>
			<<case 99>>
				/* 北极星模组 */
				<<toggleTransform>>
				/* 北极星 */
				<<set $angel to 0>>
				<<set $angelbuild to 0>>
				<<set $transformationParts.angel.halo to "disabled">>
				<<set $transformationParts.angel.wings to "disabled">>
		<</switch>>
	<<else>>
		<<clearDivineTransformations>>
		<<set $specialTransform to 1>>
		<<set $angel to 6>>
		<<set $angelbuild to 50>>
		/* 北极星模组 */
		<<clearhalo>>
		<<clearwings>>
		/* 北极星 */
		<<set $transformationParts.angel.halo to "default">>
		<<set $transformationParts.angel.wings to "default">>
		<<if $transformationParts.bird.wings is "default">>
			<<set $transformationParts.angel.wings to "hidden">>
		<</if>>
	<</if>>
<</widget>>

/* <<demonTransform step>> If neither is provided, force full transformation */
<<widget "demonTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $demonbuild gte 5 and $transformdisabledivine is "f" and $specialTransform isnot 1>>
					<<set $demon to 1>><<set $specialTransform to 1>>
					<span class="gold">Your scalp itches.</span>
					<<garousal>><<arousal 600>>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $demonbuild gte 10 and $transformdisabledivine is "f">>
					<<set $demon to 2>>
					<span class="gold">Horns sprout from your scalp.</span>
					<<garousal>><<arousal 600>>
					/* 北极星模组 */
					<<clearhorns>>
					/* 北极星 */
					<<set $transformationParts.demon.horns to "default">>
					<br><br>
				<<elseif $demonbuild lt 5>>
					/* 北极星模组 */
					<<set $demon to 0>>
    				<<toggleTransform>>
    				/* 北极星 */
					<span class="gold">You feel an invisible light burn away your impurity.</span>
					<<if $demonFeat is true>>
						<<unset $demonFeat>>
						<<earnFeat "The Path to Redemption">>
					<</if>>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $demonbuild gte 15 and $transformdisabledivine is "f">>
					<<set $demon to 3>>
					<span class="gold">Your <<bottom>> itches.</span>
					<br><br>
				<<elseif $demonbuild lt 10>>
					<<set $demon to 1>>
					<<set $transformationParts.demon.horns to "disabled">>
					<span class="gold">Your horns recede.</span>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $demonbuild gte 20 and $transformdisabledivine is "f">>
					<<set $demon to 4>>
					<span class="gold">A tail sprouts from your lower back.</span>
					/* 北极星模组 */
					<<cleartail>>
					<<set $transformationParts.demon.tail to "default">>
					<<set $hastail to "true">>
					/* 北极星 */
					<br><br>
				<<elseif $demonbuild lt 15>>
					<<set $demon to 2>>
					<span class="gold">The itching in your <<bottom>> stops.</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $demonbuild gte 25 and $transformdisabledivine is "f">>
					<<set $demon to 5>>
					<span class="gold">You feel a burning sensation in your back.</span>
					<<garousal>><<arousal 600>>
					<br><br>
				<<elseif $demonbuild lt 20>>
					<<set $demon to 3>>
					<span class="gold">Your tail recedes.</span>
					<<set $transformationParts.demon.tail to "disabled">>
					/* 北极星模组 */
					<<set $hastail to "false">>
					/* 北极星 */
					<<set $transformationParts.traits.flaunting to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $demonbuild gte 30 and $transformdisabledivine is "f">>
					<<set $demon to 6>><<set $demonFeat to true>>
					<span class="gold">You feel lighter. Your new wings caress your face.</span>
					<<garousal>><<arousal 600>>
					/* 北极星模组 */
					<<clearwings>>
					/* 北极星 */
					<<set $transformationParts.demon.wings to "default">>
					<<if $transformationParts.bird.wings is "default">>
						<<set $transformationParts.demon.wings to "hidden">>
					<</if>>
					<<earnFeat "Demon">>
					<br><br>
				<<elseif $demonbuild lt 25>>
					<<set $demon to 4>>
					<span class="gold">The burning in your back ceases.</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $demonbuild lt 30>>
					<span class="gold">Your wings recede.</span>
					<<set $demon to 5>>
					<<set $transformationParts.demon.wings to "disabled">>
					<br><br>
				<<else>>
					<<set $demonFeat to true>>
				<</if>>
			<<case 99>>
				/* 北极星模组 */
				<<toggleTransform>>
				/* 北极星 */
				<<set $demon to 0>>
				<<set $demonbuild to 0>>
				<<set $transformationParts.demon.horns to "disabled">>
				<<set $transformationParts.demon.tail to "disabled">>
				/* 北极星模组 */
				<<set $hastail to "false">>
				/* 北极星 */
				<<set $transformationParts.demon.wings to "disabled">>
				<<set $transformationParts.traits.flaunting to "disabled">>
		<</switch>>
	<<else>>
		<<clearDivineTransformations>>
		<<set $specialTransform to 1>>
		<<set $demon to 6>>
		<<set $demonbuild to 30>>
		/* 北极星模组 */
		<<clearhorns>>
		<<cleartail>>
		<<clearwings>>
		/* 北极星 */
		<<set $transformationParts.demon.horns to "default">>
		<<set $transformationParts.demon.tail to "default">>
		/* 北极星模组 */
		<<set $hastail to "true">>
		/* 北极星 */
		<<set $transformationParts.demon.wings to "default">>
		<<if $transformationParts.bird.wings is "default">>
			<<set $transformationParts.demon.wings to "hidden">>
		<</if>>
	<</if>>
<</widget>>

/* <<wolfTransform step>> If neither is provided, force full transformation */
<<widget "wolfTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
			    /* 北极星模组 */
				<<if $wolfbuild gte 5 and $transformdisable is "f">>
				/* 北极星 */
					<<set $wolfgirl to 1>>
					/* 北极星模组 */
					<<toggleTransform>>
					/* 北极星 */
					<span class="gold">You have a strange toothache.</span>
					<br><br>
				<</if>>
			<<case 1>>
			    /* 北极星模组 */
				<<if $wolfbuild gte 10 and $transformdisable is "f">>
				/* 北极星 */
					<<set $wolfgirl to 2>>
					<span class="gold">Your mouth feels different. You explore your mouth and wince as your tongue presses against your new fangs.</span>
					<<set $transformationParts.traits.fangs to "default">>
					/* 北极星模组 */
					<<set $transformationParts.wolf.cheeks to "feral">>
					/* 北极星 */
					<br><br>
				<<elseif $wolfbuild lt 5>>
					<<set $wolfgirl to 0>>
					/* 北极星模组 */
					<<toggleTransform>>
					/* 北极星 */
					<span class="gold">Your toothache has stopped.</span>
					<br><br>
				<</if>>
			<<case 2>>
			    /* 北极星模组 */
				<<if $wolfbuild gte 15 and $transformdisable is "f">>
				/* 北极星 */
					<<set $wolfgirl to 3>>
					<span class="gold">Your scalp <<print ($pbdisable is "f" ? "and pubic area itch" : "itches")>>.</span>
					<br><br>
				<<elseif $wolfbuild lt 10>>
					<<set $wolfgirl to 1>>
					<span class="gold">Your fangs have turned into regular teeth.</span>
					<<set $transformationParts.traits.fangs to "disabled">>
					<<set $transformationParts.wolf.cheeks to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
			    /* 北极星模组 */
				<<if $wolfbuild gte 20 and $transformdisable is "f">>
				/* 北极星 */
					<<set $wolfgirl to 4>>
					<span class="gold">You feel something on your head. You reach up and tug, but it hurts.
					You have a new pair of wolf ears.
					<<print ($pbdisable is "f" ? " You also notice long and fluffy hair has grown in your pubic area.":"")>></span>
					<<clearears>>
					<<set $transformationParts.wolf.ears to "default">>
					<<set $transformationParts.wolf.pubes to ($pbdisable is "f"? "default" : "hidden")>>
					<<set $transformationParts.wolf.pits to ($pbdisable is "f"? "default" : "hidden")>>
					<br><br>
				<<elseif $wolfbuild lt 15>>
					<<set $wolfgirl to 2>>
					<span class="gold">Your scalp <<print ($pbdisable is "f" ? "and pubic area no longer itch" : "no longer itches")>>.</span>
					<br><br>
				<</if>>
			<<case 4>>
			    /* 北极星模组 */
				<<if $wolfbuild gte 25 and $transformdisable is "f">>
				/* 北极星 */
					<<set $wolfgirl to 5>>
					<span class="gold">Your lower back itches.</span>
					<br><br>
				<<elseif $wolfbuild lt 20>>
					<<set $wolfgirl to 3>>
					<span class="gold">Your wolf ears <<print ($pbdisable is "f" ? "and extra body hair ":"")>>have disappeared.</span>
					<<set $transformationParts.wolf.ears to "disabled">>
					<<set $transformationParts.wolf.pubes to "disabled">>
					<<set $transformationParts.wolf.pits to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
			    /* 北极星模组 */
				<<if $wolfbuild gte 30 and $transformdisable is "f">>
				/* 北极星 */
					<<set $wolfgirl to 6>>
					<span class="gold">Your bottom feels heavier than usual. You reach behind you and feel your new wolf tail.</span>
					/* 北极星模组 */
					<<cleartail>>
					<<set $transformationParts.wolf.tail to "default">>
					<<set $hastail to "true">>
					/* 北极星 */
					<<earnFeat "Wolf">>
					<br><br>
				<<elseif $wolfbuild lt 25>>
					<<set $wolfgirl to 4>>
					<span class="gold">Your lower back has stopped itching.</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $wolfbuild lt 30>>
					<span class="gold">Your balance feels different. Your wolf tail has disappeared.</span>
					<<set $wolfgirl to 5>>
					<<set $transformationParts.wolf.tail to "disabled">>
					/* 北极星模组 */
					<<set $hastail to "false">>
					/* 北极星 */
					<br><br>
				<</if>>
			<<case 99>>
				/* 北极星模组 */
				<<toggleTransform>>
				/* 北极星 */
				<<set $wolfgirl to 0>>
				<<set $wolfbuild to 0>>
				<<set $transformationParts.traits.fangs to "disabled">>
				<<set $transformationParts.wolf.cheeks to "disabled">>
				<<set $transformationParts.wolf.ears to "disabled">>
				<<set $transformationParts.wolf.pubes to "disabled">>
				<<set $transformationParts.wolf.pits to "disabled">>
				<<set $transformationParts.wolf.tail to "disabled">>
				/* 北极星模组 */
				<<set $hastail to "false">>
				/* 北极星 */
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		/* 北极星模组 */
		<<toggleTransform>>
		/* 北极星 */
		<<set $wolfgirl to 6>>
		<<set $wolfbuild to 100>>
		/* 北极星模组 */
		<<clearcheeks>>
		<<clearears>>
		<<cleartail>>
		/* 北极星 */
		<<set $transformationParts.traits.fangs to "default">>
		/* 北极星模组 */
		<<set $transformationParts.wolf.cheeks to "feral">>
		/* 北极星 */
		<<set $transformationParts.wolf.ears to "default">>
		<<set $transformationParts.wolf.pubes to ($pbdisable is "f"? "default" : "hidden")>>
		<<set $transformationParts.wolf.pits to ($pbdisable is "f"? "default" : "hidden")>>
		<<set $transformationParts.wolf.tail to "default">>
		/* 北极星模组 */
		<<set $hastail to "true">>
		/* 北极星 */
	<</if>>
<</widget>>

/* <<catTransform step>> If neither is provided, force full transformation */
<<widget "catTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
			    /* 北极星模组 */
				<<if $catbuild gte 25 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cat to 1>>
					/* 北极星模组 */
					<<toggleTransform>>
					/* 北极星 */
					<span class="gold">You have a strange toothache. A beetle crawls by. You resist the urge to pounce.</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $catbuild gte 30 and $transformdisable is "f">>
					<<set $cat to 2>>
					<span class="gold">Your mouth feels different. You explore your mouth and wince as your tongue presses against your new fangs.</span>
					<<set $transformationParts.traits.fangs to "default">>
					<<set $transformationParts.traits.sharpEyes to "default">>
					<br><br>
				<<elseif $catbuild lt 25>>
					<<set $cat to 0>>
					/* 北极星模组 */
					<<toggleTransform>>
					/* 北极星 */
					<span class="gold">Your toothache has stopped.</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $catbuild gte 35 and $transformdisable is "f">>
					<<set $cat to 3>>
					<span class="gold">Your scalp itches.</span>
					<br><br>
				<<elseif $catbuild lt 30>>
					<<set $cat to 1>>
					<span class="gold">Your fangs have turned into regular teeth.</span>
					<<set $transformationParts.traits.fangs to "disabled">>
					<<set $transformationParts.traits.sharpEyes to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $catbuild gte 40 and $transformdisable is "f">>
					<<set $cat to 4>>
					<span class="gold">Your scalp twitches. You reach up and feel your new pair of cat ears.</span>
					/* 北极星模组 */
					<<clearears>>
					/* 北极星 */
					<<set $transformationParts.cat.ears to "default">>
					<br><br>
				<<elseif $catbuild lt 35>>
					<<set $cat to 2>>
					<span class="gold">Your scalp no longer itches.</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $catbuild gte 45 and $transformdisable is "f">>
					<<set $cat to 5>>
					<span class="gold">Your lower back itches.</span>
					<br><br>
				<<elseif $catbuild lt 40>>
					<<set $cat to 3>>
					<span class="gold">Your cat ears have disappeared.</span>
					<<set $transformationParts.cat.ears to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $catbuild gte 50 and $transformdisable is "f">>
					<<set $cat to 6>>
					<span class="gold">Your bottom feels weighty, yet perfectly balanced. You reach behind and feel your new cat tail.</span>
					/* 北极星模组 */
					<<cleartail>>
					<<set $transformationParts.cat.tail to "default">>
					<<set $hastail to "true">>
					/* 北极星 */
					<<earnFeat "Neko">>
					<br><br>
				<<elseif $catbuild lt 45>>
					<<set $cat to 4>>
					<span class="gold">The itching in your lower back stops.</span>
					<br><br>
				<</if>>
			<<case 6>>
			    /* 北极星模组 */
				<<if $catbuild gte 55 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cat to 7>>
					<<run window.determineCatEyeStages()>>
					<<set $original_colour = [$leftEyeColour, $rightEyeColour]>>
					<<set $transformationParts.cat.heterochromia to "default">>
					<<catHeterochromiaTF 0>>
					<span class="gold">Your eyes itch.</span>
					<br><br>
				<<elseif $catbuild lt 50>>
					<<set $cat to 5>>
					<span class="gold">Your cat tail disappears.</span>
					<<set $transformationParts.cat.tail to "disabled">>
					/* 北极星模组 */
					<<set $hastail to "false">>
					/* 北极星 */
					<<set $transformationParts.cat.heterochromia to "disabled">>
					<br><br>
				<</if>>
			<<case 7>>
			    /* 北极星模组 */
				<<if $catbuild gte 60 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cat to 8>>
					<<catHeterochromiaTF 1>>
					<span class="gold">Your eyes water from a burning sensation around the pupil.</span>
					<br><br>
				<<elseif $catbuild lt 55>>
					<<set $leftEyeColour to $original_colour[0]>>
					<<set $rightEyeColour to $original_colour[1]>>
					<span class="gold">Your eyes no longer itch; it must have been an allergy.</span>
					<br><br>
					<<set $cat to 6>>
				<</if>>
			<<case 8>>
			    /* 北极星模组 */
				<<if $catbuild gte 65 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cat to 9>>
					<<catHeterochromiaTF 2>>
					<span class="gold">Your eyes burn, likely due to some sort of allergy, you can barely keep them open.</span>
					<br><br>
				<<elseif $catbuild lt 60>>
					<<catHeterochromiaTF 0>>
					<span class="gold">Your eyes sense less detail of your surroundings.</span>
					<<set $cat to 7>>
				<</if>>
			<<case 9>>
			    /* 北极星模组 */
				<<if $catbuild gte 70 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cat to 10>>
					<<catHeterochromiaTF 3>>
					<span class="gold">Your eyes no longer burn, and despite the darkness of the early morning, you are able to pick up every detail of the scenery around you.</span>
					<br><br>
				<<elseif $catbuild lt 65>>
					<<catHeterochromiaTF 1>>
					<<set $cat to 8>>
				<</if>>
			<<case 10>>
				<<if $catbuild lt 70>>
					<<catHeterochromiaTF 2>>
					<span class="gold">Your surroundings appear darker than before. </span>
					<<set $cat to 9>>
				<</if>>
			<<case 99>>
				/* 北极星模组 */
				<<toggleTransform>>
				/* 北极星 */
				<<set $cat to 0>>
				<<set $catbuild to 0>>
				<<set $transformationParts.traits.fangs to "disabled">>
				<<set $transformationParts.traits.sharpEyes to "disabled">>
				<<set $transformationParts.cat.ears to "disabled">>
				<<set $transformationParts.cat.tail to "disabled">>
				/* 北极星模组 */
				<<set $hastail to "false">>
				/* 北极星 */
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		/* 北极星模组 */
		<<toggleTransform>>
		/* 北极星 */
		<<set $cat to 6>>
		<<set $catbuild to 100>>
		/* 北极星模组 */
		<<clearears>>
		<<cleartail>>
		/* 北极星 */
		<<set $transformationParts.traits.fangs to "default">>
		<<set $transformationParts.traits.sharpEyes to "default">>
		<<set $transformationParts.cat.ears to "default">>
		<<set $transformationParts.cat.tail to "default">>
		/* 北极星模组 */
		<<set $hastail to "true">>
		/* 北极星 */
	<</if>>
<</widget>>

<<widget "catHeterochromiaTF">>
	<<if _args[0] gte 0 or _args[0] == "hide">>
		<<if $transformationParts.cat.heterochromia isnot "hidden" and _args[0] isnot "hide">>
			<<set $leftEyeColour to "cat_tf_stage_" + _args[0] + "_left">>
			<<set $rightEyeColour to "cat_tf_stage_" + _args[0] + "_right">>
			<<if _args[0] >= 3>>
				<<set $heterochromia to 1>>
			<<else>>
				<<set $heterochromia to 0>>
			<</if>>
		<<else>>
			<<if V.original_colour isnot undefined>>
				<<set $leftEyeColour to $original_colour[0]>>
				<<set $rightEyeColour to $original_colour[1]>>
			<</if>>
			<<set $heterochromia to 0>>
		<</if>>
	<</if>>
<</widget>>

<<widget "cowTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
			    /* 北极星模组 */
				<<if $cowbuild gte 5 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cow to 1>>
					/* 北极星模组 */
					<<toggleTransform>>
					/* 北极星 */
					<span class="gold">You have a strange urge to munch grass.</span>
					<br><br>
				<</if>>
			<<case 1>>
			    /* 北极星模组 */
				<<if $cowbuild gte 10 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cow to 2>>
					/* 北极星模组 */
					<<clearhorns>>
					/* 北极星 */
					<<set $transformationParts.cow.horns to "default">>
					<span class="gold">Your scalp itches. You reach up, and find that a pair of small horns have sprouted.</span>
					<br><br>
				<<elseif $cowbuild lt 5>>
					<<set $cow to 0>>
					/* 北极星模组 */
					<<toggleTransform>>
					/* 北极星 */
					<span class="gold">Grass no longer looks so tasty.</span>
					<br><br>
				<</if>>
			<<case 2>>
			    /* 北极星模组 */
				<<if $cowbuild gte 15 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cow to 3>>
					<span class="gold">Your ears tingle.</span>
					<br><br>
				<<elseif $cowbuild lt 10>>
					<<set $cow to 1>>
					<<set $transformationParts.cow.horns to "disabled">>
					<span class="gold">Your small horns have disappeared.</span>
					<br><br>
				<</if>>
			<<case 3>>
			    /* 北极星模组 */
				<<if $cowbuild gte 20 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cow to 4>>
					/* 北极星模组 */
					<<clearears>>
					/* 北极星 */
					<<set $transformationParts.cow.ears to "default">>
					<span class="gold">Your ears itch. You reach up to scratch them, and find them much bigger than you expected. You've grown a pair of cow ears.</span>
					<br><br>
				<<elseif $cowbuild lt 15>>
					<<set $cow to 2>>
					<span class="gold">Your ears no longer tingle.</span>
					<br><br>
				<</if>>
			<<case 4>>
			    /* 北极星模组 */
				<<if $cowbuild gte 25 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cow to 5>>
					<span class="gold">Your lower back tingles.</span>
					<br><br>
				<<elseif $cowbuild lt 20>>
					<<set $cow to 3>>
					<<set $transformationParts.cow.ears to "disabled">>
					<span class="gold">Your cow ears have disappeared.</span>
					<br><br>
				<</if>>
			<<case 5>>
			    /* 北极星模组 */
				<<if $cowbuild gte 30 and $transformdisable is "f">>
				/* 北极星 */
					<<set $cow to 6>>
					<<set $semen_max to 6000>>
					<<set $milk_max to 6000>>
					/* 北极星模组 */
					<<cleartail>>
					<<set $transformationParts.cow.tail to "default">>
					<<set $hastail to "true">>
					/* 北极星 */
					<<earnFeat "Cattle">>
					<span class="gold">Your bottom feels heavier than usual. You reach behind you and feel your new cow tail. You suppress the urge to moo.</span>
					<br><br>
				<<elseif $cowbuild lt 25>>
					<<set $cow to 4>>
					<span class="gold">Your lower back has stopped tingling.</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $cowbuild lt 30>>
					<<set $semen_max to 3000>>
					<<set $milk_max to 3000>>
					<span class="gold">Your balance feels different. Your cow tail has disappeared.</span>
					<<set $cow to 5>>
					<<set $transformationParts.cow.tail to "disabled">>
					/* 北极星模组 */
					<<set $hastail to "false">>
					/* 北极星 */
					<br><br>
				<</if>>
			<<case 99>>
				/* 北极星模组 */
				<<toggleTransform>>
				/* 北极星 */
				<<set $cow to 0>>
				<<set $cowbuild to 0>>
				<<set $semen_max to 3000>>
				<<set $milk_max to 3000>>
				<<set $transformationParts.cow.tail to "disabled">>
				/* 北极星模组 */
				<<set $hastail to "false">>
				/* 北极星 */
				<<set $transformationParts.cow.ears to "disabled">>
				<<set $transformationParts.cow.horns to "disabled">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		/* 北极星模组 */
		<<toggleTransform>>
		/* 北极星 */
		<<set $cow to 6>>
		<<set $cowbuild to 100>>
		<<set $semen_max to 6000>>
		<<set $milk_max to 6000>>
		/* 北极星模组 */
		<<clearhorns>>
		<<clearears>>
		<<cleartail>>
		/* 北极星 */
		<<set $transformationParts.cow.horns to "default">>
		<<set $transformationParts.cow.ears to "default">>
		<<set $transformationParts.cow.tail to "default">>
		/* 北极星模组 */
		<<set $hastail to "true">>
		/* 北极星 */
	<</if>>
	<<semenvolume 0>>
	<<milkvolume 0>>
<</widget>>

/* <<harpyTransform step>> If neither is provided, force full transformation */
<<widget "harpyTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
			    /* 北极星模组 */
				<<if $birdbuild gte 5 and $transformdisable is "f">>
				/* 北极星 */
					<<set $harpy to 1>>
					/* 北极星模组 */
					<<toggleTransform>>
					/* 北极星 */
					<span class="gold">Your vision feels sharper.</span><br><br>
				<</if>>
			<<case 1>>
				<<if $birdbuild gte 10 and $transformdisable is "f">>
					<<set $harpy to 2>>
					<span class="gold">Your eyes feel strange. Your vision has improved.</span>
					/* 北极星模组 */
					<<cleareyes>>
					/* 北极星 */
					<<set $transformationParts.bird.eyes to "default">>
					<<set $transformationParts.bird.malar to "default">>
					<<set $transformationParts.traits.sharpEyes to "default">>
					<br><br>
				<<elseif $birdbuild lt 5>>
					<<set $harpy to 0>>
					/* 北极星模组 */
					<<toggleTransform>>
					/* 北极星 */
					<span class="gold">Your vision has returned to normal.</span>
					<br><br>
				<</if>>
			<<case 2>>
			    /* 北极星模组 */
				<<if $birdbuild gte 15 and $transformdisable is "f">>
				/* 北极星 */
					<<set $harpy to 3>>
					<span class="gold">Your lower back and neck itch.
					<<if $loveInterest.primary isnot "None">>
						Your thoughts turn to
						<<if $loveInterest.primary is "Black Wolf" or $loveInterest.primary is "Great Hawk">>
							the $loveInterest.primary,
						<<else>>
							$loveInterest.primary,
						<</if>>
						and you have a primal, almost animalistic, urge to be with <<print C.npc[$loveInterest.primary].pronouns.him>>.
					<<else>>
						You suddenly crave a true partner to be with.
					<</if>>
					</span>
					<<set $transformationParts.traits.mateForLife to "default">>
					<br><br>
				<<elseif $birdbuild lt 10>>
					<<set $harpy to 1>>
					<span class="gold">Your vision is no longer so sharp.</span>
					<<set $transformationParts.bird.eyes to "disabled">>
					<<set $transformationParts.bird.malar to "disabled">>
					<<set $transformationParts.traits.sharpEyes to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
			    /* 北极星模组 */
				<<if $birdbuild gte 20 and $transformdisable is "f">>
				/* 北极星 */
					<<set $harpy to 4>>
					<span class="gold">Your bottom feels lighter. You reach behind you, and grasp a feathered tail. Small feathers cover your neck.</span>
					/* 北极星模组 */
					<<cleartail>>
					<<set $transformationParts.bird.tail to "default">>
					<<set $hastail to "true">>
					/* 北极星 */
					<<set $transformationParts.bird.plumage to "default">>
					<br><br>
				<<elseif $birdbuild lt 15>>
					<<set $harpy to 2>>
					<span class="gold">The itching in your lower back and neck both stop, and you no longer crave a partner so feverishly.</span>
					<<set $transformationParts.traits.mateForLife to "disabled">>
					<br><br>
				<</if>>
			<<case 4>>
			    /* 北极星模组 */
				<<if $birdbuild gte 25 and $transformdisable is "f">>
				/* 北极星 */
					<<set $harpy to 5>>
					<span class="gold">Your back <<print ($pbdisable is "f" ? "and pubic area itch" : "itches")>>.</span>
					<br><br>
				<<elseif $birdbuild lt 20>>
					<<set $harpy to 3>>
					<span class="gold">Your feathered tail has disappeared, along with the feathers on your neck.</span>
					<<set $transformationParts.bird.tail to "disabled">>
					/* 北极星模组 */
					<<set $hastail to "false">>
					/* 北极星 */
					<<set $transformationParts.bird.plumage to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
			    /* 北极星模组 */
				<<if $birdbuild gte 30 and $transformdisable is "f">>
				/* 北极星 */
					<<set $harpy to 6>>
					<span class="gold">You feel light as a feather. Wings caress your face.
					<<print ($pbdisable is "f" ? " You also notice that short, feathery hair has grown in your pubic area.":"")>></span>
					<<earnFeat "Harpy">>
					/* 北极星模组 */
					<<clearwings>>
					<<set $transformationParts.bird.wings to "default">>
					/* 北极星 */
					<<if $pbdisable is "f">>
						<<set $transformationParts.bird.pubes to "default">>
					<<else>>
						<<set $transformationParts.bird.pubes to "hidden">>
					<</if>>
					<br><br>
				<<elseif $birdbuild lt 25>>
					<<set $harpy to 4>>
					<span class="gold">You feel heavier<<print ($pbdisable is "f" ? ", and your pubic area no longer itches" : "")>>.</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $birdbuild lt 30>>
					<span class="gold">You feel heavier. Your feathered wings<<print ($pbdisable is "f" ? " and feathery pubes":"")>> have disappeared.</span>
					<<set $harpy to 5>>
					<<set $transformationParts.bird.wings to "disabled">>
					<<set $transformationParts.bird.pubes to "disabled">>
					<<if $angel gte 6>>
						<<set $transformationParts.angel.wings to "default">>
					<</if>>
					<<if $demon gte 6>>
						<<set $transformationParts.demon.wings to "default">>
					<</if>>
					<<if $fallenangel gte 2>>
						<<set $transformationParts.fallenAngel.wings to "default">>
					<</if>>
					<br><br>
				<</if>>
			<<case 99>>
				/* 北极星模组 */
				<<toggleTransform>>
				/* 北极星 */
				<<set $harpy to 0>>
				<<set $birdbuild to 0>>
				<<set $transformationParts.bird.eyes to "disabled">>
				<<set $transformationParts.bird.malar to "disabled">>
				<<set $transformationParts.bird.tail to "disabled">>
				/* 北极星模组 */
				<<set $hastail to "false">>
				/* 北极星 */
				<<set $transformationParts.bird.plumage to "disabled">>
				<<set $transformationParts.bird.wings to "disabled">>
				<<set $transformationParts.bird.pubes to "disabled">>
				<<set $transformationParts.traits.sharpEyes to "disabled">>
				<<set $transformationParts.traits.mateForLife to "disabled">>
				<<if $angel gte 6>>
					<<set $transformationParts.angel.wings to "default">>
				<</if>>
				<<if $demon gte 6>>
					<<set $transformationParts.demon.wings to "default">>
				<</if>>
				<<if $fallenangel gte 2>>
					<<set $transformationParts.fallenAngel.wings to "default">>
				<</if>>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		/* 北极星模组 */
		<<toggleTransform>>
		/* 北极星 */
		<<set $harpy to 6>>
		<<set $birdbuild to 100>>
		/* 北极星模组 */
		<<cleareyes>>
		<<cleartail>>
		<<clearwings>>
		/* 北极星 */
		<<set $transformationParts.bird.eyes to "default">>
		<<set $transformationParts.bird.malar to "default">>
		<<set $transformationParts.bird.tail to "default">>
		/* 北极星模组 */
		<<set $hastail to "true">>
		/* 北极星 */
		<<set $transformationParts.bird.plumage to "default">>
		<<set $transformationParts.bird.wings to "default">>
		<<set $transformationParts.traits.sharpEyes to "default">>
		<<set $transformationParts.traits.mateForLife to "default">>
		<<if $transformationParts.angel.wings is "default">>
			<<set $transformationParts.angel.wings to "hidden">>
		<<elseif $transformationParts.fallenAngel.wings is "default">>
			<<set $transformationParts.fallenAngel.wings to "hidden">>
		<<elseif $transformationParts.demon.wings is "default">>
			<<set $transformationParts.demon.wings to "hidden">>
		<</if>>
		<<if $pbdisable is "f">>
			<<set $transformationParts.bird.pubes to "default">>
		<<else>>
			<<set $transformationParts.bird.pubes to "hidden">>
		<</if>>
	<</if>>
<</widget>>

/* <<foxTransform step>> If neither is provided, force full transformation */
<<widget "foxTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
			    /* 北极星模组 */
				<<if $foxbuild gte 5 and $transformdisable is "f">>
				/* 北极星 */
					<<set $fox to 1>>
					/* 北极星模组 */
					<<toggleTransform>>
					/* 北极星 */
					<<if $options.bjx_animal>>
						<span class="gold">你感觉牙痛，又感觉视力变好了点。你感觉自己似乎变漂亮了一些。</span>
					<<else>>
						<span class="gold">你感觉牙痛，又感觉视力变好了点。你有股想偷什么东西的冲动。</span>
					<</if>>
					<br><br>
				<</if>>
			<<case 1>>
			    /* 北极星模组 */
				<<if $foxbuild gte 10 and $transformdisable is "f">>
				/* 北极星 */
					<<set $fox to 2>>
					<span class="gold">Your mouth and eyes feel different. You explore your mouth and yipp as your tongue presses against your new fangs.</span>
					<<set $transformationParts.traits.fangs to "default">>
					<<set $transformationParts.traits.sharpEyes to "default">>
					<br><br>
				<<elseif $foxbuild lt 5>>
					<<set $fox to 0>>
					/* 北极星模组 */
					<<toggleTransform>>
					/* 北极星 */
					<span class="gold">Your toothache has stopped.</span>
					<br><br>
				<</if>>
			<<case 2>>
			    /* 北极星模组 */
				<<if $foxbuild gte 15 and $transformdisable is "f">>
				/* 北极星 */
					<<set $fox to 3>>
					<span class="gold">Your scalp itches.
					<<if $loveInterest.primary isnot "None">>
						Your thoughts turn to
 						<<if $loveInterest.primary is "Black Wolf" or $loveInterest.primary is "Great Hawk">>
							the $loveInterest.primary,
						<<else>>
							$loveInterest.primary,
						<</if>>
						and you have a primal, almost animalistic, urge to be with <<print C.npc[$loveInterest.primary].pronouns.him>>.
					<<else>>
						You suddenly crave a true partner to be with.
					<</if>>
					</span>
					<<set $transformationParts.traits.mateForLife to "default">>
					<br><br>
				<<elseif $foxbuild lt 10>>
					<<set $fox to 1>>
					<span class="gold">Your fangs have turned into regular teeth, and your eyesight feels dull.</span>
					<<set $transformationParts.traits.fangs to "disabled">>
					<<set $transformationParts.traits.sharpEyes to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
			    /* 北极星模组 */
				<<if $foxbuild gte 20 and $transformdisable is "f">>
				/* 北极星 */
					<<set $fox to 4>>
					<span class="gold">You feel something on your head. You reach up and touch your new pair of fox ears, and they wiggle in response.</span>
					/* 北极星模组 */
					<<clearears>>
					/* 北极星 */
					<<set $transformationParts.fox.ears to "default">>
					<br><br>
				<<elseif $foxbuild lt 15>>
					<<set $fox to 2>>
					<span class="gold">Your scalp no longer itches, and you no longer crave a partner so feverishly.</span>
					<<set $transformationParts.traits.mateForLife to "disabled">>
					<br><br>
				<</if>>
			<<case 4>>
			    /* 北极星模组 */
				<<if $foxbuild gte 25 and $transformdisable is "f">>
				/* 北极星 */
					<<set $fox to 5>>
					<span class="gold">Your lower back itches. You have the urge to let someone scratch it. You also notice strange discolouration around your eyes.</span>
					/* 北极星模组 */
					<<clearcheeks>>
					/* 北极星 */
					<<set $transformationParts.fox.cheeks to "default">>
					<br><br>
				<<elseif $foxbuild lt 20>>
					<<set $fox to 3>>
					<span class="gold">Your fox ears have disappeared.</span>
					<<set $transformationParts.fox.ears to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
			    /* 北极星模组 */
				<<if $foxbuild gte 30 and $transformdisable is "f">>
				/* 北极星 */
					<<set $fox to 6>>
					<span class="gold">Your bottom feels heavier than usual. You give it a wiggle and feel your new fox tail. It's extremely comforting to touch.</span>
					/* 北极星模组 */
					<<cleartail>>
					<<set $transformationParts.fox.tail to "default">>
					<<set $hastail to "true">>
					/* 北极星 */
					<<earnFeat "Fox">>
					<br><br>
				<<elseif $foxbuild lt 25>>
					<<set $fox to 4>>
					<span class="gold">Your lower back has stopped itching, and the discolouration around your eyes has vanished.</span>
					<<set $transformationParts.fox.cheeks to "disabled">>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $foxbuild lt 30>>
					<span class="gold">Your balance feels different. Your fox tail has disappeared.</span>
					<<set $fox to 5>>
					<<set $transformationParts.fox.tail to "disabled">>
					/* 北极星模组 */
					<<set $hastail to "false">>
					/* 北极星 */
					<br><br>
				<</if>>
			<<case 99>>
				/* 北极星模组 */
				<<toggleTransform>>
				/* 北极星 */
				<<set $fox to 0>>
				<<set $foxbuild to 0>>
				<<set $transformationParts.traits.fangs to "disabled">>
				<<set $transformationParts.traits.sharpEyes to "disabled">>
				<<set $transformationParts.traits.mateForLife to "disabled">>
				<<set $transformationParts.fox.cheeks to "disabled">>
				<<set $transformationParts.fox.ears to "disabled">>
				<<set $transformationParts.fox.tail to "disabled">>
				/* 北极星模组 */
				<<set $hastail to "false">>
				/* 北极星 */
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		/* 北极星模组 */
		<<toggleTransform>>
		/* 北极星 */
		<<set $fox to 6>>
		<<set $foxbuild to 100>>
		/* 北极星模组 */
		<<clearcheeks>>
		<<clearears>>
		<<cleartail>>
		/* 北极星 */
		<<set $transformationParts.traits.fangs to "default">>
		<<set $transformationParts.traits.sharpEyes to "default">>
		<<set $transformationParts.traits.mateForLife to "default">>
		<<set $transformationParts.fox.cheeks to "default">>
		<<set $transformationParts.fox.ears to "default">>
		<<set $transformationParts.fox.tail to "default">>
		/* 北极星模组 */
		<<set $hastail to "true">>
		/* 北极星 */
	<</if>>
<</widget>>

/* 北极星模组 */
<<widget "raccoonTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $raccoonbuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $raccoon to 1>><<toggleTransform>>
					<span class="gold">你感觉自己比平常更随意了。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $raccoonbuild gte 10 and $transformdisable is "f">>
					<<set $raccoon to 2>>
					<<clearcheeks>>
					<<set $transformationParts.traits.sharpEyes to "default">>
					<<set $transformationParts.raccoon.mask to "default">>
					<span class="gold">当夜幕降临，黑暗笼罩着你的眼睛时，你的视野突然变得清晰了起来。你注意到了你以前不曾注意到的事物，你贪婪地窥视着，把一切尽收眼底。</span>
					<br><br>
				<<elseif $raccoonbuild lt 5>>
					<<set $raccoon to 0>><<toggleTransform>>
					<span class="gold">你恢复了往日的矜持。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $raccoonbuild gte 15 and $transformdisable is "f">>
					<<set $raccoon to 3>>
					<span class="gold">你的耳朵有些发麻。</span>
					<br><br>
				<<elseif $raccoonbuild lt 10>>
					<<set $raccoon to 1>>
					<<set $transformationParts.raccoon.mask to "disabled">>
					<span class="gold">你脸上的斑纹消失，视力也恢复如初。</span>
					<<set $transformationParts.traits.sharpEyes to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $raccoonbuild gte 20 and $transformdisable is "f">>
					<<set $raccoon to 4>>
					<<clearears>>
					<<set $transformationParts.raccoon.ears to "default">>
					<span class="gold">你的耳朵痒痒的。你试着去抓它们，发现它们比你想象的要大得多。你长出了一对浣熊耳朵。</span>
					<br><br>
				<<elseif $raccoonbuild lt 15>>
					<<set $raccoon to 2>>
					<span class="gold">你的耳朵不再刺痛。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $raccoonbuild gte 25 and $transformdisable is "f">>
					<<set $raccoon to 5>>
					<span class="gold">你感到背部发麻。</span>
					<br><br>
				<<elseif $raccoonbuild lte 20>>
					<<set $raccoon to 3>>
					<<set $transformationParts.raccoon.ears to "disabled">>
					<span class="gold">你的浣熊耳朵不见了。</span>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $raccoonbuild gte 30 and $transformdisable is "f">>
					<<set $raccoon to 6>>
					<<set $transformationParts.traits.incognito to "default">>
					<<cleartail>>
					<<set $transformationParts.raccoon.tail to "default">>
					<<set $hastail to "true">>
					<<set $thintail to "true">>
					<<earnFeat "Raccoon">>
					<span class="gold">你的屁股感觉比平时更重了。你伸手摸摸身后的新浣熊尾巴。盗窃癖好的汹涌澎湃几乎将你淹没。</span>
					<br><br>
				<<elseif $raccoonbuild lt 25>>
					<<set $raccoon to 4>>
					<span class="gold">你的背部的刺痛停止了。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $raccoonbuild lt 30>>
					<span class="gold">你感到身体的重心改变了。你的浣熊尾巴不见了。</span>
					<<set $raccoon to 5>>
					<<set $transformationParts.traits.incognito to "disabled">>
					<<set $transformationParts.raccoon.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thintail to "false">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $raccoon to 0>>
				<<set $raccoonbuild to 0>>
				<<set $transformationParts.raccoon.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thintail to "false">>
				<<set $transformationParts.raccoon.ears to "disabled">>
				<<set $transformationParts.raccoon.mask to "disabled">>
				<<set $transformationParts.traits.sharpEyes to "disabled">>
				<<set $transformationParts.traits.incognito to "disabled">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $raccoon to 6>>
		<<set $raccoonbuild to 100>>
		<<cleartail>>
		<<clearears>>
		<<clearcheeks>>
		<<set $transformationParts.traits.sharpEyes to "default">>
		<<set $transformationParts.traits.incognito to "default">>
		<<set $transformationParts.raccoon.tail to "default">>
		<<set $hastail to "true">>
		<<set $thintail to "true">>
		<<set $transformationParts.raccoon.ears to "default">>
		<<set $transformationParts.raccoon.mask to "default">>
	<</if>>
<</widget>>

<<widget "beeTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $beebuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $bee to 1>>
					<span class="gold">你的耳朵有些发麻。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $beebuild gte 10 and $transformdisable is "f">>
					<<set $bee to 2>>
					<<clearears>>
					<<set $transformationParts.bee.ears to "default">>
					<span class="gold">你感觉耳朵痒痒的。你伸手去抓，发现它们比你印象中的耳朵要大多了。你长出了一对蜜蜂触角。</span>
					<br><br>
				<<elseif $beebuild lt 5>>
					<<set $bee to 0>>
					<span class="gold">你的耳朵不再刺痛。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $beebuild gte 15 and $transformdisable is "f">>
					<<set $bee to 3>>
					<span class="gold">你的腰间痒痒的。</span>
					<br><br>
				<<elseif $beebuild lt 10>>
					<<set $bee to 1>>
					<span class="gold">你的蜜蜂触角不见了。</span>
					<<set $transformationParts.bee.ears to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $beebuild gte 20 and $transformdisable is "f">>
					<<set $bee to 4>>
					<span class="gold">你的屁股感觉重重的。你把手伸向身后，然后抓到了一根毒刺。</span>
					<<cleartail>>
					<<set $transformationParts.bee.tail to "default">>
					<<set $hastail to "true">>
					<<set $thicktail to "true">>
					<br><br>
				<<elseif $beebuild lt 15>>
					<<set $bee to 2>>
					<span class="gold">你腰间痒痒的感觉停止了。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $beebuild gte 25 and $transformdisable is "f">>
					<<set $bee to 5>>
					<span class="gold">你的背部发痒。</span>
					<br><br>
				<<elseif $beebuild lt 20>>
					<<set $bee to 3>>
					<span class="gold">你的毒刺不见了。</span>
					<<set $transformationParts.bee.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thicktail to "false">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $beebuild gte 30 and $transformdisable is "f">>
					<<set $bee to 6>>
					<span class="gold">你感觉自己更轻盈了。翅膀轻抚你的脸庞。</span>
					<<earnFeat "Bee">>
					<<clearwings>>
					<<set $transformationParts.bee.wings to "default">>
					<br><br>
				<<elseif $beebuild lt 25>>
					<<set $bee to 4>>
					<span class="gold">你感觉更轻盈了。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $beebuild lt 30>>
					<span class="gold">你感觉自己更沉重了。你的翅膀不见了。</span>
					<<set $bee to 5>>
					<<set $transformationParts.bee.wings to "disabled">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $bee to 0>>
				<<set $beebuild to 0>>
				<<set $transformationParts.bee.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thicktail to "false">>
				<<set $transformationParts.bee.ears to "disabled">>
				<<set $transformationParts.bee.wings to "disabled">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $bee to 6>>
		<<set $beebuild to 100>>
		<<cleartail>>
		<<clearears>>
		<<clearwings>>
		<<set $transformationParts.bee.tail to "default">>
		<<set $hastail to "true">>
		<<set $thicktail to "true">>
		<<set $transformationParts.bee.ears to "default">>
		<<set $transformationParts.bee.wings to "default">>
	<</if>>
<</widget>>

<<widget "sheepTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $sheepbuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $sheep to 1>><<toggleTransform>>
					<span class="gold">你有一种想吃草的奇怪冲动。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $sheepbuild gte 10 and $transformdisable is "f">>
					<<set $sheep to 2>>
					<<clearhorns>>
					<<set $transformationParts.sheep.horns to "default">>
					<span class="gold">你的头皮痒痒的。你伸手一摸，发现自己长出了一对犄角。</span>
					<br><br>
				<<elseif $sheepbuild lt 5>>
					<<set $sheep to 0>><<toggleTransform>>
					<span class="gold">你觉得草看起来不再那么好吃了。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $sheepbuild gte 15 and $transformdisable is "f">>
					<<set $sheep to 3>>
					<span class="gold">你的耳朵有些发麻。</span>
					<br><br>
				<<elseif $sheepbuild lt 10>>
					<<set $sheep to 1>>
					<<set $transformationParts.sheep.horns to "disabled">>
					<span class="gold">你的犄角不见了。</span>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $sheepbuild gte 20 and $transformdisable is "f">>
					<<set $sheep to 4>>
					<<clearears>>
					<<set $transformationParts.sheep.ears to "default">>
					<span class="gold">你的耳朵痒痒的。你伸手去抓，发现它们比你想象的要大得多。你长出了一对小羊耳朵。</span>
					<br><br>
				<<elseif $sheepbuild lt 15>>
					<<set $sheep to 2>>
					<span class="gold">你的耳朵不再刺痛。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $sheepbuild gte 25 and $transformdisable is "f">>
					<<set $sheep to 5>>
					<span class="gold">你感到背部发麻。</span>
					<br><br>
				<<elseif $sheepbuild lte 20>>
					<<set $sheep to 3>>
					<<set $transformationParts.sheep.ears to "disabled">>
					<span class="gold">你的小羊耳朵不见了。</span>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $sheepbuild gte 30 and $transformdisable is "f">>
					<<set $sheep to 6>>
					<<set $semen_max to 6000>>
					<<set $milk_max to 6000>>
					<<cleartail>>
					<<set $transformationParts.sheep.tail to "default">>
					<<set $hastail to "true">>
					<<set $thintail to "true">>
					<<earnFeat "Sheep">>
					<span class="gold">你的屁股感觉比平时更重了。你把手伸向身后，摸摸你的小羊尾巴。 你努力抑制住了"咩咩"的冲动。</span>
					<br><br>
				<<elseif $sheepbuild lt 25>>
					<<set $sheep to 4>>
					<span class="gold">你的背部的刺痛停止了。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $sheepbuild lt 30>>
					<<set $semen_max to 3000>>
					<<set $milk_max to 3000>>
					<span class="gold">你感到身体的重心改变了。你的羊尾巴不见了。</span>
					<<set $sheep to 5>>
					<<set $transformationParts.sheep.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thintail to "false">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $sheep to 0>>
				<<set $sheepbuild to 0>>
				<<set $transformationParts.sheep.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thintail to "false">>
				<<set $transformationParts.sheep.ears to "disabled">>
				<<set $transformationParts.sheep.horns to "disabled">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $sheep to 6>>
		<<set $sheepbuild to 100>>
		<<cleartail>>
		<<clearears>>
		<<clearhorns>>
		<<set $transformationParts.sheep.tail to "default">>
		<<set $hastail to "true">>
		<<set $thintail to "true">>
		<<set $transformationParts.sheep.ears to "default">>
		<<set $transformationParts.sheep.horns to "default">>
	<</if>>
<</widget>>

<<widget "deerTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $deerbuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $deer to 1>><<toggleTransform>>
					<span class="gold">你有一种想吃草的奇怪冲动。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $deerbuild gte 10 and $transformdisable is "f">>
					<<set $deer to 2>>
					<<clearhorns>>
					<<set $transformationParts.deer.horns to "default">>
					<span class="gold">你的头皮发痒。你伸手一摸，发现一对鹿角已经长出来了。</span>
					<br><br>
				<<elseif $deerbuild lt 5>>
					<<set $deer to 0>><<toggleTransform>>
					<span class="gold">你觉得草看起来不再那么好吃了。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $deerbuild gte 15 and $transformdisable is "f">>
					<<set $deer to 3>>
					<span class="gold">你的耳朵有些发麻。</span>
					<br><br>
				<<elseif $deerbuild lt 10>>
					<<set $deer to 1>>
					<<set $transformationParts.deer.horns to "disabled">>
					<span class="gold">你的鹿角不见了。</span>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $deerbuild gte 20 and $transformdisable is "f">>
					<<set $deer to 4>>
					<<clearears>>
					<<set $transformationParts.deer.ears to "default">>
					<span class="gold">你的耳朵痒痒的。你伸手去挠，发现它们比你想象的要大得多。你长出了一对小鹿耳朵。</span>
					<br><br>
				<<elseif $deerbuild lt 15>>
					<<set $deer to 2>>
					<span class="gold">你的耳朵不再刺痛。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $deerbuild gte 25 and $transformdisable is "f">>
					<<set $deer to 5>>
					<span class="gold">你感到背部发麻。</span>
					<br><br>
				<<elseif $deerbuild lte 20>>
					<<set $deer to 3>>
					<<set $transformationParts.deer.ears to "disabled">>
					<span class="gold">你的鹿耳朵不见了。</span>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $deerbuild gte 30 and $transformdisable is "f">>
					<<set $deer to 6>>
					<<cleartail>>
					<<set $transformationParts.deer.tail to "default">>
					<<set $hastail to "true">>
					<<set $thintail to "true">>
					<<earnFeat "Deer">>
					<span class="gold">你的屁股感觉比平时更重了。你把手伸向身后，摸摸你的小鹿尾。</span>
					<br><br>
				<<elseif $deerbuild lt 25>>
					<<set $deer to 4>>
					<span class="gold">你的背部的刺痛停止了。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $deerbuild lt 30>>
					<span class="gold">你感到身体的重心改变了。你的小鹿尾巴不见了。</span>
					<<set $deer to 5>>
					<<set $transformationParts.deer.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thintail to "false">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $deer to 0>>
				<<set $deerbuild to 0>>
				<<set $transformationParts.deer.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thintail to "false">>
				<<set $transformationParts.deer.ears to "disabled">>
				<<set $transformationParts.deer.horns to "disabled">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $deer to 6>>
		<<set $deerbuild to 100>>
		<<cleartail>>
		<<clearears>>
		<<clearhorns>>
		<<set $transformationParts.deer.tail to "default">>
		<<set $hastail to "true">>
		<<set $thintail to "true">>
		<<set $transformationParts.deer.ears to "default">>
		<<set $transformationParts.deer.horns to "default">>
	<</if>>
<</widget>>

<<widget "bearTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $bearbuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $bear to 1>>
					<<toggleTransform>>
					<span class="gold">你有一种想吃甜食的冲动。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $bearbuild gte 10 and $transformdisable is "f">>
					<<set $bear to 2>>
					<span class="gold">你感觉自己睡的更香了。</span>
					<br><br>
				<<elseif $bearbuild lt 5>>
					<<set $bear to 0>>
					<<toggleTransform>>
					<span class="gold">你不再那么想吃甜食了。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $bearbuild gte 15 and $transformdisable is "f">>
					<<set $bear to 3>>
					<span class="gold">你的耳朵有些发麻。</span>
					<br><br>
				<<elseif $bearbuild lt 10>>
					<<set $bear to 1>>
					<span class="gold">你睡得不再那么香了。</span>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $bearbuild gte 20 and $transformdisable is "f">>
					<<set $bear to 4>>
					<<clearears>>
					<<set $transformationParts.bear.ears to "default">>
					<span class="gold">你的耳朵痒痒的。你伸手去挠，发现它们比你预想的要高得多。你长出了一对熊耳朵。</span>
					<br><br>
				<<elseif $bearbuild lt 15>>
					<<set $bear to 2>>
					<span class="gold">你的耳朵不再刺痛。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $bearbuild gte 25 and $transformdisable is "f">>
					<<set $bear to 5>>
					<span class="gold">你的身体刺痛。</span>
					<br><br>
				<<elseif $bearbuild lte 20>>
					<<set $bear to 3>>
					<<set $transformationParts.bear.ears to "disabled">>
					<span class="gold">你的熊耳朵不见了</span>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $bearbuild gte 30 and $transformdisable is "f">>
					<<set $bear to 6>>
					<<cleartail>>
					<<set $transformationParts.bear.tail to "default">>
					<<set $transformationParts.traits.bearbuild to "default">>
					<<set $hastail to "true">>
					<<set $thintail to "true">>
					<<earnFeat "Bear">>
					<span class="gold">你感觉自己的力气变大了，以往沉重的东西也能轻松拿起。似乎有什么东西在你<<bottom>>下面，你伸手摸到了身后的熊尾巴。</span>
					<br><br>
				<<elseif $bearbuild lt 25>>
					<<set $bear to 4>>
					<span class="gold">你的背部的刺痛停止了。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $bearbuild lt 30>>
					<<set $bear to 5>>
					<<set $transformationParts.traits.bearbuild to "disabled">>
					<<set $transformationParts.bear.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thintail to "false">>
					<span class="gold">你感觉自己力气变小了，你的熊尾巴消失了。</span>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $bear to 0>>
				<<set $bearbuild to 0>>
				<<set $transformationParts.bear.tail to "disabled">>
				<<set $transformationParts.traits.bearbuild to "disabled">>
				<<set $hastail to "false">>
				<<set $thintail to "false">>
				<<set $transformationParts.bear.ears to "disabled">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $bear to 6>>
		<<set $bearbuild to 100>>
		<<cleartail>>
		<<clearears>>
		<<set $transformationParts.traits.bearbuild to "default">>
		<<set $transformationParts.bear.tail to "default">>
		<<set $hastail to "true">>
		<<set $thintail to "true">>
		<<set $transformationParts.bear.ears to "default">>
	<</if>>
<</widget>>

<<widget "dragonTransform">>
	<<if $args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $dragonbuild gte 10 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $dragon to 1>><<toggleTransform>>
					<span class="gold">你的眼睛变成了奇怪的红色和黄色。你的视力有所改善。</span>
					<<cleareyes>>
					<<set $transformationParts.dragon.eyes to "default">>
					<<set $transformationParts.traits.sharpEyes to "hidden">>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $dragonbuild gte 20 and $transformdisable is "f">>
					<<set $dragon to 2>>
					<span class="gold">你的嘴疼了一会儿。你舔了舔牙齿，发现了锋利的新獠牙。</span>
					<<set $transformationParts.traits.fangs to "default">>
					<br><br>
				<<elseif $dragonbuild lt 10>>
					<<set $dragon to 0>><<toggleTransform>>
					<span class="gold">你的视力有所下降。</span>
					<<set $transformationParts.dragon.eyes to "disabled">>
					<<set $transformationParts.traits.sharpEyes to "disabled">>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $dragonbuild gte 25 and $transformdisable is "f">>
					<<set $dragon to 3>>
					<span class="gold">你的头突然疼痛起来，随后犄角出现了。</span>
					<<clearhorns>>
					<<set $transformationParts.dragon.horns to "default">>
					<br><br>
				<<elseif $dragonbuild lt 10>>
					<<set $dragon to 1>>
					<span class="gold">你的獠牙已经完全消失了。</span>
					<<set $transformationParts.traits.fangs to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $dragonbuild gte 30 and $transformdisable is "f">>
					<<set $dragon to 4>>
					<span class="gold">你的屁股痒痒的。你伸手摸了过去，发现长出了一条满是粗糙鳞片的尾巴。</span>
					<<cleartail>>
					<<set $transformationParts.dragon.tail to "default">>
					<<set $hastail to "true">>
					<<set $thicktail to "true">>
					<br><br>
				<<elseif $dragonbuild lt 20>>
					<<set $dragon to 2>>
					<span class="gold">你的犄角不见了。</span>
					<<set $transformationParts.dragon.horns to "disabled">>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $dragonbuild gte 40 and $transformdisable is "f">>
					<<set $dragon to 5>>
					<span class="gold">你的背部发痒。</span>
					<br><br>
				<<elseif $dragonbuild lt 30>>
					<<set $dragon to 3>>
					<span class="gold">你的尾巴消失了。</span>
					<<set $transformationParts.dragon.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thicktail to "false">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $dragonbuild gte 50 and $transformdisable is "f">>
					<<set $dragon to 6>>
					<span class="gold">你感到前所未有的强壮和轻盈。</span>
					<<clearwings>>
					<<set $transformationParts.dragon.wings to "default">>
					<br><br>
				<<elseif $dragonbuild lt 40>>
					<<set $dragon to 4>>
					<span class="gold">你感觉自己变虚弱了。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $dragonbuild lt 50>>
					<span class="gold">你觉得自己和曾经当人的时候一样虚弱。你的鳞片状翅膀消失了。</span>
					<<set $dragon to 5>>
					<<set $transformationParts.dragon.wings to "disabled">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $dragon to 0>>
				<<set $dragonbuild to 0>>
				<<set $transformationParts.dragon.eyes to "disabled">>
				<<set $transformationParts.traits.fangs to "disabled">>
				<<set $transformationParts.dragon.horns to "disabled">>
				<<set $transformationParts.dragon.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thicktail to "false">>
				<<set $transformationParts.dragon.wings to "disabled">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $dragon to 6>>
		<<set $dragonbuild to 100>>
		<<cleareyes>>
		<<clearhorns>>
		<<cleartail>>
		<<clearwings>>
		<<set $transformationParts.dragon.eyes to "default">>
		<<set $transformationParts.traits.fangs to "default">>
		<<set $transformationParts.dragon.horns to "default">>
		<<set $transformationParts.dragon.tail to "default">>
		<<set $hastail to "true">>
		<<set $thicktail to "true">>
		<<set $transformationParts.dragon.wings to "default">>
	<</if>>
<</widget>>

<<widget "lizardTransform">>
	<<if $args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $lizardbuild gte 10 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $lizard to 2>><<toggleTransform>>
					<span class="gold">你的眼睛变成了奇怪的红色和黄色。你的视力有所改善。</span>
					<<cleareyes>>
					<<set $transformationParts.lizard.eyes to "default">>
					<<set $transformationParts.traits.sharpEyes to "hidden">>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $lizardbuild gte 20 and $transformdisable is "f">>
					<<set $lizard to 4>>
					<span class="gold">你的牙齿突然疼痛了片刻，獠牙显现了出来。</span>
					<<set $transformationParts.traits.fangs to "default">>
					<br><br>
				<<elseif $lizardbuild lt 10>>
					<<set $lizard to 0>><<toggleTransform>>
					<span class="gold">你的视力有所下降。</span>
					<<set $transformationParts.lizard.eyes to "disabled">>
					<<set $transformationParts.traits.sharpEyes to "disabled">>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $lizardbuild gte 30 and $transformdisable is "f">>
					<<set $lizard to 6>>
					<span class="gold">你的屁股痒痒的。你伸手摸了过去，发现长出了一条满是粗糙鳞片的尾巴。</span>
					<span class="blue">你发现你憋气的时间比以往更久了。</span>
					<<set $oxygenmax to 1500>>
					<<cleartail>>
					<<set $transformationParts.lizard.tail to "default">>
					<<set $hastail to "true">>
					<<set $thicktail to "true">>
					<<set $transformationParts.traits.lungs to "default">>
					<br><br>
				<<elseif $lizardbuild lt 15>>
					<<set $lizard to 1>>
					<span class="gold">你的獠牙已经完全消失了。</span>
					<<set $transformationParts.traits.fangs to "disabled">>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $lizardbuild lt 20>>
					<<set $lizard to 4>>
					<span class="gold">你的尾巴消失了。</span>
					<span class="blue">你屏气的时间恢复到了正常。</span>
					<<set $oxygenmax to 1200>>
					<<set $transformationParts.lizard.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thicktail to "false">>
					<<set $transformationParts.traits.lungs to "disabled">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $lizard to 0>>
				<<set $lizardbuild to 0>>
				<<set $transformationParts.lizard.eyes to "disabled">>
				<<set $transformationParts.traits.sharpEyes to "disabled">>
				<<set $transformationParts.lizard.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thicktail to "false">>
				<<set $transformationParts.traits.fangs to "disabled">>
				<<set $transformationParts.traits.lungs to "disabled">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $lizard to 6>>
		<<set $lizardbuild to 100>>
		<<cleareyes>>
		<<cleartail>>
		<<set $transformationParts.lizard.eyes to "default">>
		<<set $transformationParts.traits.sharpEyes to "hidden">>
		<<set $transformationParts.traits.fangs to "default">>
		<<set $transformationParts.traits.lungs to "default">>
		<<set $transformationParts.lizard.tail to "default">>
		<<set $hastail to "true">>
		<<set $thicktail to "true">>
	<</if>>
<</widget>>

<<widget "dolphinTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $dolphinbuild gte 10 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $dolphin to 2>><<toggleTransform>>
					<span class="blue">你发现你憋气的时间比以往更久了。</span>
					<<set $transformationParts.traits.lungs to "default">>
					<<set $oxygenmax to 1500>>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $dolphinbuild gte 25 and $transformdisable is "f">>
					<<set $dolphin to 4>>
					<span class="gold">你的屁股感觉怪怪的。你把手伸向身后，发现了一条光滑油亮的尾巴。</span>
					<<cleartail>>
					<<set $transformationParts.dolphin.tail to "default">>
					<<set $hastail to "true">>
					<<set $swimtail to "true">>
					<<set $thicktail to "true">>
					<br><br>
				<<elseif $dolphinbuild lte 20>>
					<<set $dolphin to 0>><<toggleTransform>>
					<span class="blue">你屏气的时间恢复到了正常。</span>
					<<set $transformationParts.traits.lungs to "disabled">>
					<<set $oxygenmax to 1200>>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $dolphinbuild gte 30 and $transformdisable is "f">>
					<<set $dolphin to 6>>
					<span class="gold">你感觉自己思维更加灵活了。</span>
					<br><br>
				<<elseif $dolphinbuild lt 25>>
					<<set $dolphin to 2>>
					<span class="gold">你的尾巴消失了。</span>
					<<set $transformationParts.dolphin.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $swimtail to "false">>
					<<set $thicktail to "false">>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $dolphinbuild lt 30>>
					<<set $dolphin to 4>>
					<span class="gold">你感觉自己思维不再灵活了。</span>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $dolphin to 0>>
				<<set $dolphinbuild to 0>>
				<<set $transformationParts.traits.lungs to "disabled">>
				<<set $transformationParts.dolphin.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $swimtail to "false">>
				<<set $thicktail to "false">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $dolphin to 6>>
		<<set $dolphinbuild to 100>>
		<<cleartail>>
		<<set $transformationParts.traits.lungs to "default">>
		<<set $transformationParts.dolphin.tail to "default">>
		<<set $hastail to "true">>
		<<set $swimtail to "true">>
		<<set $thicktail to "true">>
	<</if>>
<</widget>>

<<widget "dogTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $dogbuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $dog to 1>>
					<<toggleTransform>>
					<span class="gold">你的牙齿隐隐作痛。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $dogbuild gte 10 and $transformdisable is "f">>
					<<set $dog to 2>>
					<span class="gold">你的嘴内发生了变化。新生的獠牙划过你的舌尖，你不禁打了个寒颤。</span>
					<<set $transformationParts.traits.fangs to "default">>
					<br><br>
				<<elseif $dogbuild lt 5>>
					<<set $dog to 0>>
					<<toggleTransform>>
					<span class="gold">你的牙痛停止了。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $dogbuild gte 15 and $transformdisable is "f">>
					<<set $dog to 3>>
					<span class="gold">你的头皮发痒。</span>
					<br><br>
				<<elseif $dogbuild lt 10>>
					<<set $dog to 1>>
					<span class="gold">你的獠牙变回了普通牙齿。</span>
					<<set $transformationParts.traits.fangs to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $dogbuild gte 20 and $transformdisable is "f">>
					<<set $dog to 4>>
					<span class="gold">你感觉头上似乎有什么东西。你伸手想要扯掉，但随即感到一阵疼痛。
					你有了一对新的狗耳朵。</span>
					<<clearears>>
					<<set $transformationParts.dog.ears to "default">>
					<br><br>
				<<elseif $dogbuild lt 15>>
					<<set $dog to 2>>
					<span class="gold">你的头皮不再发痒。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $dogbuild gte 25>>
					<<set $dog to 5 and $transformdisable is "f">>
					<span class="gold">你的背部下方开始发痒。</span>
					<br><br>
				<<elseif $dogbuild lt 20>>
					<<set $dog to 3>>
					<span class="gold">你的狗耳朵不见了。</span>
					<<set $transformationParts.dog.ears to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $dogbuild gte 30 and $transformdisable is "f">>
					<<set $dog to 6>>
					<span class="gold">你感觉尾椎骨上似乎有什么重物。你把手伸到身后，摸到了一条狗尾巴。</span>
					<<cleartail>>
					<<set $transformationParts.dog.tail to "default">>
					<<set $hastail to "true">>
					<<set $thintail to "true">>
					<<earnFeat "Dog">>
					<br><br>
				<<elseif $dogbuild lt 25>>
					<<set $dog to 4>>
					<span class="gold">你背部下方的瘙痒感停止了。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $dogbuild lt 30>>
					<span class="gold">你感到身体的重心改变了。你的狗尾巴消失了。</span>
					<<set $dog to 5>>
					<<set $transformationParts.dog.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thintail to "false">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $dog to 0>>
				<<set $dogbuild to 0>>
				<<set $transformationParts.traits.fangs to "disabled">>
				<<set $transformationParts.dog.ears to "disabled">>
				<<set $transformationParts.dog.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thintail to "false">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $dog to 6>>
		<<set $dogbuild to 100>>
		<<clearears>>
		<<cleartail>>
		<<set $transformationParts.traits.fangs to "default">>
		<<set $transformationParts.dog.ears to "default">>
		<<set $transformationParts.dog.tail to "default">>
		<<set $hastail to "true">>
		<<set $thintail to "true">>
	<</if>>
<</widget>>

<<widget "fishTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $fishbuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $fish to 1>>
					<<toggleTransform>>
					<span class="gold">你感觉自己对水有一种亲近感。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $fishbuild gte 10 and $transformdisable is "f">>
					<<set $fish to 2>>
					<span class="gold">你额外喜欢泡在水里洗澡。</span>
					<br><br>
				<<elseif $fishbuild lt 5>>
					<<set $fish to 0>>
					<<toggleTransform>>
					<span class="gold">你对水的亲近感消失了。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $fishbuild gte 15 and $transformdisable is "f">>
					<<set $fish to 3>>
					<span class="gold">你耳朵周围的皮肤变硬了。耳朵上和耳朵周围长出了鱼鳞。</span>
					<br><br>
				<<elseif $fishbuild lt 10>>
					<<set $fish to 1>>
					<span class="gold">你不再那么喜欢泡澡了。</span>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $fishbuild gte 20 and $transformdisable is "f">>
					<<set $fish to 4>>
					<span class="gold">你硬化的耳朵开始变形，每只耳朵的耳廓都拉长形成多根刺，每根刺之间形成了一层膜。你的耳朵保留了原来的功能，但已经变形为鳍。</span>
					<<clearears>>
					<<set $transformationParts.fish.fins to "default">>
					<br><br>
				<<elseif $fishbuild lt 15>>
					<<set $fish to 2>>
					<span class="gold">你耳朵上的鳞片脱落，皮肤也变软恢复正常。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $fishbuild gte 25 and $transformdisable is "f">>
					<<set $fish to 5>>
					<span class="gold">你的下背部发痒。皮肤硬化并长出了鳞片。</span>
					<br><br>
				<<elseif $fishbuild lt 20>>
					<<set $fish to 3>>
					<span class="gold">你鳍上的蹼膜萎缩了，鳍条也收缩变回了原来的样子。你的鳍消失了</span>
					<<set $transformationParts.fish.fins to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $fishbuild gte 30 and $transformdisable is "f">>
					<<set $fish to 6>>
					<span class="gold">你发现自己长出了一条鱼尾巴，同时在水下也可以自由呼吸。</span>
					<<cleartail>>
					<<set $transformationParts.fish.tail to "default">>
					<<set $hastail to "true">>
					<<set $thicktail to "true">>
					<<set $swimtail to "true">>
					<<earnFeat "Fish">>
					<br><br>
				<<elseif $fishbuild lt 25>>
					<<set $fish to 4>>
					<span class="gold">你的腰间不再瘙痒。鳞片脱落，皮肤也恢复正常的质地。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $fishbuild lt 30>>
					<span class="gold">你的鱼尾已被身体重新吸收，你也不再能够水下呼吸了。</span>
					<<set $fish to 5>>
					<<set $transformationParts.fish.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thicktail to "false">>
					<<set $swimtail to "false">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $fish to 0>>
				<<set $fishbuild to 0>>
				<<set $transformationParts.traits.aquatic to "disabled">>
				<<set $transformationParts.fish.fins to "disabled">>
				<<set $transformationParts.fish.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thicktail to "false">>
				<<set $swimtail to "false">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $fish to 6>>
		<<set $fishbuild to 100>>
		<<clearears>>
		<<cleartail>>
		<<set $transformationParts.traits.aquatail to "default">>
		<<set $transformationParts.fish.fins to "default">>
		<<set $transformationParts.fish.tail to "default">>
		<<set $hastail to "true">>
		<<set $thicktail to "true">>
		<<set $swimtail to "true">>
	<</if>>
<</widget>>

<<widget "horseTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $horsebuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $horse to 1>>
					<<toggleTransform>>
					<span class="gold">你感到特别警觉。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $horsebuild gte 10 and $transformdisable is "f">>
					<<set $horse to 2>>
					<span class="gold">你感觉自己的大腿更有力了。</span>
					<<set $transformationParts.traits.kicks to "default">>
					<br><br>
				<<elseif $horsebuild lt 5>>
					<<set $horse to 0>>
					<<toggleTransform>>
					<span class="gold">你感觉没有那么精神了。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $horsebuild gte 15 and $transformdisable is "f">>
					<<set $horse to 3>>
					<span class="gold">你的头皮发痒。</span>
					<br><br>
				<<elseif $horsebuild lt 10>>
					<<set $horse to 1>>
					<span class="gold">你感觉自己的大腿不再有力了。</span>
					<<set $transformationParts.traits.kicks to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $horsebuild gte 20 and $transformdisable is "f">>
					<<set $horse to 4>>
					<span class="gold">你感觉头上似乎有什么东西。你伸手想要扯掉，但随即感到一阵疼痛。
					你有了一对新的马耳朵。</span>
					<<clearears>>
					<<set $transformationParts.horse.ears to "default">>
					<br><br>
				<<elseif $horsebuild lt 15>>
					<<set $horse to 2>>
					<span class="gold">你的头皮不再发痒。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $horsebuild gte 25 and $transformdisable is "f">>
					<<set $horse to 5>>
					<span class="gold">你的背部下方开始发痒。</span>
					<br><br>
				<<elseif $horsebuild lt 20>>
					<<set $horse to 3>>
					<span class="gold">你的马耳朵不见了。</span>
					<<set $transformationParts.horse.ears to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $horsebuild gte 30 and $transformdisable is "f">>
					<<set $horse to 6>>
					<span class="gold">你的屁股感觉比平时更重了。你把手伸向身后，摸摸新长出来的丰满的马尾巴。</span>
					<br>
					<span class="gold">你精力充沛。体力劳动似乎不再那么艰巨和疲惫。</span>
					<<set $transformationParts.traits.vigorous to "default">>
					<<cleartail>>
					<<set $transformationParts.horse.tail to "default">>
					<<set $hastail to "true">>
					<<set $thintail to "true">>
					<<earnFeat "Horse">>
					<br><br>
				<<elseif $horsebuild lt 25>>
					<<set $horse to 4>>
					<span class="gold">你背部下方的瘙痒感停止了。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $horsebuild lt 30>>
				    <<set $horse to 5>>
					<span class="gold">你感到身体的重心改变了。你的马尾巴消失了。</span>
					<br>
					<span class="gold">你感到昏昏欲睡。好像你的体能已经变回了原来的状态。</span>
					<<set $transformationParts.traits.vigorous to "disabled">>
					<<set $transformationParts.horse.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thintail to "false">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $horse to 0>>
				<<set $horsebuild to 0>>
				<<set $transformationParts.traits.kicks to "disabled">>
				<<set $transformationParts.traits.vigorous to "disabled">>
				<<set $transformationParts.horse.ears to "disabled">>
				<<set $transformationParts.horse.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thintail to "false">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $horse to 6>>
		<<set $horsebuild to 100>>
		<<clearears>>
		<<cleartail>>
		<<set $transformationParts.traits.vigorous to "default">>
		<<set $transformationParts.horse.ears to "default">>
		<<set $transformationParts.traits.kicks to "default">>
		<<set $transformationParts.horse.tail to "default">>
		<<set $hastail to "true">>
		<<set $thintail to "true">>
	<</if>>
<</widget>>

<<widget "spiderTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $spiderbuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $spider to 1>>
					<<toggleTransform>>
					<span class="gold">你的牙齿隐隐作痛。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $spiderbuild gte 10 and $transformdisable is "f">>
					<<set $spider to 2>>
					<span class="gold">你的嘴内发生了变化。新生的獠牙划过你的舌尖，你不禁打了个寒颤。</span>
					<<set $transformationParts.traits.fangs to "default">>
					<br><br>
				<<elseif $spiderbuild lt 5>>
					<<set $spider to 0>>
					<<toggleTransform>>
					<span class="gold">你的牙痛停止了。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $spiderbuild gte 15 and $transformdisable is "f">>
					<<set $spider to 3>>
					<span class="gold">你的眼睛发痒。你的太阳穴也跟着发痒。</span>
					<br><br>
				<<elseif $spiderbuild lt 10>>
					<<set $spider to 1>>
					<span class="gold">你的獠牙变回了普通牙齿。</span>
					<<set $transformationParts.traits.fangs to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $spiderbuild gte 20 and $transformdisable is "f">>
					<<set $spider to 4>>
					<span class="gold">你的视线变得模糊。你迷失了方向，开始看到重影、三倍影、四倍影。这种感觉逐渐消失。你的视力趋于稳定，变得比以前更清晰。你长出了复数倍的蜘蛛眼。</span>
					<<cleareyes>>
					<<set $transformationParts.spider.eyes to "default">>
					<<set $transformationParts.traits.sharpEyes to "default">>
					<br><br>
				<<elseif $spiderbuild lt 15>>
					<<set $spider to 2>>
					<span class="gold">你的脸不再痒了。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $spiderbuild gte 25 and $transformdisable is "f">>
					<<set $spider to 5>>
					<span class="gold">你的背部下方开始发痒。</span>
					<br><br>
				<<elseif $spiderbuild lte 20>>
					<<set $spider to 3>>
					<span class="gold">你多余的眼睛已被身体重新吸收。你的视力恢复到原来的状态。</span>
					<<set $transformationParts.spider.eyes to "disabled">>
					<<set $transformationParts.traits.sharpEyes to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $spiderbuild gte 30 and $transformdisable is "f">>
					<<set $spider to 6>>
					<span class="gold">你的屁股感觉比平时更重了。你把手伸向身后，摸摸新的蜘蛛 "尾巴"。</span>
					<<cleartail>>
					<<set $transformationParts.spider.tail to "default">>
					<<set $hastail to "true">>
					<<set $thintail to "true">>
					<<earnFeat "Spider">>
					<br><br>
				<<elseif $spiderbuild lt 25>>
					<<set $spider to 4>>
					<span class="gold">你背部下方的瘙痒感停止了。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $spiderbuild lt 30>>
					<span class="gold">你感到身体的重心改变了。你蜘蛛般的腹部消失了。</span>
					<<set $spider to 5>>
					<<set $transformationParts.spider.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thintail to "false">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $spider to 0>>
				<<set $spiderbuild to 0>>
				<<set $transformationParts.traits.fangs to "disabled">>
				<<set $transformationParts.traits.sharpEyes to "disabled">>
				<<set $transformationParts.spider.eyes to "disabled">>
				<<set $transformationParts.spider.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thintail to "false">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $spider to 6>>
		<<set $spiderbuild to 100>>
		<<cleareyes>>
		<<cleartail>>
		<<set $transformationParts.traits.fangs to "default">>
		<<set $transformationParts.traits.sharpEyes to "default">>
		<<set $transformationParts.spider.eyes to "default">>
		<<set $transformationParts.spider.tail to "default">>
		<<set $hastail to "true">>
		<<set $thintail to "true">>
	<</if>>
<</widget>>

<<widget "pigTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $pigbuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $pig to 1>>
					<<toggleTransform>>
					<span class="gold">你的鼻腔感到异常通畅。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $pigbuild gte 10 and $transformdisable is "f">>
					<<set $pig to 2>>
					<span class="gold">你的鼻子对各种植物非常敏感，也许你可以用它来提高你的收获能力。</span>
					<<set $transformationParts.traits.strongnose to "default">>
					<br><br>
				<<elseif $pigbuild lt 5>>
					<<set $pig to 0>>
					<<toggleTransform>>
					<span class="gold">你的嗅觉感知下降了。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $pigbuild gte 15 and $transformdisable is "f">>
					<<set $pig to 3>>
					<span class="gold">你的头皮发痒。</span>
					<br><br>
				<<elseif $pigbuild lt 10>>
					<<set $pig to 1>>
					<span class="gold">你的鼻子失去了对植物物质的敏感性。</span>
					<<set $transformationParts.traits.strongnose to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $pigbuild gte 20 and $transformdisable is "f">>
					<<set $pig to 4>>
					<span class="gold">你感觉头上似乎有什么东西。你伸手想要扯掉，但随即感到一阵疼痛。
					你有了一对新的猪耳朵。</span>
					<<clearears>>
					<<set $transformationParts.pig.ears to "default">>
					<br><br>
				<<elseif $pigbuild lt 15>>
					<<set $pig to 2>>
					<span class="gold">你的头皮不再发痒。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $pigbuild gte 25 and $transformdisable is "f">>
					<<set $pig to 5>>
					<span class="gold">你的背部下方开始发痒。</span>
					<br><br>
				<<elseif $pigbuild lt 20>>
					<<set $pig to 3>>
					<span class="gold">你的猪耳朵消失了。</span>
					<<set $transformationParts.pig.ears to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $pigbuild gte 30 and $transformdisable is "f">>
					<<set $pig to 6>>
					<span class="gold">你的屁股感觉比平时更重了。你把手伸向身后，摸摸你的新猪尾巴。</span>
					<<cleartail>>
					<<set $transformationParts.pig.tail to "default">>
					<<set $hastail to "true">>
					<<set $thintail to "true">>
					<<earnFeat "Pig">>
					<br><br>
				<<elseif $pigbuild lt 25>>
					<<set $pig to 4>>
					<span class="gold">你背部下方的瘙痒感停止了。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $pigbuild lt 30>>
					<span class="gold">你感到身体的重心改变了。你的猪尾巴消失了。</span>
					<<set $pig to 5>>
					<<set $transformationParts.pig.tail to "disabled">>
					<<set $hastail to "false">>
					<<set $thintail to "false">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $pig to 0>>
				<<set $pigbuild to 0>>
				<<set $transformationParts.traits.strongnose to "disabled">>
				<<set $transformationParts.pig.ears to "disabled">>
				<<set $transformationParts.pig.tail to "disabled">>
				<<set $hastail to "false">>
				<<set $thintail to "false">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $pig to 6>>
		<<set $pigbuild to 100>>
		<<clearears>>
		<<cleartail>>
		<<set $transformationParts.traits.strongnose to "default">>
		<<set $transformationParts.pig.ears to "default">>
		<<set $transformationParts.pig.tail to "default">>
		<<set $hastail to "true">>
		<<set $thintail to "true">>
	<</if>>
<</widget>>

<<widget "frogTransform">>
	<<if _args[0] gte 0>>
		<<switch _args[0]>>
			<<case 0>>
				<<if $frogbuild gte 5 and $transformdisable is "f" and $options.bjx_animal>>
					<<set $frog to 1>>
					<<toggleTransform>>
					<span class="gold">你的身体感觉怪怪的。</span>
					<br><br>
				<</if>>
			<<case 1>>
				<<if $frogbuild gte 10 and $transformdisable is "f">>
					<<set $frog to 2>>
					<span class="gold">你感到身体发生了变化，大腿更有力了，憋气时间也变长了。</span>
					<<set $transformationParts.traits.kicks to "default">>
					<<set $transformationParts.traits.lungs to "default">>
					<br><br>
				<<elseif $frogbuild lt 5>>
					<<set $frog to 0>>
					<<toggleTransform>>
					<span class="gold">你的身体似乎正常了。</span>
					<br><br>
				<</if>>
			<<case 2>>
				<<if $frogbuild gte 15 and $transformdisable is "f">>
					<<set $frog to 3>>
					<span class="gold">你预感自己会有很大变化。</span>
					<br><br>
				<<elseif $frogbuild lt 10>>
					<<set $frog to 1>>
					<span class="gold">你的大腿变得虚弱了，憋气能力也下降了。</span>
					<<set $transformationParts.traits.kicks to "disabled">>
					<<set $transformationParts.traits.lungs to "disabled">>
					<br><br>
				<</if>>
			<<case 3>>
				<<if $frogbuild gte 20 and $transformdisable is "f">>
					<<set $frog to 4>>
					<span class="gold">你的眼睛变成了金色，你的脚和舌头也变长了。前者变成了蹼状，后者变得更加灵活。</span>
					<<set $transformationParts.traits.webbedfeet to "default">>
					<<set $transformationParts.traits.longtongue to "default">>
					<<cleareyes>>
					<<set $transformationParts.frog.eyes to "default">>
					<br><br>
				<<elseif $frogbuild lt 15>>
					<<set $frog to 2>>
					<span class="gold">你莫名的预感消失了。</span>
					<br><br>
				<</if>>
			<<case 4>>
				<<if $frogbuild gte 25 and $transformdisable is "f">>
					<<set $frog to 5>>
					<span class="gold">你的脸颊上长出了一种奇怪的色斑。</span>
					<br><br>
				<<elseif $frogbuild lt 20>>
					<<set $frog to 3>>
					<span class="gold">你的青蛙眼又变回了人类的模样，长长的脚和舌头也复原了。</span>
					<<set $transformationParts.traits.webbedfeet to "disabled">>
					<<set $transformationParts.traits.longtongue to "disabled">>
					<<set $transformationParts.frog.eyes to "disabled">>
					<br><br>
				<</if>>
			<<case 5>>
				<<if $frogbuild gte 30 and $transformdisable is "f">>
					<<set $frog to 6>>
					<span class="gold">你脸颊上的变色变得更加明显。看起来就像一只青蛙。</span>
					<<clearcheeks>>
					<<set $transformationParts.frog.cheeks to "default">>
					<<earnFeat "Frog">>
					<br><br>
				<<elseif $frogbuild lt 25>>
					<<set $frog to 4>>
					<span class="gold">脸颊上的色斑逐渐消失。</span>
					<br><br>
				<</if>>
			<<case 6>>
				<<if $frogbuild lt 30>>
					<span class="gold">你脸颊的颜色完全恢复到了原来的状态。</span>
					<<set $frog to 5>>
					<<set $transformationParts.frog.cheeks to "disabled">>
					<br><br>
				<</if>>
			<<case 99>>
				<<toggleTransform>>
				<<set $frog to 0>>
				<<set $frogbuild to 0>>
				<<set $transformationParts.traits.kicks to "disabled">>
				<<set $transformationParts.traits.webbedfeet to "disabled">>
				<<set $transformationParts.traits.longtongue to "disabled">>
				<<set $transformationParts.traits.lungs to "disabled">>
				<<set $transformationParts.frog.eyes to "disabled">>
				<<set $transformationParts.frog.cheeks to "disabled">>
				<<set $hastail to "false">>
		<</switch>>
	<<else>>
		<<clearAnimalTransformations>>
		<<toggleTransform>>
		<<set $frog to 6>>
		<<set $frogbuild to 100>>
		<<clearears>>
		<<cleartail>>
		<<set $transformationParts.traits.kicks to "default">>
		<<set $transformationParts.traits.webbedfeet to "default">>
		<<set $transformationParts.traits.longtongue to "default">>
		<<set $transformationParts.traits.lungs to "default">>
		<<set $transformationParts.frog.eyes to "default">>
		<<set $transformationParts.frog.cheeks to "default">>
		<<set $hastail to "true">>
	<</if>>
<</widget>>
/* 北极星 */

<<widget "clearAnimalTransformations">>
	<<harpyTransform 99>>
	<<cowTransform 99>>
	<<catTransform 99>>
	<<wolfTransform 99>>
	<<foxTransform 99>>
	/* 北极星模组 */
	<<beeTransform 99>>
	<<sheepTransform 99>>
	<<deerTransform 99>>
	<<bearTransform 99>>
	<<dragonTransform 99>>
	<<lizardTransform 99>>
	<<dolphinTransform 99>>
	<<dogTransform 99>>
	<<raccoonTransform 99>>
	<<fishTransform 99>>
	<<horseTransform 99>>
	<<spiderTransform 99>>
	<<frogTransform 99>>
	<<pigTransform 99>>
	/* 北极星 */
<</widget>>

<<widget "clearDivineTransformations">>
	<<demonTransform 99>>
	<<angelTransform 99>>
	<<fallenButNotOut 99>>
	/* 北极星模组 */
	<<hunterButNotOut 99>>
	/* 北极星 */
<</widget>>

:: Widgets Effects Man [widget]
<<widget "effectsman">>
	<div @class="($debugLines ? 'debugLines-effectsman' : '')">
		<!-- "FOR" loops work by counting backward from highest numbered combatant to lowest e.g. 5 to 0. -->
		<!-- In case of train combat, count stops after 1, e.g. 5 to 5. -->
		<!-- Lots of further opportunity to reduce code using <<for>><</for>> loops with NPC objects NG 2.8-->
		/*
		* Switched all instances of skill checks, that simply repeat themselves with a different variable, for the JS function combatSkillCheck()
		* The function can be found at "game/03-JavaScript/ingame.js". It takes one required argument and three optional arguments.
		* Argument 0 is for the skill being used. For simplycity at writing, you only pass the important part of the skill, E.g. "hand", or "feet", or "oral".
		* Argument 1 (optional) is used for the target of that action. This is used to future-proof the possibility of using the target's specific arousal/trust/anger in calculation.
		* Argument 2 (optional) is the base difficulty used for the action. Most actions use 1000 base difficulty, which is the default if left blank, but some actions take different chances (like undressing).
		* Argument 3 (optional) is the extra multiplier for the arousal side. This is only used in undressing so far, but might as well add it as an option.
		*/

		<<pain -0.25>>

		<<if $enemyno gte 2>>
			<<set $pronoun to "n">>
		<<else>>
			<<switch $NPCList[0].pronoun>>
				<<case "m">>
					<<set $pronoun to "m">>
				<<case "f">>
					<<set $pronoun to "f">>
				<<case "i">>
					<<set $pronoun to "i">>
				<<case "n">>
					<<set $pronoun to "n">>
				<<case "t">>
					<<set $pronoun to "t">>
			<</switch>>
		<</if>>

		<<for _i = 0; _i < $enemynomax; _i++>>
			<<set $NPCList[_i].intro to 1>>
		<</for>>

		<<if $trance gte 1 or $dissociation gte 2>>
			<<if $position is "stalk">>
				You wander in a daze, unaware of your surroundings.
			<<else>>
				You stare straight ahead, your body passive and compliant.
			<</if>>
		<</if>>

		<<if $underwater is 1>>
			<<set $underwatertime += 1>>
			<<if $underwatertime lte 5>>
				You are underwater, and cannot speak.
			<<elseif $underwatertime lte 10>>
				<span class="blue">You are underwater, and cannot breathe.</span>
				<<gstress>><<stress 1>>
			<<elseif $underwatertime lte 15>>
				<span class="purple">You are underwater, and cannot breathe.</span>
				<<gstress>><<stress 2>>
			<<elseif $underwatertime lte 20>>
				<span class="pink">You are underwater, and cannot breathe.</span>
				<<gtrauma>><<gstress>><<stress 4>><<trauma 2>>
			<<else>>
				<span class="red">You are suffocating beneath the water.</span>
				<<pain 20 1>><<gtrauma>><<gstress>><<gpain>><<stress 6>><<trauma 4>>
				<br><br>
			<</if>>
		<</if>>

		<<if $position is "wall">>
			<<if $walltype is "pillory">>
				You are trapped in a pillory with your posterior stuck out and unprotected.
			<<elseif $walltype is "cleanpillory">>
				You are trapped in a pillory with your posterior stuck out and unprotected.
			<<elseif $walltype is "horse_pillory">>
				Your legs and neck are shackled by cold iron, preventing movement.
			<<elseif $walltype is "front">>
				You are trapped in a wall, vulnerable from the waist up.
			<<else>>
				You are trapped in a $walltype with your posterior stuck out in the open.
			<</if>>
		<</if>>

		<<effectspain>>
		<<effectsorgasm>>
		<<effectsdissociation>>
		<<if $possessed>>
			<<effectspossessed>>
		<</if>>

		<<effectsspray>>
		/* 北极星模组 */
		<<effectsoverarousal>>
		<<effectspoison>>
		/* 北极星 */
		<<effectshandsclothes>>
		<<effectssteal>>
		<<effectspenwhack>>
		<<effectsshacklewhack>>
		<<effectshypnosiswhack>>
		<<effectshandsfreeface>>
		<<effectshandpull>>
		<<effectsdildowhack>>
		
		/* 北极星模组 */
		<<if $options.bjx_eventTF and $consensual is 0 and $ghost is 2>>
			<span class='lblue'>
			<br><br>
			你身上散发出一股鬼怪能量，使附近的温度骤降。
			<br><br>
			</span>
			<<deathlychill>>
		<</if>>
		/* 北极星 */

		<<if $bodyaction is "doggy">>
			<<set $bodyaction to 0>>
			You roll onto your knees.
			<<set $position to "doggy">>
		<<elseif $bodyaction is "missionary">>
			<<set $bodyaction to 0>>
			You roll onto your back.
			<<set $position to "missionary">>
		<</if>>

		/***
		*      ███   ███████ ██   ██ ███████
		*     ██ ██  ██   ██ ███ ███ ██
		*    ██   ██ █████   ██ █ ██ ███████
		*    ███████ ██  ██  ██   ██      ██
		*    ██   ██ ██   ██ ██   ██ ███████
		*
		*/
		<<if $newtarget isnot undefined>>
			<<setnewtarget>>
		<</if>>

		<<if $leftaction is "lefthandholdkeep" and $rightaction is "righthandholdkeep">>
			<<set $leftaction to 0>><<set $leftactiondefault to "lefthandholdkeep">>
			<<set $rightaction to 0>><<set $rightactiondefault to "righthandholdkeep">>
			You hold <<someones $lefttarget>> hands in your own.
			<<submission 4>>
		<</if>>

		<<if $leftaction is "lefthandholdnew">>
			<<set $leftaction to 0>><<set $leftactiondefault to "lefthandholdnew">>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<set $NPCList[$lefttarget].righthand to "handhold">>
				You take <<someones $lefttarget>> left hand in your own.
				<<set $leftarm to "handheld">><<set $leftactiondefault to "lefthandholdkeep">>
				<<submission 1>>
				<<if isLoveInterest($NPCList[$lefttarget].fullDescription)>>
					<<takeHandholdingVirginity $NPCList[$lefttarget] "romantic">>
				<<else>>
					<<takeHandholdingVirginity $NPCList[$lefttarget]>>
				<</if>>
			<<else>>
				You reach for <<someones $lefttarget>> left hand, but <<he>> moves away.
			<</if>>
		<</if>>

		<<if $leftaction is "lefthandholdkeep">>
			<<set $leftaction to 0>><<set $leftactiondefault to "lefthandholdkeep">>
			You hold <<someones $lefttarget>> hand in your own.
			<<submission 2>>
		<</if>>

		<<if $leftaction is "lefthandholdstop">>
			<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			You let go of <<someones $lefttarget>> right hand.
			<<set $leftarm to 0>>
			<<if $npcSub>>
				<<set $NPCList[$lefttarget].righthand to "idle">>
			<<else>>
				<<set $NPCList[$lefttarget].righthand to 0>>
			<</if>>
		<</if>>


		<<if $rightaction is "righthandholdnew">>
			<<set $rightaction to 0>><<set $rightactiondefault to "righthandholdnew">>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<set $NPCList[$righttarget].lefthand to "handhold">>
				<<set $rightarm to "handheld">>
				You take <<hisselect $righttarget>> right hand in your own.
				<<set $rightarm to "handheld">><<set $leftactiondefault to "righthandholdkeep">>
				<<submission 1>>
				<<if isLoveInterest($NPCList[$righttarget].fullDescription)>>
					<<takeHandholdingVirginity $NPCList[$righttarget] "romantic">>
				<<else>>
					<<takeHandholdingVirginity $NPCList[$righttarget]>>
				<</if>>
			<<else>>
				You reach for <<someones $righttarget>> but <<he>> moves away.
			<</if>>
		<</if>>

		<<if $rightaction is "righthandholdkeep">>
			<<set $rightaction to 0>><<set $rightactiondefault to "righthandholdkeep">>
			You hold <<someones $righttarget>> hand in your own.
			<<submission 2>>
		<</if>>

		<<if $rightaction is "righthandholdstop">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			You let go of <<someones $righttarget>> left hand.
			<<set $rightarm to 0>>
			<<if $npcSub>>
				<<set $NPCList[$righttarget].lefthand to "idle">>
			<<else>>
				<<set $NPCList[$righttarget].lefthand to 0>>
			<</if>>
		<</if>>

		<<if $leftaction is "handguide">>
			<<set $leftaction to 0>><<set $leftactiondefault to "handguide">><<combatpromiscuity2>>

			<<if combatSkillCheck("hand", $lefttarget)>>
				<<if $rightaction is "handguide" and $handGuideLeft is $handGuideRight>>
					<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
				<</if>>

				<<switch $handGuideLeft>>
					<<case "penis">>
						You lower <<someones $lefttarget>> hand to your <<penis>>.
						<<set $NPCList[$lefttarget].righthand to "penisentrance">><<set $penisuse to 1>><<set $penisstate to "otherhandentrance">>
					<<case "pussy">>
						You lower <<someones $lefttarget>> hand to your <<pussy>>.
						<<set $NPCList[$lefttarget].righthand to "vaginaentrance">><<set $vaginause to 1>><<set $vaginastate to "otherhandentrance">>
					<<case "ass">>
						You press <<someones $lefttarget>> hand against your <<bottom>>.
						<<set $NPCList[$lefttarget].righthand to "anusentrance">><<set $anususe to "handentrance">><<set $anusstate to "handentrance">>
					<<default>>
				<</switch>>
				<<set $leftactiondefault to "rest">><<set $leftarm to 0>><<submission 1>>
			<<else>>
				You try to guide <<someones $lefttarget>> hand to
				<<switch $handGuideRight>>
					<<case "penis">>your <<penis>>,
					<<case "pussy">>your <<pussy>>,
					<<case "ass">>your <<bottom>>,
					<<default>>
				<</switch>>

				<<if $enemyanger gte random(30, 100)>>
					<span class="purple">but <<he>> wrenches it out of your grasp.</span>
					<<set $leftactiondefault to "rest">><<set $leftarm to 0>>
					<<set $NPCList[$lefttarget].righthand to 0>><<violence 2>>
				<<else>>
					but <<his>> grip is too tight.
				<</if>>
			<</if>>
		<</if>>

		<<if $rightaction is "handguide">>
			<<set $rightaction to 0>><<set $rightactiondefault to "handguide">><<combatpromiscuity2>>

			<<if combatSkillCheck("hand", $righttarget)>>
				<<switch $handGuideRight>>
					<<case "penis">>
						You lower <<someones $lefttarget>> hand to your <<penis>>.
						<<set $NPCList[$righttarget].lefthand to "penisentrance">><<set $penisuse to 1>><<set $penisstate to "otherhandentrance">>
					<<case "pussy">>
						Your lower <<someones $lefttarget>> hand to your <<pussy>>.
						<<set $NPCList[$righttarget].lefthand to "vaginaentrance">><<set $vaginause to 1>><<set $vaginastate to "otherhandentrance">>
					<<case "ass">>
						You press <<someones $lefttarget>> hand against your <<bottom>>.
						<<set $NPCList[$righttarget].lefthand to "anusentrance">><<set $anususe to "handentrance">><<set $anusstate to "handentrance">>
				<</switch>>
				<<set $rightactiondefault to "rest">><<set $rightarm to 0>><<submission 1>>
			<<else>>
				You try to guide <<someones $lefttarget>> hand to
				<<switch $handGuideRight>>
					<<case "penis">>your <<penis>>,
					<<case "pussy">>your <<pussy>>,
					<<case "ass">>your <<bottom>>,
				<</switch>>

				<<if $enemyanger gte random(30, 100)>>
					<span class="purple">but <<he>> wrenches it out of your grasp.</span>
					<<set $rightactiondefault to "rest">><<set $rightarm to 0>>
					<<set $NPCList[$righttarget].lefthand to 0>><<violence 2>>
				<<else>>
					but <<his>> grip is too tight.
				<</if>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftgrab">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftgrab">><<handskilluse>><<combatpromiscuity3>>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<submission 1>><<handstat>>
				<<if $NPCList[$lefttarget].penis is 0>>
					<<set $leftactiondefault to "leftwork">><<set $NPCList[$lefttarget].penis to "leftarm">><<set $leftarm to "penis">>
					<span class="lblue">You <<handtext>> <<if $NPCList[$lefttarget].chastity.penis.includes("chastity")>>fondle<<else>>grab<</if>> <<hisselect $lefttarget>> $NPCList[$lefttarget].penisdesc<<if $NPCList[$lefttarget].chastity.penis.includes("chastity")>> through <<hisselect $lefttarget>> $NPCList[$lefttarget].chastity.penis<</if>> with your left hand.</span>
				<<else>>
					<span class="blue">You try to grab <<hisselect $lefttarget>> $NPCList[$lefttarget].penisdesc with your left hand, but the phallus is already occupied.</span>
				<</if>>
			<<else>>
				You try to grab <<someones $lefttarget>> penis with your left hand, but <<he>> moves it away.
			<</if>>
		<</if>>

		<<if $rightaction is "rightgrab">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightgrab">><<handskilluse>><<combatpromiscuity3>>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<submission 1>><<handstat>>
				<<if $NPCList[$righttarget].penis is 0>>
					<<set $NPCList[$righttarget].penis to "rightarm">><<set $rightarm to "penis">>
					<span class="lblue">You <<handtext>> <<if $NPCList[$righttarget].chastity.penis.includes("chastity")>>fondle<<else>>grab<</if>> <<hisselect $righttarget>> $NPCList[$righttarget].penisdesc<<if $NPCList[$righttarget].chastity.penis.includes("chastity")>> through <<hisselect $righttarget>> $NPCList[$righttarget].chastity.penis<</if>> with your right hand.</span>
				<<else>>
					<span class="blue">You try to grab <<hisselect $righttarget>> $NPCList[$righttarget].penisdesc with your right hand, but the phallus is already occupied.</span>
				<</if>>
			<<else>>
				You try to grab <<someones $righttarget>> penis with your right hand, but <<he>> moves it away.
			<</if>>
		<</if>>

		<<if $leftaction is "leftstroke" and $rightaction is "rightstroke">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "leftstroke">><<set $rightactiondefault to "rightstroke">>
			<<submission 2>><<actionspenisstroke $lefttarget $righttarget>><<handskilluse>><<handskilluse>>
		<</if>>

		<<if $leftaction is "leftstroke">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftstroke">><<submission 1>><<actionspenisstroke $lefttarget>><<handskilluse>>
		<</if>>

		<<if $rightaction is "rightstroke">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightstroke">><<submission 1>><<actionspenisstroke $righttarget>><<handskilluse>>
		<</if>>

		<<if $leftaction is "leftwork">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftwork">><<handskilluse>>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<submission 3>><<actionsshaftrub $lefttarget>>
			<<elseif $NPCList[$lefttarget].penis is "leftarm">>
				<<set $leftactiondefault to "leftgrab">>
				<<set $leftarm to 0>><<set $NPCList[$lefttarget].penis to 0>>
				<span class="blue">You try to rub <<hisselect $lefttarget>> shaft, but <<he>> moves away.</span>
			<</if>>
		<</if>>

		<<if $rightaction is "rightwork">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightwork">><<handskilluse>>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<submission 3>><<actionsshaftrub $righttarget>>
			<<elseif $NPCList[$righttarget].penis is "rightarm">>
				<<set $rightactiondefault to "rightgrab">>
				<<set $rightarm to 0>><<set $NPCList[$righttarget].penis to 0>>
				<span class="blue">You try to rub <<hisselect $righttarget>> shaft, but <<he>> moves away.</span>
			<</if>>
		<</if>>

		<<if $leftaction is "handedge">>
			<<personselect $lefttarget>><<actionshandedge $lefttarget $leftarm>><<set $leftaction to 0>><<set $leftactiondefault to "handedge">>
			<<submission 5>><<sexControl 5 `currentSkillValue("handskill")` $lefttarget>><<handskilluse>>
		<</if>>

		<<if $rightaction is "handedge">>
			<<personselect $righttarget>><<actionshandedge $righttarget $rightarm>><<set $rightaction to 0>><<set $rightactiondefault to "handedge">>
			<<submission 5>><<sexControl 5 `currentSkillValue("handskill")` $righttarget>><<handskilluse>>
		<</if>>

		<<if $leftaction is "leftstoppenis" and $NPCList[$lefttarget].penis is "leftarm">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftstoppenis">><<submission 3>><<set $leftarm to 0>>
			<<set $NPCList[$lefttarget].penis to 0>>You let go of <<hisselect $lefttarget>> penis.
		<</if>>

		<<if $rightaction is "rightstoppenis" and $NPCList[$righttarget].penis is "rightarm">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightstoppenis">><<submission 3>><<set $rightarm to 0>>
			<<set $NPCList[$righttarget].penis to 0>>You let go of <<hisselect $righttarget>> penis.
		<</if>>

		<<if $leftaction is "leftstruggle" and $rightaction is "rightstruggle" and !$abomination and $lefttarget is $righttarget>>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "leftstruggle">><<set $rightactiondefault to "rightstruggle">>
			You struggle with all your might.
			<<defiance 2 $lefttarget>><<set $speechstruggle to 1>>
			/* 北极星模组 */
			<<if currentSkillValue('physique') gte random(1, 32000) and !$robinRentEvent or $slime gt 0 and $options.bjx_eventTF>>
				<span class="teal">你设法挣脱出手臂<<if $slime is 1 and $options.bjx_eventTF>><span class='green'>，并在这过程中灼伤袭击者</span><</if>>。</span>
				<<if $slime gt 0 and $options.bjx_eventTF>><span class='green'>这很简单。</span><</if>>
			/* 北极星 */
				<<defiance 5 $lefttarget>>
				<<set $leftarm to 0>><<set $rightarm to 0>>
				<<if $NPCList[$lefttarget].lefthand is "arms">>
					<<set $NPCList[$lefttarget].lefthand to 0>>
				<</if>>
				<<if $NPCList[$lefttarget].righthand is "arms">>
					<<set $NPCList[$lefttarget].righthand to 0>>
				<</if>>
			<<else>>
				<span class="purple">Your arms remain grasped.</span>
			<</if>>
		<</if>>

		<<if $leftaction is "leftstruggle" and !$abomination>>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftstruggle">>
			You struggle.
			<<set $speechstruggle to 1>><<defiance 1 $lefttarget>>
			/* 北极星模组 */
			<<if currentSkillValue('physique') gte random(1, 64000) and !$robinRentEvent or $slime gt 0 and $options.bjx_eventTF>>
				<span class="teal">你设法挣脱出手臂<<if $slime is 1 and $options.bjx_eventTF>><span class='green'>，并在这过程中灼伤袭击者</span><</if>>。</span>
				<<if $slime gt 0 and $options.bjx_eventTF>><span class='green'>这很简单。</span><</if>>
			/* 北极星 */
				<<defiance 5 $lefttarget>>
				<<set $leftarm to 0>><<set $rightarm to 0>>
				<<if $NPCList[$lefttarget].lefthand is "arms">>
					<<set $NPCList[$lefttarget].lefthand to 0>>
				<</if>>
				<<if $NPCList[$lefttarget].righthand is "arms">>
					<<set $NPCList[$lefttarget].righthand to 0>>
				<</if>>
			<<else>>
				<span class="purple">Your arms remain grasped.</span>
			<</if>>
		<</if>>

		<<if $rightaction is "rightstruggle" and !$abomination>>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightstruggle">>
			You struggle.
			<<defiance 1 $righttarget>><<set $speechstruggle to 1>>
			/* 北极星模组 */
			<<if currentSkillValue('physique') gte random(1, 64000) and !$robinRentEvent or $slime gt 0 and $options.bjx_eventTF>>
				<span class="teal">你设法挣脱出手臂<<if $slime is 1 and $options.bjx_eventTF>><span class='green'>，并在这过程中灼伤袭击者</span><</if>>。</span>
				<<if $slime gt 0 and $options.bjx_eventTF>><span class='green'>这很简单。</span><</if>>
			/* 北极星 */
				<<defiance 5 $righttarget>>
				<<set $leftarm to 0>><<set $rightarm to 0>>
				<<if $NPCList[$righttarget].lefthand is "arms">>
					<<set $NPCList[$righttarget].lefthand to 0>>
				<</if>>
				<<if $NPCList[$righttarget].righthand is "arms">>
					<<set $NPCList[$righttarget].righthand to 0>>
				<</if>>
			<<else>>
				<span class="purple">Your arms remain grasped.</span>
			<</if>>
		<</if>>

		<<if $leftaction is "rest" and $rightaction is "rest">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "rest">><<set $rightactiondefault to "rest">>
			You rest your arms.
		<</if>>

		<<if $leftaction is "rest">>
			<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			You rest your left arm.
		<</if>>

		<<if $rightaction is "rest">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			You rest your right arm.
		<</if>>

		<<if $leftaction is "behind" and $rightaction is "behind">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "behind">><<set $rightactiondefault to "behind">>
			You hold your arms behind your back in a compliant gesture.
			<<meek 2>><<set $leftarm to "behind">><<set $rightarm to "behind">>
		<</if>>

		<<if $leftaction is "behind">>
			<<set $leftaction to 0>><<set $leftactiondefault to "behind">>
			You hold your left arm behind your back in a compliant gesture.
			<<meek 1>><<set $leftarm to "behind">>
		<</if>>

		<<if $rightaction is "behind">>
			<<set $rightaction to 0>><<set $rightactiondefault to "behind">>
			You hold your right arm behind your back in a compliant gesture.
			<<meek 1>><<set $rightarm to "behind">>
		<</if>>

		<<if $leftaction is "stopbehind" and $rightaction is "stopbehind">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "rest">><<set $rightactiondefault to "rest">>
			You move your arms in front of you.
			<<set $leftarm to 0>><<set $rightarm to 0>>
		<</if>>

		<<if $leftaction is "stopbehind">>
			<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			You move your left arm in front of you.
			<<set $leftarm to 0>>
		<</if>>

		<<if $rightaction is "stopbehind">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			You move your right arm in front of you.
			<<set $rightarm to 0>>
		<</if>>

		<<if $leftaction is "leftchest" and $rightaction is "rightchest">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "leftchest">>
			<<set $rightactiondefault to "rightchest">><<actionsStroke $lefttarget $righttarget>><<submission 2>>
		<</if>>

		<<if $leftaction is "leftchest">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftchest">><<actionsStroke $lefttarget>><<submission 1>>
		<</if>>

		<<if $rightaction is "rightchest">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightchest">><<actionsStroke $righttarget>><<submission 1>>
		<</if>>
		
		/* 北极星模组 */
		<<if $leftaction is "antiquebell" or $rightaction is "antiquebell">>
		    <<if $leftaction is "antiquebell">>
			    <<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			<</if>>
			<<if $rightaction is "antiquebell">>
			    <<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			<</if>>
			你拿起恐惧铃铛，有规律地摇响，瞬间你心跳加速，莫大的恐惧席卷而来。
            <br>
            你强迫着自己继续摇动，天空撕裂开来，阴影延伸着，朝你和你的对手袭来。
            <br>
            没过多久，你的对手就仰面躺倒在地上，表情扭曲着，掐住了自己的脖子，艰难的喘着气。
            <br>
            <<set $enemyhealth to 0>>
            <<set $finish to 1>>
            <<willpowerdifficulty 1 900>>
            <<if $willpowerSuccess>>
            	你深呼吸了几次，这只是幻觉而已，你安慰着自己。
            	<<gwillpower>><<gtrauma>><<gstress>>
            	<<willpower 5>><<trauma 500>><<set $stress += $stressmax / 5>>
            	<br>
            <<else>>
            	阴影如仿若无物地穿过了你的双臂，但又实打实地扼住了你的咽喉。<span class="red">你喘不过气来了。</span>
            	<<llcontrol>><<ggtrauma>><<gggstress>>
            	<<control -100>><<trauma 500>><<set $stress += $stressmax>>
            	<br>
            <</if>>
		<</if>>
		
		<<if $leftaction is "antiquemushroom" or $rightaction is "antiquemushroom">>
		    <<if $leftaction is "antiquemushroom">>
			    <<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			<</if>>
			<<if $rightaction is "antiquemushroom">>
			    <<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			<</if>>
			你拿出蘑菇神像，抚摸上面神秘的花纹，顿时蘑菇神像发出紫色的幽光。
			<br>
			紫色的幽光覆盖了对方，好像从对方身躯中抽出了什么，送入了你的体内。
			<br>
			<<set $arousal += $enemyarousal>>
			<<set $enemyarousal to 0>>
			对方打了个哆嗦，表情从沉醉转为冷静，<<if $consensual isnot 1>>又转而变得愤怒，<<set $enemyanger += 50>><</if>>“你，你对我做了什么？”
			<br>
		<</if>>
		/* 北极星 */

		<<if $leftaction is "lefthit" and $rightaction is "righthit" and $lefttarget is $righttarget>>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "lefthit">>
			<<set $rightactiondefault to "righthit">><<actionshit both>><<defiance 5 $lefttarget>><<set $speechhit to 1>><<set $attackstat += 2>>
		<</if>>

		<<if $leftaction is "lefthit">>
			<<set $leftaction to 0>><<set $leftactiondefault to "lefthit">>
			<<if $parasite.left_ear.name is "slime" and random(1, 3) is 3 or $parasite.right_ear.name is "slime" and random(1, 3) is 3>>
				<<if $earSlime.corruption gte (currentSkillValue('willpower') / 10)>>
					You try to hit the <<if $enemytype is "beast">><<beasttype>><<else>><<personselect $lefttarget>><<person>><</if>>
					with your left hand, <span class="red">but the slime immobilises your limb.</span>
					<<gwillpower>><<willpower 1>>
				<<else>>
					The slime tries to immobilise your left arm, <span class="green">but you wrestle control away from it.</span>
					<<actionshit $lefttarget>><<defiance 2 $lefttarget>><<set $speechhit to 1>><<set $attackstat += 1>>
				<</if>>
			<<else>>
				<<actionshit $lefttarget>><<defiance 2 $lefttarget>><<set $speechhit to 1>><<set $attackstat += 1>>
			<</if>>
		<</if>>

		<<if $rightaction is "righthit">>
			<<set $rightaction to 0>><<set $rightactiondefault to "righthit">><<personselect $righttarget>>
			<<if $parasite.left_ear.name is "slime" and random(1, 3) is 3 or $parasite.right_ear.name is "slime" and random(1, 3) is 3>>
				<<if $earSlime.corruption gte (currentSkillValue('willpower') / 10)>>
					You try to hit the <<if $enemytype is "beast">><<beasttype>><<else>><<person>><</if>>
					with your right hand, <span class="red">but the slime immobilises your limb.</span>
					<<gwillpower>><<willpower 1>>
				<<else>>
					The slime tries to immobilise your right arm, <span class="green">but you wrestle control away from it.</span>
					<<actionshit $righttarget>><<defiance 2 $righttarget>><<set $speechhit to 1>><<set $attackstat += 1>>
				<</if>>
			<<else>>
				<<actionshit $righttarget>><<set $speechhit to 1>><<defiance 2 $righttarget>><<set $attackstat += 1>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftcamerapose" and $rightaction is "rightcamerapose">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "leftcamerapose">><<set $rightactiondefault to "rightcamerapose">>
			<<neutral 4>>
			You make peace signs for the cameras.
			<<set $speechcamerapose to 1>>
		<<elseif $leftaction is "leftcamerapose">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftcamerapose">>
			<<neutral 2>>
			You make a peace sign with your left hand.
			<<set $speechcamerapose to 1>>
		<<elseif $rightaction is "rightcamerapose">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightcamerapose">>
			<<neutral 2>>
			You make a peace sign with your right hand.
			<<set $speechcamerapose to 1>>
		<</if>>

		<<cover_end>>/*Resets $face and other variables that are covered */

		<<if $leftaction is "leftcoverface" and $rightaction is "rightcoverface">>
			<<if $uncomfortable.hypnosis is false and $hypnosis_traits.cover gte random(1,5)>>
				<<hypnosisicon>> You intend to cover your face, but a lewd thought intrudes <span class="lewd">and your mind immediately accepts it.</span>
				You stroke your face with your hands, winking and teasing around your lips.
				<<submission 1>><<set $speechcamerapose to 1>><<hypnotised 1>>
				<<hypnosisicon>>
			<<elseif $hypnosis_traits.cover gte 1 and $willpower lt random(1, (200 * $hypnosis_traits.cover))>>
				<<hypnosisicon>> You intend to cover your face, <span class="pink">but the thought is snatched from your mind, and replaced with another.</span>
				You stroke your face with your hands, winking and teasing around your lips.
				<<submission 1>><<set $speechcamerapose to 1>><<hypnotised 1>><<willpower 1>>
				<<hypnosisicon>>
			<<else>>
				You
				<<if $hypnosis_traits.cover gte 1>>
					<span class="green">resist intrusive thoughts</span> and
				<</if>>
				cover your face with your hands.
				<<set $speechcoverface to 1>><<set $face to "covered">><<neutral 2>>
				<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "leftcoverface">><<set $rightactiondefault to "rightcoverface">>
			<</if>>
		<<elseif $leftaction is "leftcoverface">>
			<<if $uncomfortable.hypnosis is false and $hypnosis_traits.cover gte random(1,5)>>
				<<hypnosisicon>> You intend to cover your face, but a lewd thought intrudes <span class="lewd">and your mind immediately accepts it.</span>
				You stroke your face with your left hand, winking and teasing around your lips.
				<<submission 1>><<set $speechcamerapose to 1>><<hypnotised 1>>
				<<hypnosisicon>>
			<<elseif $hypnosis_traits.cover gte 1 and $willpower lt random(1, (200 * $hypnosis_traits.cover))>>
				<<hypnosisicon>> You intend to cover your face, <span class="pink">but the thought is snatched from your mind, and replaced with another.</span>
				You stroke your face with your left hand, winking and teasing around your lips.
				<<submission 1>><<set $speechcamerapose to 1>><<hypnotised 1>><<willpower 1>>
				<<hypnosisicon>>
			<<else>>
				You
				<<if $hypnosis_traits.cover gte 1>>
					<span class="green">resist intrusive thoughts</span> and
				<</if>>
				cover your face with your left hand.
				<<set $speechcoverface to 1>><<set $face to "covered">><<neutral 1>>
				<<set $leftaction to 0>><<set $leftactiondefault to "leftcoverface">>
			<</if>>
		<<elseif $rightaction is "rightcoverface">>
			<<if $uncomfortable.hypnosis is false and $hypnosis_traits.cover gte random(1,5)>>
				<<hypnosisicon>> You intend to cover your face, but a lewd thought intrudes <span class="lewd">and your mind immediately accepts it.</span>
				You stroke your face with your right hand, winking and teasing around your lips.
				<<submission 1>><<set $speechcamerapose to 1>><<hypnotised 1>>
				<<hypnosisicon>>
			<<elseif $hypnosis_traits.cover gte 1 and $willpower lt random(1, (200 * $hypnosis_traits.cover))>>
				<<hypnosisicon>> You intend to cover your face, <span class="pink">but the thought is snatched from your mind, and replaced with another.</span>
				You stroke your face with your right hand, winking and teasing around your lips.
				<<submission 1>><<set $speechcamerapose to 1>><<hypnotised 1>><<willpower 1>>
				<<hypnosisicon>>
			<<else>>
				You
				<<if $hypnosis_traits.cover gte 1>>
					<span class="green">resist intrusive thoughts</span> and
				<</if>>
				cover your face with your right hand.
				<<set $speechcoverface to 1>><<set $face to "covered">><<neutral 1>>
				<<set $rightaction to 0>><<set $rightactiondefault to "rightcoverface">>
			<</if>>
		<</if>>

		/* Vagina Cover */

		<<if $leftaction is "leftcovervaginalewd" and $rightaction is "rightcovervaginalewd">>
			<<effectsCoverVagina "both" "lewd">>
		<<elseif $leftaction is "leftcovervaginalewd">>
			<<effectsCoverVagina "left" "lewd">>
		<<elseif $rightaction is "rightcovervaginalewd">>
			<<effectsCoverVagina "right" "lewd">>
		<</if>>

		<<if $leftaction is "leftcovervaginameek" and $rightaction is "rightcovervaginameek">>
			<<effectsCoverVagina "both" "meek">>
		<<elseif $leftaction is "leftcovervaginameek">>
			<<effectsCoverVagina "left" "meek">>
		<<elseif $rightaction is "rightcovervaginameek">>
			<<effectsCoverVagina "right" "meek">>
		<</if>>

		<<if $leftaction is "leftcovervagina" and $rightaction is "rightcovervagina">>
			<<effectsCoverVagina "both">>
		<<elseif $leftaction is "leftcovervagina">>
			<<effectsCoverVagina "left">>
		<<elseif $rightaction is "rightcovervagina">>
			<<effectsCoverVagina "right">>
		<</if>>

		/* Penis Cover */

		<<if $leftaction is "leftcoverpenislewd" and $rightaction is "rightcoverpenislewd">>
			<<effectsCoverPenis "both" "lewd">>
		<<elseif $leftaction is "leftcoverpenislewd">>
			<<effectsCoverPenis "left" "lewd">>
		<<elseif $rightaction is "rightcoverpenislewd">>
			<<effectsCoverPenis "right" "lewd">>
		<</if>>

		<<if $leftaction is "leftcoverpenismeek" and $rightaction is "rightcoverpenismeek">>
			<<effectsCoverPenis "both" "meek">>
		<<elseif $leftaction is "leftcoverpenismeek">>
			<<effectsCoverPenis "left" "meek">>
		<<elseif $rightaction is "rightcoverpenismeek">>
			<<effectsCoverPenis "right" "meek">>
		<</if>>

		<<if $leftaction is "leftcoverpenis" and $rightaction is "rightcoverpenis">>
			<<effectsCoverPenis "both">>
		<<elseif $leftaction is "leftcoverpenis">>
			<<effectsCoverPenis "left">>
		<<elseif $rightaction is "rightcoverpenis">>
			<<effectsCoverPenis "right">>
		<</if>>

		/* Anus Cover */

		<<if $leftaction is "leftcoveranuslewd" and $rightaction is "rightcoveranuslewd">>
			<<effectsCoverAnus "both" "lewd">>
		<<elseif $leftaction is "leftcoveranuslewd">>
			<<effectsCoverAnus "left" "lewd">>
		<<elseif $rightaction is "rightcoveranuslewd">>
			<<effectsCoverAnus "right" "lewd">>
		<</if>>

		<<if $leftaction is "leftcoveranusmeek" and $rightaction is "rightcoveranusmeek">>
			<<effectsCoverAnus "both" "meek">>
		<<elseif $leftaction is "leftcoveranusmeek">>
			<<effectsCoverAnus "left" "meek">>
		<<elseif $rightaction is "rightcoveranusmeek">>
			<<effectsCoverAnus "right" "meek">>
		<</if>>

		<<if $leftaction is "leftcoveranus" and $rightaction is "rightcoveranus">>
			<<effectsCoverAnus "both">>
		<<elseif $leftaction is "leftcoveranus">>
			<<effectsCoverAnus "left">>
		<<elseif $rightaction is "rightcoveranus">>
			<<effectsCoverAnus "right">>
		<</if>>

		<<if $leftaction is "leftstopvagina" and $rightaction is "rightstopvagina">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "leftstopvagina">><<set $rightactiondefault to "rightstopvagina">>
			You stop shielding your pussy with your hands.
			<<set $leftarm to 0>><<set $rightarm to 0>><<set $vaginause to 0>><<meek 2>>
		<</if>>

		<<if $leftaction is "leftstopcoverpenis" and $rightaction is "rightstopcoverpenis">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "leftstopcoverpenis">><<set $rightactiondefault to "rightstopcoverpenis">>
			You stop shielding your penis with your hands.
			<<set $leftarm to 0>><<set $rightarm to 0>><<set $penisuse to 0>><<meek 2>>
		<</if>>

		<<if $leftaction is "leftstopanus" and $rightaction is "rightstopanus">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "leftstopanus">><<set $rightactiondefault to "rightstopanus">>
			You stop shielding your <<bottom>> with your hands.
			<<set $leftarm to 0>><<set $rightarm to 0>><<set $anususe to 0>><<meek 2>>
		<</if>>

		<<if $leftaction is "leftstopvagina">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftstopvagina">>
			You stop covering your pussy with your left hand.
			<<set $leftarm to 0>>
			<<if $rightarm isnot "vagina">>
				<<set $vaginause to 0>>
			<</if>><<meek 1>>
		<</if>>

		<<if $leftaction is "leftstopcoverpenis">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftstopcoverpenis">>
			You stop covering your penis with your left hand.
			<<set $leftarm to 0>>
			<<if $rightarm isnot "coverpenis">>
				<<set $penisuse to 0>>
			<</if>>
			<<meek 1>>
		<</if>>

		<<if $leftaction is "leftstopanus">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftstopanus">>
			You stop covering your <<bottom>> with your left hand.
			<<set $leftarm to 0>>
			<<if $rightarm isnot "anus">>
				<<set $anususe to 0>>
			<</if>>
			<<meek 1>>
		<</if>>

		<<if $rightaction is "rightstopvagina">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightstopvagina">>
			You stop covering your vagina with your right hand.
			<<set $rightarm to 0>>
			<<if $leftarm isnot "vagina">>
				<<set $vaginause to 0>>
			<</if>>
			<<meek 1>>
		<</if>>

		<<if $rightaction is "rightstopcoverpenis">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightstopcoverpenis">>
			You stop covering your penis with your right hand.
			<<set $rightarm to 0>>
			<<if $leftarm isnot "coverpenis">>
				<<set $penisuse to 0>>
			<</if>>
			<<meek 1>>
		<</if>>

		<<if $rightaction is "rightstopanus">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightstopanus">>
			You stop covering you anus with your right hand.
			<<set $rightarm to 0>>
			<<if $leftarm isnot "anus">>
				<<set $anususe to 0>>
			<</if>>
			<<meek 1>>
		<</if>>

		<<if $leftaction is "leftclit">>
		<<set $leftaction to 0>><<set $leftactiondefault to "leftclit">><<handskilluse>>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<actionsclitstroke $lefttarget>><<submission 10>><<set $speechhandjobvagina to 1>>
			<<elseif $NPCList[$lefttarget].vagina is "leftarm">>
				<<set $leftarm to 0>><<set $leftactiondefault to "leftplay">>
				<<set $NPCList[$lefttarget].vagina to 0>><<personselect $lefttarget>>
				<span class="blue">You stroke <<hisselect $lefttarget>> clit, but <<he>>
				<<if $enemytype isnot "beast">>slaps your hand away<<else>>shifts way from you and growls<</if>>.</span>
			<</if>>
		<</if>>

		<<if $rightaction is "rightclit">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightclit">><<handskilluse>>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<actionsclitstroke $righttarget>><<submission 10>><<set $speechhandjobvagina to 1>>
			<<elseif $NPCList[$righttarget].vagina is "rightarm">>
				<<set $rightarm to 0>><<set $rightactiondefault to "rightplay">>
				<<set $NPCList[$righttarget].vagina to 0>><<personselect $righttarget>>
				<span class="blue">You stroke <<hisselect $righttarget>> clit, but <<he>>
				<<if $enemytype isnot "beast">>slaps your hand away<<else>>shifts way from you and growls<</if>>.</span>
			<</if>>
		<</if>>

		<<if $leftaction is "leftothervaginastop" and $NPCList[$lefttarget].vagina is "leftarm">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftothervaginastop">>
			<<set $NPCList[$lefttarget].vagina to 0>><<set $leftarm to 0>>
			<span class="blue">You move your left hand away from <<hisselect $lefttarget>> pussy.</span>
		<</if>>

		<<if $rightaction is "rightothervaginastop" and $NPCList[$righttarget].vagina is "rightarm">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightothervaginastop">>
			<<set $NPCList[$righttarget].vagina to 0>><<set $rightarm to 0>>
			<span class="blue">You move your right hand away from <<hisselect $righttarget>> pussy.</span>
		<</if>>

		<<if $leftaction is "leftplay">>
			<<set $leftaction to 0>><<handskilluse>><<set $leftactiondefault to "leftplay">><<combatpromiscuity3>>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<submission 1>><<handstat>>
				<<if $NPCList[$lefttarget].vagina is 0>>
					<<set $leftactiondefault to "leftclit">><<set $NPCList[$lefttarget].vagina to "leftarm">><<set $leftarm to "othervagina">><<personselect $lefttarget>>
					<span class="lblue">You <<handtext>> grab <<hisselect $lefttarget>> pussy<<if $NPCList[$lefttarget].chastity.vagina.includes("chastity")>> through <<his>> $NPCList[$lefttarget].chastity.vagina<</if>> with your left hand.</span>
				<<else>>
					<span class="blue">You try to grab <<hisselect $lefttarget>> pussy with your left hand, but the entrance is already occupied.</span>
				<</if>>
			<<else>>
				You try to grab <<hisselect $lefttarget>> pussy with your left hand, but <<he>> moves it away.
			<</if>>
		<</if>>

		<<if $rightaction is "rightplay">>
			<<set $rightaction to 0>><<handskilluse>><<set $rightactiondefault to "rightplay">><<combatpromiscuity3>>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<submission 1>><<handstat>>
				<<if $NPCList[$righttarget].vagina is 0>>
					<<set $rightactiondefault to "rightclit">><<set $NPCList[$righttarget].vagina to "rightarm">><<set $rightarm to "othervagina">><<personselect $righttarget>>
					<span class="lblue">You <<handtext>> grab <<hisselect $righttarget>> pussy<<if $NPCList[$righttarget].chastity.vagina.includes("chastity")>> through <<his>> $NPCList[$righttarget].chastity.vagina<</if>> with your right hand.</span>
				<<else>>
					<span class="blue">You try to grab <<hisselect $righttarget>> pussy with your right hand, but the entrance is already occupied.</span>
				<</if>>
			<<else>>
				You try to grab <<hisselect $righttarget>> pussy with your right hand, but <<he>> moves it away.
			<</if>>
		<</if>>

		<<if $leftaction is "leftunderpull" and $rightaction is "rightunderpull">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<brat 1>><<set $leftactiondefault to "leftunderpull">><<set $rightactiondefault to "rightunderpull">>
			<<if $worn.under_lower.name is "naked">>
				You clutch the tattered remains of your clothing.
				<<brat 2>>
			<<else>>
				<<for _j = 0; _j lt $enemynomax; _j++>>
					<<if $NPCList[_j].lefthand is "underlowerclothes" or $NPCList[_j].righthand is "underlowerclothes" or (_j is 0 and $NPCList[_j].mouth is "underlowerclothes")>>
						You struggle for control of your $worn.under_lower.name.
						<<brat 2>><<set $underlowerstruggle to 1>>
						<<break>>
					<</if>>
				<</for>>
				<<if $underlowerstruggle is 0>>
					<<if $worn.under_lower.state is "ankles">>
						<<set $worn.under_lower.state to "knees">>
						You pull your $worn.under_lower.name up to your knees.
					<<elseif $worn.under_lower.state is "knees">>
						<<set $worn.under_lower.state to "thighs">>
						You pull your $worn.under_lower.name up to your thighs.
					<<elseif $worn.under_lower.state is "thighs">>
						<<if $vaginause is 0 and $anususe is 0>>
							You pull your $worn.under_lower.name up to your waist.
							<<set $worn.under_lower.state to "waist">><<set $worn.under_lower.exposed to setup.clothes.under_lower[clothesIndex('under_lower', $worn.under_lower)].exposed_base>>
							<<set $worn.under_lower.vagina_exposed to setup.clothes.under_lower[clothesIndex('under_lower', $worn.under_lower)].vagina_exposed_base>>
							<<set $worn.under_lower.anus_exposed to setup.clothes.under_lower[clothesIndex('under_lower', $worn.under_lower)].anus_exposed_base>>
						<<else>>
							You try to pull up your $worn.under_lower.name, but something is in the way.
						<</if>>
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftunderpull">>
			<<set $leftaction to 0>><<brat 1>><<set $leftactiondefault to "leftunderpull">>
			<<if $worn.under_lower.name is "naked">>
				You clutch the tattered remains of your clothing.
			<<else>>
				<<if !$NPCList.some(npc => npc.lefthand !== "underlowerclothes" || npc.righthand !== "underlowerclothes" || npc.mouth !== "underlowerclothes")>>
					<<if $worn.under_lower.state is "ankles">>
						<<set $worn.under_lower.state to "knees">>
						You pull your $worn.under_lower.name up to your knees.
					<<elseif $worn.under_lower.state is "knees">>
						<<set $worn.under_lower.state to "thighs">>
						You pull your $worn.under_lower.name up to your thighs.
					<<elseif $worn.under_lower.state is "thighs">>
						<<if $vaginause is 0 and $anususe is 0>>
							You pull your $worn.under_lower.name up to your waist.
							<<set $worn.under_lower.state to "waist">><<set $worn.under_lower.exposed to setup.clothes.under_lower[clothesIndex('under_lower', $worn.under_lower)].exposed_base>>
							<<set $worn.under_lower.vagina_exposed to setup.clothes.under_lower[clothesIndex('under_lower', $worn.under_lower)].vagina_exposed_base>>
							<<set $worn.under_lower.anus_exposed to setup.clothes.under_lower[clothesIndex('under_lower', $worn.under_lower)].anus_exposed_base>>
						<<else>>
							You try to pull up your $worn.under_lower.name, but something is in the way.
						<</if>>
					<</if>>
				<<else>>
					You try to pull up your $worn.under_lower.name, but one hand won't be enough.
					<<brat 1>>
				<</if>>
			<</if>>
		<</if>>

		<<if $rightaction is "rightunderpull">>
			<<set $rightaction to 0>><<brat 1>><<set $rightactiondefault to "rightunderpull">>
			<<if $worn.under_lower.name is "naked">>
				You clutch the tattered remains of your clothing.
			<<else>>
				<<if !$NPCList.some(npc => npc.lefthand !== "underlowerclothes" || npc.righthand !== "underlowerclothes" || npc.mouth !== "underlowerclothes")>>
					<<if $worn.under_lower.state is "ankles">>
						<<set $worn.under_lower.state to "knees">>
						You pull your $worn.under_lower.name up to your knees.
					<<elseif $worn.under_lower.state is "knees">>
						<<set $worn.under_lower.state to "thighs">>
						You pull your $worn.under_lower.name up to your thighs.
					<<elseif $worn.under_lower.state is "thighs">>
						<<if $vaginause is 0 and $anususe is 0>>
							You pull your $worn.under_lower.name up to your waist.
							<<set $worn.under_lower.state to "waist">><<set $worn.under_lower.exposed to setup.clothes.under_lower[clothesIndex('under_lower', $worn.under_lower)].exposed_base>>
							<<set $worn.under_lower.vagina_exposed to setup.clothes.under_lower[clothesIndex('under_lower', $worn.under_lower)].vagina_exposed_base>>
							<<set $worn.under_lower.anus_exposed to setup.clothes.under_lower[clothesIndex('under_lower', $worn.under_lower)].anus_exposed_base>>
						<<else>>
							You try to pull up your $worn.under_lower.name, but one hand won't be enough.
						<</if>>
					<</if>>
				<<else>>
					You try to pull up your $worn.under_lower.name, but you aren't strong enough.
					<<brat 1>>
				<</if>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftskirtpull" and $rightaction is "rightskirtpull">>
			<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "leftskirtpull">><<set $rightactiondefault to "rightskirtpull">><<brat 1>>
			<<if $worn.lower.name is "naked">>
				You clutch the tattered remains of your clothing.
			<<else>>
				You pull your $worn.lower.name down with both hands, covering your crotch.
				<<set $worn.lower.skirt_down to 1>><<set $worn.lower.vagina_exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].vagina_exposed_base>>
				<<set $worn.lower.anus_exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].anus_exposed_base>><<set $worn.lower.exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].exposed_base>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftskirtpull">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftskirtpull">><<brat 1>>
			<<if $worn.lower.name is "naked">>
				You clutch the tattered remains of your clothing.
			<<else>>
				You pull your $worn.lower.name back down, covering your crotch.
				<<set $worn.lower.skirt_down to 1>><<set $worn.lower.vagina_exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].vagina_exposed_base>>
				<<set $worn.lower.anus_exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].anus_exposed_base>><<set $worn.lower.exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].exposed_base>>
			<</if>>
		<</if>>

		<<if $rightaction is "rightskirtpull">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightskirtpull">><<brat 1>>
			<<if $worn.lower.name is "naked">>
				You clutch the tattered remains of your clothing.
			<<else>>
				You pull your $worn.lower.name back down, covering your crotch.
				<<set $worn.lower.skirt_down to 1>><<set $worn.lower.vagina_exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].vagina_exposed_base>>
				<<set $worn.lower.anus_exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].anus_exposed_base>><<set $worn.lower.exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].exposed_base>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftlowerpull" or $rightaction is "rightlowerpull">>
			<<set $_strength to 0>>
			<<if $leftaction is "leftlowerpull">>
				<<set $leftaction to 0>><<set $leftactiondefault to "leftlowerpull">><<set $_strength++>>
			<</if>>
			<<if $rightaction is "rightlowerpull">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rightlowerpull">><<set $_strength++>>
			<</if>>
			<<brat 1>>
			<<if $worn.lower.name is "naked">>
				You clutch the tattered remains of your clothing.
				<<brat 2>>
			<<else>>
				<<if $underlowerstruggle is 0>>
					<<for _j = 0; _j lt $enemynomax; _j++>>
						<<if $NPCList[_j].lefthand is "lowerclothes" or $NPCList[_j].righthand is "lowerclothes" or (_j is 0 and $NPCList[_j].mouth is "lowerclothes")>>
							<<if $_strength is 2>>
								You struggle for control of your $worn.lower.name.
								<<brat 2>><<set $lowerstruggle to 1>><<set _lowerpull to "failed">>
								<<break>>
							<<else>>
								You try to pull up your $worn.lower.name, but you aren't strong enough.
								<<brat 1>><<set _lowerpull to "failed">>
								<<break>>
							<</if>>
						<</if>>
					<</for>>
					<<if _leftlowerpull isnot "failed">>
						<<if $vaginause isnot 0 and $vaginause isnot "none">>
							Your $worn.lower.name hang loosely, but you can't adjust <<lowerit>> while your <<pussy>> is threatened.
						<<elseif $penisuse isnot 0 and $penisuse isnot "none">>
							Your $worn.lower.name hang loosely, but you can't adjust <<lowerit>> while your <<penis>> is threatened.
						<<elseif $anususe isnot 0>>
							Your $worn.lower.name hang loosely, but you can't adjust <<lowerit>> while your <<bottom>> is threatened.
						<<else>>
							You fix your
							<<if $worn.over_lower.exposed gt 0>>
								$worn.lower.name, concealing your
								<<if $worn.under_lower.exposed gte 1>>
									<<genitals>>.
								<<else>>
									$worn.under_lower.name.
								<</if>>
							<<else>>
								$worn.lower.name.
							<</if>>
							<<brat 5>><<set $worn.lower.state to setup.clothes.lower[clothesIndex('lower', $worn.lower)].state_base>>
							<<if setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt is 1>><<set $worn.lower.skirt_down to 1>><</if>>
							<<set $worn.lower.vagina_exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].vagina_exposed_base>>
							<<set $worn.lower.anus_exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].anus_exposed_base>><<set $worn.lower.exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].exposed_base>>
						<</if>>
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftoverlowerpull" or $rightaction is "rightoverlowerpull">>
			<<set $_strength to 0>>
			<<if $leftaction is "leftoverlowerpull">>
				<<set $leftaction to 0>><<set $leftactiondefault to "leftoverlowerpull">><<set $_strength++>>
			<</if>>
			<<if $rightaction is "rightoverlowerpull">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rightoverlowerpull">><<set $_strength++>>
			<</if>>
			<<brat 1>>
			<<if $worn.over_lower.name is "naked">>
				You clutch the tattered remains of your clothing.
				<<brat 2>>
			<<else>>
				<<if $underlowerstruggle is 0>>
					<<for _j = 0; _j lt $enemynomax; _j++>>
						<<if $NPCList[_j].lefthand is "overlowerclothes" or $NPCList[_j].righthand is "overlowerclothes" or (_j is 0 and $NPCList[_j].mouth is "overlowerclothes")>>
							<<if $_strength is 2>>
								You struggle for control of your $worn.over_lower.name.
								<<brat 2>><<set $overlowerstruggle to 1>><<set _overlowerpull to "failed">>
								<<break>>
							<<else>>
								You try to pull up your $worn.over_lower.name, but you aren't strong enough.
								<<brat 1>><<set _overlowerpull to "failed">>
								<<break>>
							<</if>>
						<</if>>
					<</for>>
					<<if _overlowerpull isnot "failed">>
						<<if $vaginause isnot 0 and $vaginause isnot "none">>
							Your $worn.over_lower.name hang loosely, but you can't adjust <<overlowerit>> while your <<pussy>> is threatened.
						<<elseif $penisuse isnot 0 and $penisuse isnot "none">>
							Your $worn.over_lower.name hang loosely, but you can't adjust <<overlowerit>> while your <<penis>> is threatened.
						<<elseif $anususe isnot 0>>
							Your $worn.over_lower.name hang loosely, but you can't adjust <<overlowerit>> while your <<bottom>> is threatened.
						<<else>>
							You fix your
							<<if $worn.lower.exposed gt 0>>
								$worn.over_lower.name, concealing your
								<<if $worn.under_lower.exposed gte 1>>
									<<genitals>>.
								<<else>>
									$worn.under_lower.name.
								<</if>>
							<<else>>
								$worn.over_lower.name.
							<</if>>
							<<brat 5>><<set $worn.over_lower.state to setup.clothes.over_lower[clothesIndex('over_lower', $worn.over_lower)].state_base>>
							<<if setup.clothes.over_lower[clothesIndex('over_lower', $worn.over_lower)].skirt is 1>><<set $worn.over_lower.skirt_down to 1>><</if>>
							<<set $worn.over_lower.vagina_exposed to setup.clothes.over_lower[clothesIndex('over_lower', $worn.over_lower)].vagina_exposed_base>>
							<<set $worn.over_lower.anus_exposed to setup.clothes.over_lower[clothesIndex('over_lower', $worn.over_lower)].anus_exposed_base>><<set $worn.over_lower.exposed to setup.clothes.over_lower[clothesIndex('over_lower', $worn.over_lower)].exposed_base>>
						<</if>>
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftupperpull" or $rightaction is "rightupperpull">>
			<<set $_strength to 0>>
			<<if $leftaction is "leftupperpull">>
				<<set $leftaction to 0>><<set $leftactiondefault to "leftupperpull">><<set $_strength++>>
			<</if>>
			<<if $rightaction is "rightupperpull">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rightupperpull">><<set $_strength++>>
			<</if>>
			<<brat 1>>
			<<if $worn.upper.name is "naked">>
				You clutch the tattered remains of your clothing.
			<<else>>
				<<for _j = 0; _j lt $enemynomax; _j++>>
					<<if $NPCList[_j].lefthand is "upperclothes" or $NPCList[_j].righthand is "upperclothes" or (_j is 0 and $NPCList[_j].mouth is "upperclothes")>>
						<<if $_strength is 2>>
							You struggle for control of your $worn.upper.name.
							<<brat 2>><<set $upperstruggle to 1>><<set _upperpull to "failed">>
							<<break>>
						<<else>>
							You struggle for your $worn.upper.name, but you aren't strong enough.
							<<brat 1>><<set _upperpull to "failed">>
							<<break>>
						<</if>>
					<</if>>
				<</for>>
				<<if _upperpull isnot "failed">>
					<<if $vaginause isnot 0 and $vaginause isnot "none">>
						Your $worn.lower.name hang loosely, but you can't adjust <<lowerit>> while your <<pussy>> is threatened.
					<<elseif $penisuse isnot 0 and $penisuse isnot "none">>
						Your $worn.lower.name hang loosely, but you can't adjust <<lowerit>> while your <<penis>> is threatened.
					<<elseif $anususe isnot 0>>
						Your $worn.lower.name hang loosely, but you can't adjust <<lowerit>> while your <<bottom>> is threatened.
					<<elseif $worn.lower.set is $worn.upper.set>>
						You fix your
						<<if $worn.over_upper.exposed gt 0 or $worn.over_lower.exposed gt 0>>
							$worn.upper.name, concealing your <<if $worn.over_upper.exposed gt 0>><<breasts>> <<if $worn.over_lower.exposed gt 0>>and<</if>><</if>>
							<<if $worn.over_lower.exposed is 0>>
							<<elseif $worn.under_lower.exposed gte 1>>
								<<genitals>>.
							<<else>>
								$worn.under_lower.name.
							<</if>>
						<<else>>
							$worn.upper.name.
						<</if>>
						<<brat 5>><<set $worn.upper.state to setup.clothes.upper[clothesIndex('upper', $worn.upper)].state_base>><<set $worn.upper.state_top to setup.clothes.upper[clothesIndex('upper', $worn.upper)].state_top_base>>
						<<set $worn.upper.exposed to setup.clothes.upper[clothesIndex('upper', $worn.upper)].exposed_base>><<set $worn.lower.state to setup.clothes.lower[clothesIndex('lower', $worn.lower)].state_base>>
						<<if setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt is 1>><<set $worn.lower.skirt_down to 1>><</if>><<set $worn.lower.vagina_exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].vagina_exposed_base>>
						<<set $worn.lower.anus_exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].anus_exposed_base>><<set $worn.lower.exposed to setup.clothes.lower[clothesIndex('lower', $worn.lower)].exposed_base>>
					<<else>>
						You fix your $worn.upper.name, concealing your <<breasts>>.
						<<brat 5>><<set $worn.upper.state to setup.clothes.upper[clothesIndex('upper', $worn.upper)].state_base>>
						<<set $worn.upper.state_top to setup.clothes.upper[clothesIndex('upper', $worn.upper)].state_top_base>><<set $worn.upper.exposed to setup.clothes.upper[clothesIndex('upper', $worn.upper)].exposed_base>>
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftoverupperpull" or $rightaction is "rightoverupperpull">>
			<<set $_strength to 0>>
			<<if $leftaction is "leftoverupperpull">>
				<<set $leftaction to 0>><<set $leftactiondefault to "leftoverupperpull">><<set $_strength++>>
			<</if>>
			<<if $rightaction is "rightoverupperpull">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rightoverupperpull">><<set $_strength++>>
			<</if>>
			<<brat 1>>
			<<if $worn.over_upper.name is "naked">>
				You clutch the tattered remains of your clothing.
			<<else>>
				<<for _j = 0; _j lt $enemynomax; _j++>>
					<<if $NPCList[_j].lefthand is "overupperclothes" or $NPCList[_j].righthand is "overupperclothes" or (_j is 0 and $NPCList[_j].mouth is "overupperclothes")>>
						<<if $_strength is 2>>
							You struggle for control of your $worn.over_upper.name.
							<<brat 2>><<set $overupperstruggle to 1>><<set _overupperpull to "failed">>
							<<break>>
						<<else>>
							You struggle for your $worn.over_upper.name, but you aren't strong enough.
							<<brat 1>><<set _overupperpull to "failed">>
							<<break>>
						<</if>>
					<</if>>
				<</for>>
				<<if _overupperpull isnot "failed">>
					<<if $vaginause isnot 0 and $vaginause isnot "none">>
						Your $worn.over_lower.name hang loosely, but you can't adjust <<overlowerit>> while your <<pussy>> is threatened.
					<<elseif $penisuse isnot 0 and $penisuse isnot "none">>
						Your $worn.over_lower.name hang loosely, but you can't adjust <<overlowerit>> while your <<penis>> is threatened.
					<<elseif $anususe isnot 0>>
						Your $worn.over_lower.name hang loosely, but you can't adjust <<overlowerit>> while your <<bottom>> is threatened.
					<<elseif $worn.over_lower.set is $worn.over_upper.set>>
						You fix your
						<<if $worn.upper.exposed gt 0 or $worn.lower.exposed gt 0>>
							$worn.over_upper.name, concealing your <<if $worn.upper.exposed gt 0>><<breasts>> <<if $worn.lower.exposed gt 0>>and<</if>><</if>>
							<<if $worn.lower.exposed is 0>>
							<<elseif $worn.under_lower.exposed gte 1>>
								<<genitals>>.
							<<else>>
								$worn.under_lower.name.
							<</if>>
						<<else>>
							$worn.over_upper.name.
						<</if>>
						<<brat 5>><<set $worn.over_upper.state to setup.clothes.over_upper[clothesIndex('over_upper', $worn.over_upper)].state_base>><<set $worn.over_upper.state_top to setup.clothes.over_upper[clothesIndex('over_upper', $worn.over_upper)].state_top_base>>
						<<set $worn.over_upper.exposed to setup.clothes.over_upper[clothesIndex('over_upper', $worn.over_upper)].exposed_base>><<set $worn.over_lower.state to setup.clothes.over_lower[clothesIndex('over_lower', $worn.over_lower)].state_base>>
						<<if setup.clothes.over_lower[clothesIndex('over_lower', $worn.over_lower)].skirt is 1>><<set $worn.over_lower.skirt_down to 1>><</if>><<set $worn.over_lower.vagina_exposed to setup.clothes.over_lower[clothesIndex('over_lower', $worn.over_lower)].vagina_exposed_base>>
						<<set $worn.over_lower.anus_exposed to setup.clothes.over_lower[clothesIndex('over_lower', $worn.over_lower)].anus_exposed_base>><<set $worn.over_lower.exposed to setup.clothes.over_lower[clothesIndex('over_lower', $worn.over_lower)].exposed_base>>
					<<else>>
						You fix your $worn.over_upper.name<<if $worn.upper.exposed gt 0>>, concealing your <<breasts>><</if>>.
						<<brat 5>><<set $worn.over_upper.state to setup.clothes.over_upper[clothesIndex('over_upper', $worn.over_upper)].state_base>>
						<<set $worn.over_upper.state_top to setup.clothes.over_upper[clothesIndex('over_upper', $worn.over_upper)].state_top_base>><<set $worn.over_upper.exposed to setup.clothes.over_upper[clothesIndex('over_upper', $worn.over_upper)].exposed_base>>
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<unset $keepchoke>>
		<<if $leftaction is "keepchoke" or $rightaction is "keepchoke">>
			<<if $neckuse is "hand">>
				<<if $leftaction is "keepchoke">>
					<<personselect $lefttarget>>
				<<else>>
					<<personselect $righttarget>>
				<</if>>

				<<if $leftactioncarry is "keepchoke" or $rightactioncarry is "keepchoke">>
					You keep pressing <<his>> hand against your neck.
				<<else>>
					You reach out to <<his>> hand holding your neck and push it harder against your soft skin. <span class="sub"><<His>> grip tightens around your throat.</span>
				<</if>>
			<</if>>
			<<if $leftaction is "keepchoke">>
				<<set $leftaction to 0>><<set $leftactiondefault to "keepchoke">><<submission 1>>
			<</if>>
			<<if $rightaction is "keepchoke">>
				<<set $rightaction to 0>><<set $rightactiondefault to "keepchoke">><<submission 1>>
			<</if>>
			<<set $keepchoke = 1>>
		<</if>>

		<<if $leftaction is "stopchoke" or $rightaction is "stopchoke">>
			<<if $leftaction is "stopchoke">>
				<<set $leftaction to 0>><<set $leftactiondefault to "stopchoke">>
				<<brat 1 $lefttarget>><<personselect $lefttarget>>
			<</if>>
			<<if $rightaction is "stopchoke">>
				<<set $rightaction to 0>><<set $rightactiondefault to "stopchoke">>
				<<brat 1 $righttarget>><<personselect $righttarget>>
			<</if>>

			<<if $neckuse is "hand">>
				You reach out to <<his>> hand on your neck and gently pull it away. <<He>> doesn't resist.
				<<unset $neckuse>>
				<<if $NPCList[_n].lefthand == "throat">>
					<<set $NPCList[_n].lefthand = 0>>
				<</if>>
				<<if $NPCList[_n].righthand == "throat">>
					<<set $NPCList[_n].righthand = 0>>
				<</if>>
			<</if>>
		<</if>>


		<<if $leftaction is "stopchokenoncon" or $rightaction is "stopchokenoncon">>
			<<set _handsCount = 0>>
			<<if $leftaction is "stopchokenoncon">>
				<<set $leftaction to 0>><<set $leftactiondefault to "stopchokenoncon">>
				<<defiance 2 $lefttarget>><<personselect $lefttarget>>
				<<set _handsCount++>>
			<</if>>
			<<if $rightaction is "stopchokenoncon">>
				<<set $rightaction to 0>><<set $rightactiondefault to "stopchokenoncon">>
				<<defiance 2 $righttarget>><<personselect $righttarget>>
				<<set _handsCount++>>
			<</if>>

			<<if $neckuse is "hand">>
				You dig your nails into <<his>> hand around your throat and pull it.
				<<defiance 2 _n>><<set $speechstruggle to 1>>
				<<if currentSkillValue('physique') gte random(1, 60000/_handsCount)>>
					<span class="teal">You manage to rip <<his>> hand off your throat.</span>
					<<defiance 5 _n>>
					<<unset $neckuse>>
					<<gaspair>>

					<<if $leftactiondefault == "stopchokenoncon">>
						<<set $leftactiondefault to "rest">>
					<</if>>
					<<if $rightactiondefault == "stopchokenoncon">>
						<<set $rightactiondefault to "rest">>
					<</if>>

					<<if $NPCList[_n].lefthand == "throat">>
						<<set $NPCList[_n].lefthand = 0>>
					<</if>>
					<<if $NPCList[_n].righthand == "throat">>
						<<set $NPCList[_n].righthand = 0>>
					<</if>>
				<<elseif currentSkillValue('physique') gte random(1, 40000/_handsCount)>>
					<<His>> hand doesn't move, however <span class="blue">you manage to gasp for a bit of air when <<his>> grip weakens momentarily</span>.
					<<oxygen 200>>
				<<else>>
					<span class="purple"><<His>> hand remains on your throat.</span>
				<</if>>
			<</if>>
		<</if>>

		<<if $rightaction is "rightUndressOther" and $leftaction is "leftUndressOther" and $lefttarget is $righttarget and $undressLeftTarget is $undressRightTarget>>
			<<if $undressLeftTarget is "rest">>
				<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "rest">><<set $rightactiondefault to "rest">>
				You rest your arms.
			<<else>>
				<<set $rightaction to 0>><<set $leftaction to 0>><<set $rightactiondefault to "rightUndressOther">><<set $leftactiondefault to "leftUndressOther">>
				<<handskilluse>><<combatpromiscuity2>><<brat 2 $righttarget>>
				<<set $_npc to $NPCList[$righttarget]>><<set $_clothesTarget to $undressRightTarget>>
				<<personselect $righttarget>>
				<<if combatSkillCheck("hand", $lefttarget, 700, $_npc.clothes[$_clothesTarget].integrity)>>
					<!-- Using a switch to make it easier to add more NPC clothes types later -->
					<<switch $_clothesTarget>>
						<<case "upper">>
							<span class="lblue">You <<handtext>> <<npcUndressText $_npc $_clothesTarget>> with both hands, <<npcRevealText $_npc $_clothesTarget>>.</span>
							<<set $_npc.chest to 0>>
						<<case "lower">>
							<span class="lblue">You <<handtext>> <<npcUndressText $_npc $_clothesTarget>> with both hands, <<npcRevealText $_npc $_clothesTarget>>.</span>
							<<if $_npc.fullDescription is "Sydney">>
								<<sydneyExpose>>
							<</if>>
							<<if $_npc.penis is "clothed">>
								<<npcGenitalReaction $_npc>>
								<<set $_npc.penis to 0>>
							<</if>>
							<<if $_npc.vagina is "clothed">>
								<<set $_npc.vagina to 0>>
							<</if>>
						<<default>>
							You try to undress <<him>>, but grab nothing but the air. <span class="red">Improper clothes target: $_clothesTarget. Please report this bug.</span>
					<</switch>>
				<<else>>
					You try to <<npcUndressText $_npc $_clothesTarget>>, but <<he>> holds on to <<his>> clothes.
					<<set $_npc.clothes[$_clothesTarget].integrity -= Math.floor((currentSkillValue("handskill") / 100) * 1.5)>>
				<</if>>
			<</if>>
			<<unset $undressLeftTarget>><<unset $undressRightTarget>>
		<</if>>

		<<if $rightaction is "rightUndressOther">>
			<<if $undressRightTarget is "rest">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
				You rest your right arm.
			<<else>>
				<<set $rightaction to 0>><<set $rightactiondefault to "rightUndressOther">><<handskilluse>><<combatpromiscuity2>><<brat 1 $righttarget>>
				<<set $_npc to $NPCList[$righttarget]>><<set $_clothesTarget to $undressRightTarget>>
				<<personselect $righttarget>>
				<<if combatSkillCheck("hand", $righttarget, 1000, $_npc.clothes[$_clothesTarget].integrity)>>
					<!-- Using a switch to make it easier to add more NPC clothes types later -->
					<<switch $_clothesTarget>>
						<<case "upper">>
							<span class="lblue">You <<handtext>> <<npcUndressText $_npc $_clothesTarget>>, <<npcRevealText $_npc $_clothesTarget>>.</span>
							<<set $_npc.chest to 0>>
						<<case "lower">>
							<span class="lblue">You <<handtext>> <<npcUndressText $_npc $_clothesTarget>>, <<npcRevealText $_npc $_clothesTarget>>.</span>
							<<if $_npc.fullDescription is "Sydney">>
								<<sydneyExpose>>
							<</if>>
							<<if $_npc.penis is "clothed">>
								<<npcGenitalReaction $_npc>>
								<<set $_npc.penis to 0>>
							<</if>>
							<<if $_npc.vagina is "clothed">>
								<<set $_npc.vagina to 0>>
							<</if>>
						<<default>>
							You try to undress <<him>>, but grab nothing but the air. <span class="red">Improper clothes target: $_clothesTarget. Please report this bug.</span>
					<</switch>>
				<<else>>
					You try to <<npcUndressText $_npc $_clothesTarget>>, but <<he>> holds on to <<his>> clothes.
					<<set $_npc.clothes[$_clothesTarget].integrity -= Math.floor(currentSkillValue("handskill") / 100)>>
				<</if>>
			<</if>>
			<<unset $undressRightTarget>>
		<</if>>

		<<if $leftaction is "leftUndressOther">>
			<<if $undressLeftTarget is "rest">>
				<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
				You rest your left arm.
			<<else>>
				<<set $leftaction to 0>><<set $leftactiondefault to "leftUndressOther">><<handskilluse>><<combatpromiscuity2>><<brat 1 $lefttarget>>
				<<set $_npc to $NPCList[$lefttarget]>><<set $_clothesTarget to $undressLeftTarget>>
				<<personselect $lefttarget>>
				<<if combatSkillCheck("hand", $lefttarget, 1000, $_npc.clothes[$_clothesTarget].integrity)>>
					<!-- Using a switch to make it easier to add more NPC clothes types later -->
					<<switch $_clothesTarget>>
						<<case "upper">>
							<span class="lblue">You <<handtext>> <<npcUndressText $_npc $_clothesTarget>>, <<npcRevealText $_npc $_clothesTarget>>.</span>
							<<set $_npc.chest to 0>>
						<<case "lower">>
							<span class="lblue">You <<handtext>> <<npcUndressText $_npc $_clothesTarget>>, <<npcRevealText $_npc $_clothesTarget>>.</span>
							<<if $_npc.fullDescription is "Sydney">>
								<<sydneyExpose>>
							<</if>>
							<<if $_npc.penis is "clothed">>
								<<npcGenitalReaction $_npc>>
								<<set $_npc.penis to 0>>
							<</if>>
							<<if $_npc.vagina is "clothed">>
								<<set $_npc.vagina to 0>>
							<</if>>
						<<default>>
							You try to undress <<him>>, but grab nothing but the air. <span class="red">Improper clothes target: $_clothesTarget. Please report this bug.</span>
					<</switch>>
				<<else>>
					You try to <<npcUndressText $_npc $_clothesTarget>>, but <<he>> holds on to <<his>> clothes.
					<<set $_npc.clothes[$_clothesTarget].integrity -= Math.floor(currentSkillValue("handskill") / 100)>>
				<</if>>
			<</if>>
			<<unset $undressLeftTarget>>
		<</if>>

		<<if $leftaction is "peniscondom" or $rightaction is "peniscondom">>
			<<if $leftaction is "peniscondom">>
				<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			<</if>>
			<<if $rightaction is "peniscondom">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			<</if>>
			<<set _foundnpc to $NPCList.filter(npc => npc.pregnancyAvoidance === 0).random()>>
			<<if _foundnpc>>
				<<personselect _foundnpc.index>>
				<<set $_stop to true>>
			<</if>>
			<<if $_stop>>
				<<if combatSkillCheck("hand", $_s)>>
					<<combatPerson>> tries to stop you from putting the condom on, <span class="green">but you manage to do it anyways.</span>
					<<equipPlayerCondom>>
				<<else>>
					<<combatPerson>> <span class="red">stops you from putting the condom on.</span>
				<</if>>
			<<elseif $parasite.penis.name>>
				<span class="lewd">You can't the condom on over the parasite.</span>
			<<else>>
				<<if !$player.condom>>
					You roll the condom over your penis.
					<<equipPlayerCondom>>
				<</if>>
			<</if>>
		<</if>>

		<<if $leftaction is "penisremovecondom" or $rightaction is "penisremovecondom">>
			<<if $leftaction is "penisremovecondom">>
				<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			<</if>>
			<<if $rightaction is "penisremovecondom">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			<</if>>
			<<set _foundnpc to $NPCList.filter(npc => npc.pregnancyAvoidance >= 80).random()>>
			<<if _foundnpc>>
				<<personselect _foundnpc.index>>
				<<set $_stop to true>>
			<</if>>
			<<if $_stop>>
				<<if combatSkillCheck("hand", $_s)>>
					<<combatPerson>> tries to stop you from removing your condom, <span class="green">but you manage to do it anyways.</span>
					<<removePlayerCondom>>
				<<else>>
					<<combatPerson>> <span class="red">stops you from removing your condom.</span>
				<</if>>
			<<else>>
				<<if $player.condom>>
					You quickly remove the condom from your penis.
					<<removePlayerCondom>>
				<</if>>
			<</if>>
		<</if>>

		<<if $leftaction is "npcremovecondom" or $rightaction is "npcremovecondom">>
			<<if $leftaction is "npcremovecondom" and $rightaction is "npcremovecondom">>
				<<set $leftaction to 0>><<set $leftactiondefault to "rest">><<set $rightaction to 0>><<set $rightactiondefault to "rest">>
				<<if $lefttarget is $righttarget>>
					<<set $_target to $lefttarget>><<handskilluse>><<brat 2 $_target>>
				<<else>>
					<<set $_target to $lefttarget>><<set $_target2 to $righttarget>><<handskilluse>><<brat 1 $_target>><<brat 1 $_target2>>
				<</if>>
			<<elseif $leftaction is "npcremovecondom">>
				<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
				<<set $_target to $lefttarget>><<handskilluse>><<brat 1 $_target>>
			<<elseif $rightaction is "npcremovecondom">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
				<<set $_target to $righttarget>><<handskilluse>><<brat 1 $_target>>
			<</if>>
			<<if $consensual is 0 and playerPregnancyPossibleWith($NPCList[$_target])>><<combatpromiscuity6>><</if>>
			<<personselect $_target>>
			<<set $_npc to $NPCList[$_target]>>
			<<if $_npc.pregnancyAvoidance gte 80>>
				<<if combatSkillCheck("hand", $_target)>>
					<<combatPerson>> tries to stop you from removing <<his>> condom, <span class="green">but you manage to do it anyways.</span>
					<<removeNPCCondom $_target>>
				<<else>>
					<<combatPerson>> <span class="red">stops you from removing <<his>> condom.</span>
				<</if>>
			<<else>>
				You stealthily remove the condom from <<combatpersons>> penis.
				<<removeNPCCondom $_target>>
			<</if>>
			<<if $_target2>>
				<<personselect $_target2>>
				<<set $_npc to $NPCList[$_target2]>>
				<<if $_npc.pregnancyAvoidance gte 80>>
					<<if combatSkillCheck("hand", $_target2)>>
						<<combatPerson>> tries to stop you from removing <<his>> condom, <span class="green">but you manage to do it anyways.</span>
						<<removeNPCCondom $_target2>>
					<<else>>
						<<combatPerson>> <span class="red">stops you from removing <<his>> condom.</span>
					<</if>>
				<<else>>
					You stealthily remove the condom from <<combatpersons>> penis.
					<<removeNPCCondom $_target2>>
				<</if>>
			<</if>>
		<</if>>

		<<if $leftaction is "npcgivecondom">>
			<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			<<set $_target to $lefttarget>><<meek 1 $_target>>
			<<personselect $_target>>
			<<set $_npc to $NPCList[$_target]>>
			<<if $NPCList[$_target].condomCanGive>>
				You give <<combatperson>> one of your condoms to use.
				<<giveNPCCondom $_target>>
			<</if>>
		<</if>>

		<<if $rightaction is "npcgivecondom">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			<<set $_target to $righttarget>><<meek 1 $_target>>
			<<personselect $_target>>
			<<set $_npc to $NPCList[$_target]>>
			<<if $NPCList[$_target].condomCanGive>>
				You give <<combatperson>> one of your condoms to use.
				<<giveNPCCondom $_target>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftmasturbatepussy">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftmasturbatepussy">>
			<<if $vaginause is 0 and !playerChastity("vagina")>>
				<<combatpromiscuity2>>
				<<set $_genitals_exposed to $worn.over_lower.vagina_exposed gte 1 and ($worn.lower.vagina_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.vagina_exposed gte 1>>

				<<if $_genitals_exposed>>
					<<if $arousal gt ($arousalmax/5)*4>>
						You run your fingers over your exposed <<pussy>> and shiver in anticipation.
					<<else>>
						You run your fingers over your exposed <<pussy>>.
					<</if>>
					<<addVaginalWetness 2>><<arousal 40 "masturbationVagina">><<submission 2>>
				<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
					You run your fingers over your <<pussy>>, feeling its shape beneath your $worn.lower.name.
					<<addVaginalWetness 1>><<arousal 20 "masturbationVagina">>
				<<elseif $worn.under_lower.vagina_exposed is 0>>
					You run your fingers over your <<pussy>>, feeling its shape beneath your $worn.under_lower.name.
					<<addVaginalWetness 1>><<arousal 20 "masturbationVagina">>
				<<elseif $worn.genitals.vagina_exposed is 0>>
					You run your fingers over your <<pussy>>, feeling its shape beneath your $worn.genitals.name.
					<<addVaginalWetness 1>><<arousal 20 "masturbationVagina">>
				<<else>>
					You run your fingers over your <<pussy>><<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
					<<addVaginalWetness 0>><<arousal 5 "masturbationVagina">>
				<</if>>
				<<submission 3>><<set $speechmasturbate to 1>>
			<</if>>
		<</if>>

		<<if $rightaction is "rightmasturbatepussy">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightmasturbatepussy">>
			<<if $vaginause is 0 and !playerChastity("vagina")>>
				<<combatpromiscuity2>>
				<<set $_genitals_exposed to $worn.over_lower.vagina_exposed gte 1 and ($worn.lower.vagina_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.vagina_exposed gte 1>>

				<<if $_genitals_exposed>>
					<<if $arousal gt ($arousalmax/5)*4>>
						You run your fingers over your exposed <<pussy>> and shiver in anticipation.
					<<else>>
						You run your fingers over your exposed <<pussy>>.
					<</if>>
					<<addVaginalWetness 2>><<arousal 40 "masturbationVagina">><<submission 2>>
				<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
					You run your fingers over your <<pussy>>, feeling its shape beneath your $worn.lower.name.
					<<addVaginalWetness 1>><<arousal 20 "masturbationVagina">>
				<<elseif $worn.under_lower.vagina_exposed is 0>>
					You run your fingers over your <<pussy>>, feeling its shape beneath your $worn.under_lower.name.
					<<addVaginalWetness 1>><<arousal 20 "masturbationVagina">>
				<<elseif $worn.genitals.vagina_exposed is 0>>
					You run your fingers over your <<pussy>>, feeling its shape beneath your $worn.genitals.name.
					<<addVaginalWetness 1>><<arousal 20 "masturbationVagina">>
				<<else>>
					You run your fingers over your <<pussy>><<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
					<<addVaginalWetness 0>><<arousal 5 "masturbationVagina">>
				<</if>>
				<<submission 3>><<set $speechmasturbate to 1>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftmasturbatepenis">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftmasturbatepenis">>
			<<if $penisuse is 0 and !playerChastity("penis")>>
				<<combatpromiscuity2>>
				<<set $_genitals_exposed to $worn.over_lower.vagina_exposed gte 1 and ($worn.lower.vagina_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.vagina_exposed gte 1>>

				<<if $_genitals_exposed>>
					<<if $arousal gt ($arousalmax/5)*4>>
						You stroke your exposed <<penis>> and shiver in anticipation.
					<<else>>
						You stroke your exposed <<penis>>.
					<</if>>
					<<arousal 40 "masturbationPenis">><<submission 2>>
				<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
					You stroke your <<penis>>, feeling its shape beneath your $worn.lower.name.
					<<arousal 20 "masturbationPenis">>
				<<elseif $worn.under_lower.vagina_exposed is 0>>
					You stroke your <<penis>>, feeling its shape beneath your $worn.under_lower.name.
					<<arousal 20 "masturbationPenis">>
				<<elseif $worn.genitals.vagina_exposed is 0>>
					You stroke your <<penis>>, feeling its shape beneath your $worn.genitals.name.
					<<arousal 20 "masturbationPenis">>
				<<else>>
					You stroke your <<penis>>, feeling its shape beneath your clothing.
					<<arousal 5 "masturbationPenis">>
				<</if>>
				<<submission 3>><<set $speechmasturbate to 1>>
			<</if>>
		<</if>>

		<<if $rightaction is "rightmasturbatepenis">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightmasturbatepenis">>
			<<if $penisuse is 0 and !playerChastity("penis")>>
				<<combatpromiscuity2>>
				<<set $_genitals_exposed to $worn.over_lower.vagina_exposed gte 1 and ($worn.lower.vagina_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.vagina_exposed gte 1>>

				<<if $_genitals_exposed>>
					<<if $arousal gt ($arousalmax/5)*4>>
						You stroke your exposed <<penis>> and shiver in anticipation.
					<<else>>
						You stroke your exposed <<penis>>.
					<</if>>
					<<arousal 40 "masturbationPenis">><<submission 2>>
				<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
					You stroke your <<penis>>, feeling its shape beneath your $worn.lower.name.
					<<arousal 20 "masturbationPenis">>
				<<elseif $worn.under_lower.vagina_exposed is 0>>
					You stroke your <<penis>>, feeling its shape beneath your $worn.under_lower.name.
					<<arousal 20 "masturbationPenis">>
				<<elseif $worn.genitals.vagina_exposed is 0>>
					You stroke your <<penis>>, feeling its shape beneath your $worn.genitals.name.
					<<arousal 20 "masturbationPenis">>
				<<else>>
					You stroke your <<penis>>, feeling its shape beneath your clothing.
					<<arousal 5 "masturbationPenis">>
				<</if>>
				<<submission 3>><<set $speechmasturbate to 1>>
			<</if>>
		<</if>>

		<<if $leftaction is "leftmasturbateanus">>
			<<set $leftaction to 0>><<set $leftactiondefault to "leftmasturbateanus">>
			<<if $anususe is 0 and !playerChastity("anus")>>
				<<combatpromiscuity3>>
				<<set $_genitals_exposed to $worn.over_lower.vagina_exposed gte 1 and ($worn.lower.vagina_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.vagina_exposed gte 1>>

				<<if $_genitals_exposed>>
					<<if playerHasButtPlug()>>
						<<if $arousal gt ($arousalmax/5)*4>>
							You pull your $worn.butt_plug.name in and out of exposed anus and shiver in anticipation.
						<<else>>
							You pull your $worn.butt_plug.name in and out of your exposed anus.
						<</if>>
					<<else>>
						<<if $arousal gt ($arousalmax/5)*4>>
							You run your fingers in and out of exposed anus and shiver in anticipation.
						<<else>>
							You run your fingers in and out of your exposed anus.
						<</if>>
					<</if>>
					<<arousal 40 "masturbationAnal">><<submission 2>>
				<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
					<<if playerHasButtPlug()>>
						You run your fingers over your $worn.butt_plug.name, feeling its shape beneath your $worn.lower.name.
					<<else>>
						You run your fingers over your anus, feeling its shape beneath your $worn.lower.name.
					<</if>>
					<<arousal 20 "masturbationAnal">>
				<<elseif $worn.under_lower.vagina_exposed is 0>>
					<<if playerHasButtPlug()>>
						You run your fingers over your $worn.butt_plug.name, feeling its shape beneath your $worn.under_lower.name.
					<<else>>
						You run your fingers over your anus, feeling its shape beneath your $worn.under_lower.name.
					<</if>>
					<<arousal 20 "masturbationAnal">>
				<<elseif $worn.genitals.vagina_exposed is 0>>
					<<if playerHasButtPlug()>>
						You run your fingers over your $worn.butt_plug.name, feeling its shape beneath your $worn.genitals.name.
					<<else>>
						You run your fingers over your anus, feeling its shape beneath your $worn.genitals.name.
					<</if>>
					<<arousal 20 "masturbationAnal">>
				<<else>>
					<<if playerHasButtPlug()>>
						You run your fingers over your $worn.butt_plug.name<<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
					<<else>>
						You run your fingers over your anus<<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
					<</if>>
					<<arousal 5 "masturbationAnal">>
				<</if>>
				<<submission 3>><<set $speechmasturbate to 1>>
			<</if>>
		<</if>>

		<<if $rightaction is "rightmasturbateanus">>
			<<set $rightaction to 0>><<set $rightactiondefault to "rightmasturbateanus">>
			<<if $anususe is 0 and !playerChastity("anus")>>
				<<combatpromiscuity3>>
				<<set $_genitals_exposed to $worn.over_lower.vagina_exposed gte 1 and ($worn.lower.vagina_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.vagina_exposed gte 1>>

				<<if $_genitals_exposed>>
					<<if playerHasButtPlug()>>
						<<if $arousal gt ($arousalmax/5)*4>>
							You pull your $worn.butt_plug.name in and out of exposed anus and shiver in anticipation.
						<<else>>
							You pull your $worn.butt_plug.name in and out of your exposed anus.
						<</if>>
					<<else>>
						<<if $arousal gt ($arousalmax/5)*4>>
							You run your fingers in and out of exposed anus and shiver in anticipation.
						<<else>>
							You run your fingers in and out of your exposed anus.
						<</if>>
					<</if>>
					<<arousal 40 "masturbationAnal">><<submission 2>>
				<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
					<<if playerHasButtPlug()>>
						You run your fingers over your $worn.butt_plug.name, feeling its shape beneath your $worn.lower.name.
					<<else>>
						You run your fingers over your anus, feeling its shape beneath your $worn.lower.name.
					<</if>>
					<<arousal 20 "masturbationAnal">>
				<<elseif $worn.under_lower.vagina_exposed is 0>>
					<<if playerHasButtPlug()>>
						You run your fingers over your $worn.butt_plug.name, feeling its shape beneath your $worn.under_lower.name.
					<<else>>
						You run your fingers over your anus, feeling its shape beneath your $worn.under_lower.name.
					<</if>>
					<<arousal 20 "masturbationAnal">>
				<<elseif $worn.genitals.vagina_exposed is 0>>
					<<if playerHasButtPlug()>>
						You run your fingers over your $worn.butt_plug.name, feeling its shape beneath your $worn.genitals.name.
					<<else>>
						You run your fingers over your anus, feeling its shape beneath your $worn.genitals.name.
					<</if>>
					<<arousal 20 "masturbationAnal">>
				<<else>>
					<<if playerHasButtPlug()>>
						You run your fingers over your $worn.butt_plug.name<<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
					<<else>>
						You run your fingers over your anus<<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
					<</if>>
					<<arousal 5 "masturbationAnal">>
				<</if>>
				<<submission 3>><<set $speechmasturbate to 1>>
			<</if>>
		<</if>>

		<<effectsremovebuttplug>>
		<<effectsPickupSexToy>>
		<<effectsDropSexToy>>

		<<if $leftaction is "lubeanus" or $rightaction is "lubeanus">>
			<<if $leftaction is "lubeanus">>
				<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			<</if>>
			<<if $rightaction is "lubeanus">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			<</if>>
			<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			You squeeze your bottle of lube over your anus.
			<<bodyliquid "bottom" "goo">>
			<<useLube>>
			<<submission 3>>
		<</if>>

		<<if $leftaction is "lubepussy" or $rightaction is "lubepussy">>
			<<if $leftaction is "lubepussy">>
				<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			<</if>>
			<<if $rightaction is "lubepussy">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			<</if>>
			You squeeze your bottle of lube over your pussy.
			<<bodyliquid "vaginaoutside" "goo">>
			<<useLube>>
			<<submission 3>>
		<</if>>

		<<if $leftaction is "lubepenis" or $rightaction is "lubepenis">>
			<<if $leftaction is "lubepenis">>
				<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			<</if>>
			<<if $rightaction is "lubepenis">>
				<<set $rightaction to 0>><<set $rightactiondefault to "rest">>
			<</if>>
			<<set $leftaction to 0>><<set $leftactiondefault to "rest">>
			You squeeze your bottle of lube over your penis.
			<<bodyliquid "penis" "goo">>
			<<useLube>>
			<<submission 3>>
		<</if>>

		/* Combat sex toys */

		<<if $leftaction is "dildoSelfPussyEntrance">>
			<<set $leftaction to 0>><<set $leftactiondefault to "dildoSelfPussyEntrance">><<set $leftarm to "dildoSelfPussyEntrance">><<combatpromiscuity3>>
			<<set $_genitals_exposed to $worn.over_lower.vagina_exposed gte 1 and ($worn.lower.vagina_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.vagina_exposed gte 1 and $worn.genitals.vagina_exposed gte 1>>
			<<set $_dildo to $selectedItemLeft.name>>
			<<if $_genitals_exposed>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You run your $_dildo over your exposed <<pussy>> and shiver in pleasure.
				<<else>>
					You run your $_dildo over your exposed <<pussy>>.
				<</if>>
				<<addVaginalWetness 2>><<arousal 40 "genitals">><<submission 2>>
			<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
				You run your $_dildo over your <<pussy>>, feeling its shape beneath your $worn.lower.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<elseif $worn.under_lower.vagina_exposed is 0>>
				You run your $_dildo over your <<pussy>>, feeling its shape beneath your $worn.under_lower.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<elseif $worn.genitals.vagina_exposed is 0>>
				You run your $_dildo over your <<pussy>>, feeling its shape beneath your $worn.genitals.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<else>>
				You run your $_dildo over your <<pussy>><<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
				<<addVaginalWetness 0>><<arousal 5 "genitals">>
			<</if>>
			<<submission 5>><<set $speechmasturbate to 1>>
		<</if>>

		<<if $rightaction is "dildoSelfPussyEntrance">>
			<<set $rightaction to 0>><<set $rightactiondefault to "dildoSelfPussyEntrance">><<set $rightarm to "dildoSelfPussyEntrance">><<combatpromiscuity3>>
			<<set $_genitals_exposed to $worn.over_lower.vagina_exposed gte 1 and ($worn.lower.vagina_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.vagina_exposed gte 1 and $worn.genitals.vagina_exposed gte 1>>
			<<set $_dildo to $selectedItemRight.name>>
			<<if $_genitals_exposed>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You run your $_dildo over your exposed <<pussy>> and shiver in pleasure.
				<<else>>
					You run your $_dildo over your exposed <<pussy>>.
				<</if>>
				<<addVaginalWetness 2>><<arousal 40 "genitals">><<submission 2>>
			<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
				You run your $_dildo over your <<pussy>>, feeling its shape beneath your $worn.lower.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<elseif $worn.under_lower.vagina_exposed is 0>>
				You run your $_dildo over your <<pussy>>, feeling its shape beneath your $worn.under_lower.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<elseif $worn.genitals.vagina_exposed is 0>>
				You run your $_dildo over your <<pussy>>, feeling its shape beneath your $worn.genitals.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<else>>
				You run your $_dildo over your <<pussy>><<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
				<<addVaginalWetness 0>><<arousal 5 "genitals">>
			<</if>>
			<<submission 5>><<set $speechmasturbate to 1>>
		<</if>>

		<<if $leftaction is "dildoSelfPussy">>
			<<set $leftaction to 0>><<set $leftactiondefault to "dildoSelfPussy">><<set $leftarm to "dildoSelfPussy">>
			<<set $_dildo to $currentSexToyLeft.name>>
			<<if $player.virginity.vaginal is true>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You gently fuck the entrance of your <<pussy>> with the $_dildo and shiver in pleasure.
				<<else>>
					You gently fuck the entrance of your <<pussy>> with the $_dildo.
				<</if>>
			<<else>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You fuck your <<pussy>> with the $_dildo and shiver in pleasure.
				<<else>>
					You fuck your <<pussy>> with the $_dildo.
				<</if>>
			<</if>>
			<<addVaginalWetness 2>><<arousal 50 "genitals">><<submission 10>><<set $speechmasturbate to 1>>
		<</if>>
		<<if $rightaction is "dildoSelfPussy">>
			<<set $rightaction to 0>><<set $rightactiondefault to "dildoSelfPussy">><<set $rightarm to "dildoSelfPussy">>
			<<set $_dildo to $currentSexToyRight.name>>
			<<if $player.virginity.vaginal is true>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You gently fuck the entrance of your <<pussy>> with the $_dildo and shiver in pleasure.
				<<else>>
					You gently fuck the entrance of your <<pussy>> with the $_dildo.
				<</if>>
			<<else>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You fuck your <<pussy>> with the $_dildo and shiver in pleasure.
				<<else>>
					You fuck your <<pussy>> with the $_dildo.
				<</if>>
			<</if>>
			<<addVaginalWetness 2>><<arousal 50 "genitals">><<submission 10>><<set $speechmasturbate to 1>>
		<</if>>

		<<if $leftaction is "dildoSelfAnusEntrance">>
			<<set $leftaction to 0>><<set $leftactiondefault to "dildoSelfAnusEntrance">><<set $leftarm to "dildoSelfAnusEntrance">><<combatpromiscuity3>>
			<<set $_anus_exposed to $worn.over_lower.anus_exposed gte 1 and ($worn.lower.anus_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.anus_exposed gte 1 and $worn.genitals.anus_exposed gte 1>>
			<<set $_dildo to $currentSexToyLeft.name>>
			<<if $_anus_exposed>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You run your $_dildo over your exposed anus and shiver in pleasure.
				<<else>>
					You run your $_dildo over your exposed anus.
				<</if>>
				<<addVaginalWetness 2>><<arousal 40 "genitals">><<submission 2>>
			<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
				You run your $_dildo over your anus, feeling its shape beneath your $worn.lower.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<elseif $worn.under_lower.vagina_exposed is 0>>
				You run your $_dildo over your anus, feeling its shape beneath your $worn.under_lower.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<elseif $worn.genitals.vagina_exposed is 0>>
				You run your $_dildo over your anus, feeling its shape beneath your $worn.genitals.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<else>>
				You run your $_dildo over your anus<<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
				<<addVaginalWetness 0>><<arousal 5 "genitals">>
			<</if>>
			<<submission 5>><<set $speechmasturbate to 1>>
		<</if>>

		<<if $rightaction is "dildoSelfAnusEntrance">>
			<<set $rightaction to 0>><<set $rightactiondefault to "dildoSelfAnusEntrance">><<set $rightarm to "dildoSelfAnusEntrance">><<combatpromiscuity3>>
			<<set $_anus_exposed to $worn.over_lower.anus_exposed gte 1 and ($worn.lower.anus_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.anus_exposed gte 1 and $worn.genitals.anus_exposed gte 1>>
			<<set $_dildo to $currentSexToyRight.name>>
			<<if $_anus_exposed>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You run your $_dildo over your exposed anus and shiver in pleasure.
				<<else>>
					You run your $_dildo over your exposed anus.
				<</if>>
				<<addVaginalWetness 2>><<arousal 40 "genitals">><<submission 2>>
			<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
				You run your $_dildo over your anus, feeling its shape beneath your $worn.lower.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<elseif $worn.under_lower.vagina_exposed is 0>>
				You run your $_dildo over your anus, feeling its shape beneath your $worn.under_lower.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<elseif $worn.genitals.vagina_exposed is 0>>
				You run your $_dildo over your anus, feeling its shape beneath your $worn.genitals.name.
				<<addVaginalWetness 1>><<arousal 20 "genitals">>
			<<else>>
				You run your $_dildo over your anus<<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
				<<addVaginalWetness 0>><<arousal 5 "genitals">>
			<</if>>
			<<submission 5>><<set $speechmasturbate to 1>>
		<</if>>

		<<if $leftaction is "dildoSelfAnus">>
			<<set $leftaction to 0>><<set $leftactiondefault to "dildoSelfAnus">><<set $leftarm to "dildoSelfAnus">>
			<<set $_dildo to $currentSexToyLeft.name>>
			<<if $player.virginity.anal is true>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You gently fuck the entrance of your anus with the $_dildo and shiver in pleasure.
				<<else>>
					You gently fuck the entrance of your anus with the $_dildo.
				<</if>>
			<<else>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You fuck your anus with the $_dildo and shiver in pleasure.
				<<else>>
					You fuck your anus with the $_dildo.
				<</if>>
			<</if>>
			<<arousal 50 "anus">><<submission 10>><<set $speechmasturbate to 1>>
		<</if>>
		<<if $rightaction is "dildoSelfAnus">>
			<<set $rightaction to 0>><<set $rightactiondefault to "dildoSelfAnus">><<set $rightarm to "dildoSelfAnus">>
			<<set $_dildo to $currentSexToyRight.name>>
			<<if $player.virginity.anal is true>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You gently fuck the entrance of your anus with the $_dildo and shiver in pleasure.
				<<else>>
					You gently fuck the entrance of your anus with the $_dildo.
				<</if>>
			<<else>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You fuck your anus with the $_dildo and shiver in pleasure.
				<<else>>
					You fuck your anus with the $_dildo.
				<</if>>
			<</if>>
			<<arousal 50 "anus">><<submission 10>><<set $speechmasturbate to 1>>
		<</if>>

		<<if $leftaction is "strokerSelfPenisEntrance">>
			<<set $leftaction to 0>><<set $leftactiondefault to "strokerSelfPenisEntrance">><<set $leftarm to "strokerSelfPenisEntrance">><<combatpromiscuity3>>
			<<set _genitals_exposed to $worn.over_lower.vagina_exposed gte 1 and ($worn.lower.vagina_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.vagina_exposed gte 1 and $worn.genitals.vagina_exposed gte 1>>
			<<set _stroker to $selectedItemLeft.name>>
			<<if _genitals_exposed>>
				You run your _stroker over your exposed <<penis>>.
				<<arousal 40 "genitals">><<submission 2>>
			<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
				You run your _stroker over your <<penis>>, feeling its shape beneath your $worn.lower.name.
				<<arousal 20 "genitals">>
			<<elseif $worn.under_lower.vagina_exposed is 0>>
				You run your _stroker over your <<penis>>, feeling its shape beneath your $worn.under_lower.name.
				<<arousal 20 "genitals">>
			<<elseif $worn.genitals.vagina_exposed is 0>>
				You run your _stroker over your <<penis>>, feeling its shape beneath your $worn.genitals.name.
				<<arousal 20 "genitals">>
			<<else>>
				You run your _stroker over your <<penis>><<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
				<<arousal 5 "genitals">>
			<</if>>
			<<submission 2>><<set $speechmasturbate to 1>>
		<</if>>
		<<if $leftaction is "strokerSelfPenis">>
			<<set $leftaction to 0>><<set $leftactiondefault to "strokerSelfPenis">><<set $leftarm to "strokerSelfPenis">>
			<<set $penisuse to "strokerSelfPenis">><<set $penisstate to "strokerSelfPenis">><<set $penisactiondefault to "strokerSelfPenis">>
			<<set _stroker to $currentSexToyLeft.name>>
			<<if $player.virginity.penile is true>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You gently fuck the glans of your <<penis>> with the _stroker and shiver in pleasure.a
				<<else>>
					You gently fuck the glans of your <<penis>> with the _stroker.
				<</if>>
			<<else>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You fuck your <<penis>> with the _stroker and shiver in pleasure.
				<<else>>
					You fuck your <<penis>> with the _stroker.
				<</if>>
			<</if>>
			<<arousal 50 "genitals">><<submission 5>><<set $speechmasturbate to 1>>
		<</if>>

		<<if $rightaction is "strokerSelfPenisEntrance">>
			<<set $rightaction to 0>><<set $rightactiondefault to "strokerSelfPenisEntrance">><<set $rightarm to "strokerSelfPenisEntrance">><<combatpromiscuity3>>
			<<set _genitals_exposed to $worn.over_lower.vagina_exposed gte 1 and ($worn.lower.vagina_exposed gte 1 or setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt gte 1) and $worn.under_lower.vagina_exposed gte 1 and $worn.genitals.vagina_exposed gte 1>>
			<<set _stroker to $selectedItemRight.name>>
			<<if _genitals_exposed>>
				You run your _stroker over your exposed <<penis>>.
				<<arousal 40 "genitals">><<submission 2>>
			<<elseif $worn.lower.vagina_exposed is 0 and setup.clothes.lower[clothesIndex('lower', $worn.lower)].skirt lt 1>>
				You run your _stroker over your <<penis>>, feeling its shape beneath your $worn.lower.name.
				<<arousal 20 "genitals">>
			<<elseif $worn.under_lower.vagina_exposed is 0>>
				You run your _stroker over your <<penis>>, feeling its shape beneath your $worn.under_lower.name.
				<<arousal 20 "genitals">>
			<<elseif $worn.genitals.vagina_exposed is 0>>
				You run your _stroker over your <<penis>>, feeling its shape beneath your $worn.genitals.name.
				<<arousal 20 "genitals">>
			<<else>>
				You run your _stroker over your <<penis>><<if !$worn.lower.type.includes("naked") and !$worn.under_lower.type.includes("naked")>>, feeling its shape beneath your clothing<</if>>.
				<<arousal 5 "genitals">>
			<</if>>
			<<submission 2>><<set $speechmasturbate to 1>>
		<</if>>
		<<if $rightaction is "strokerSelfPenis">>
			<<set $rightaction to 0>><<set $rightactiondefault to "strokerSelfPenis">><<set $rightarm to "strokerSelfPenis">>
			<<set $penisuse to "strokerSelfPenis">><<set $penisstate to "strokerSelfPenis">><<set $penisactiondefault to "strokerSelfPenis">>
			<<set _stroker to $currentSexToyRight.name>>
			<<if $player.virginity.penile is true>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You gently fuck the glans of your <<penis>> with the _stroker and shiver in pleasure.
				<<else>>
					You gently fuck the glans of your <<penis>> with the _stroker.
				<</if>>
			<<else>>
				<<if $arousal gt ($arousalmax/5)*4>>
					You fuck your <<penis>> with the _stroker and shiver in pleasure.
				<<else>>
					You fuck your <<penis>> with the _stroker.
				<</if>>
			<</if>>
			<<arousal 50 "genitals">><<submission 5>><<set $speechmasturbate to 1>>
		<</if>>

		<<if $leftaction is "strokerDrop">>
			<<set $leftaction to 0>><<set $leftactiondefault to "strokerDrop">>
			<<set $penisuse to 0>><<set $penisstate to 0>><<set $leftarm to 0>>
			<span class="blue">You move your $currentSexToyLeft.name away from your penis.</span>
			<<set $currentSexToyLeft to 0>>
		<</if>>

		<<if $rightaction is "strokerDrop">>
			<<set $rightaction to 0>><<set $rightactiondefault to "strokerDrop">>
			<<set $penisuse to 0>><<set $penisstate to 0>><<set $rightarm to 0>>
			<span class="blue">You move your $currentSexToyRight.name away from your penis.</span>
			<<set $currentSexToyRight to 0>>
		<</if>>

		/* NPC pussy */

		<<if $leftaction is "dildoOtherPussyFuck">>
			/* Note: deliberately does not take virginities */
			<<set $leftaction to 0>><<set $leftactiondefault to "dildoOtherPussyFuck">><<handskilluse>>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<submission 10>><<set $speechdildovagina to 1>><<set $leftarm to "dildoOtherPussyFuck">><<set $NPCList[0].vagina to "leftDildo">>

				You <<handtext>> fuck <<their $lefttarget>> pussy with your $currentSexToyLeft.name in your left hand.

			<<elseif $NPCList[$lefttarget].vagina is "leftDildo">>
				<<set $leftarm to 0>><<set $leftactiondefault to "dildoOtherPussyTease">>
				<<set $NPCList[$lefttarget].vagina to 0>><<personselect $lefttarget>>
				<span class="blue">You try to fuck <<hisselect $lefttarget>> pussy with your $currentSexToyLeft.name, but <<he>>
				<<if $enemytype isnot "beast">>slaps your hand away<<else>>shifts way from you and growls<</if>>.</span>
			<</if>>
		<</if>>

		<<if $rightaction is "dildoOtherPussyFuck">>
			/* Note: deliberately does not take virginities */
			<<set $rightaction to 0>><<set $rightactiondefault to "dildoOtherPussyFuck">><<handskilluse>>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<submission 10>><<set $speechdildovagina to 1>><<set $rightarm to "dildoOtherPussyFuck">><<set $NPCList[0].vagina to "rightDildo">>

				You <<handtext>> fuck <<their $righttarget>> pussy with your $currentSexToyRight.name in your right hand.

			<<elseif $NPCList[$righttarget].vagina is "rightDildo">>
				<<set $rightarm to 0>><<set $rightactiondefault to "dildoOtherPussyTease">>
				<<set $NPCList[$righttarget].vagina to 0>><<personselect $righttarget>>
				<span class="blue">You try to fuck <<hisselect $righttarget>> pussy with your $currentSexToyRight.name, but <<he>>
				<<if $enemytype isnot "beast">>slaps your hand away<<else>>shifts way from you and growls<</if>>.</span>
			<</if>>
		<</if>>

		<<if $leftaction is "othervaginadildostop" and $NPCList[$lefttarget].vagina is "leftdildo">>
			<<set $leftaction to 0>><<set $leftactiondefault to "othervaginadildostop">>
			<<set $NPCList[$lefttarget].vagina to 0>><<set $leftarm to 0>>
			<span class="blue">You move your $currentSexToyLeft.name away from <<hisselect $lefttarget>> pussy.</span>
		<</if>>

		<<if $rightaction is "othervaginadildostop" and $NPCList[$righttarget].vagina is "rightdildo">>
			<<set $rightaction to 0>><<set $rightactiondefault to "othervaginadildostop">>
			<<set $NPCList[$righttarget].vagina to 0>><<set $rightarm to 0>>
			<span class="blue">You move your $currentSexToyRight away from <<hisselect $righttarget>> pussy.</span>
		<</if>>

		<<if $leftaction is "dildoOtherPussyTease">>
			<<set $leftaction to 0>><<handskilluse>><<set $leftactiondefault to "dildoOtherPussyTease">><<combatpromiscuity3>>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<submission 1>><<sextoystat>>
				<<if $NPCList[$lefttarget].vagina is 0>>
					<<set $leftactiondefault to "dildoOtherPussyFuck">><<set $leftarm to "dildoOtherPussyTease">><<personselect $lefttarget>>
					<span class="lblue">You <<handtext>> tease <<hisselect $lefttarget>> pussy<<if $NPCList[$lefttarget].chastity.vagina.includes("chastity")>> through <<his>> $NPCList[$lefttarget].chastity.vagina<</if>> with the $currentSexToyLeft.name in your left hand.</span>
				<<else>>
					<span class="blue">You try to tease <<hisselect $lefttarget>> pussy with the $currentSexToyLeft.name in your left hand, but the entrance is already occupied.</span>
				<</if>>
			<<else>>
				You try to tease <<hisselect $lefttarget>> pussy with the $currentSexToyLeft.name in your left hand, but <<he>> moves it away.
			<</if>>
		<</if>>

		<<if $rightaction is "dildoOtherPussyTease">>
			<<set $rightaction to 0>><<handskilluse>><<set $rightactiondefault to "dildoOtherPussyTease">><<combatpromiscuity3>>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<submission 1>><<sextoystat>>
				<<if $NPCList[$righttarget].vagina is 0>>
					<<set $rightactiondefault to "dildoOtherPussyFuck">><<set $rightarm to "dildoOtherPussyTease">><<personselect $righttarget>>
					<span class="lblue">You <<handtext>> tease <<hisselect $righttarget>> pussy<<if $NPCList[$righttarget].chastity.vagina.includes("chastity")>> through <<his>> $NPCList[$righttarget].chastity.vagina<</if>> with your right hand.</span>
				<<else>>
					<span class="blue">You try to tease <<hisselect $righttarget>> pussy with the $currentSexToyRight.name in your right hand, but the entrance is already occupied.</span>
				<</if>>
			<<else>>
				You try to tease <<hisselect $righttarget>> pussy with the $currentSexToyRight.name in your right hand, but <<he>> moves it away.
			<</if>>
		<</if>>

		/* NPC Anus */

		<<if $leftaction is "dildoOtherAnusFuck">>
			/* Note: deliberately does not take virginities */
			<<set $leftaction to 0>><<set $leftactiondefault to "dildoOtherAnusFuck">><<handskilluse>>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<submission 10>><<set $speechdildoanus to 1>><<set $leftarm to "dildoOtherAnusFuck">>
				<<if $NPCList[$lefttarget].vagina isnot "none">>
					<<set $NPCList[$lefttarget].vagina to "leftDildoAnus">>
				<</if>>
				<<if $NPCList[$lefttarget].penis isnot "none">>
					<<set $NPCList[$lefttarget].penis to "leftDildoAnus">>
				<</if>>
				You <<handtext>> fuck <<their $lefttarget>> ass with your $currentSexToyLeft.name in your left hand.

			<<elseif $NPCList[$lefttarget].vagina is "leftDildoAnus">>
				<<set $leftarm to 0>><<set $leftactiondefault to "dildoOtherPussyTease">>
				<<set $NPCList[$lefttarget].vagina to 0>><<personselect $lefttarget>>
				<span class="blue">You try to fuck <<hisselect $lefttarget>> ass with your $currentSexToyLeft.name, but <<he>>
				<<if $enemytype isnot "beast">>slaps your hand away<<else>>shifts way from you and growls<</if>>.</span>

			<<elseif $NPCList[$lefttarget].penis is "leftDildoAnus">>
				<<set $leftarm to 0>><<set $leftactiondefault to "dildoOtherPussyTease">>
				<<set $NPCList[$lefttarget].penis to 0>><<personselect $lefttarget>>
				<span class="blue">You try to fuck <<hisselect $lefttarget>> ass with your $currentSexToyLeft.name, but <<he>>
				<<if $enemytype isnot "beast">>slaps your hand away<<else>>shifts way from you and growls<</if>>.</span>
			<</if>>
		<</if>>

		<<if $rightaction is "dildoOtherAnusFuck">>
			/* Note: deliberately does not take virginities */
			<<set $rightaction to 0>><<set $rightactiondefault to "dildoOtherAnusFuck">><<handskilluse>>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<submission 10>><<set $speechdildoanus to 1>><<set $rightarm to "dildoOtherAnusFuck">>
				<<if $NPCList[$righttarget].vagina isnot "none">>
					<<set $NPCList[$righttarget].vagina to "rightDildoAnus">>
				<</if>>
				<<if $NPCList[$righttarget].penis isnot "none">>
					<<set $NPCList[$righttarget].penis to "rightDildoAnus">>
				<</if>>

				You <<handtext>> fuck <<their $righttarget>> ass with your $currentSexToyRight.name in your right hand.

			<<elseif $NPCList[$righttarget].vagina is "rightDildoAnus">>
				<<set $rightarm to 0>><<set $rightactiondefault to "dildoOtherPussyTease">>
				<<set $NPCList[$righttarget].vagina to 0>><<personselect $righttarget>>
				<span class="blue">You try to fuck <<hisselect $righttarget>> ass with your $currentSexToyRight.name, but <<he>>
				<<if $enemytype isnot "beast">>slaps your hand away<<else>>shifts way from you and growls<</if>>.</span>

			<<elseif $NPCList[$righttarget].penis is "leftDildoAnus">>
				<<set $rightarm to 0>><<set $rightactiondefault to "dildoOtherPussyTease">>
				<<set $NPCList[$righttarget].penis to 0>><<personselect $righttarget>>
				<span class="blue">You try to fuck <<hisselect $righttarget>> ass with your $currentSexToyRight.name, but <<he>>
				<<if $enemytype isnot "beast">>slaps your hand away<<else>>shifts way from you and growls<</if>>.</span>
			<</if>>
		<</if>>

		<<if $leftaction is "dildoAnusDrop" and $NPCList[$lefttarget].vagina is "leftdildoAnus">>
			<<set $leftaction to 0>><<set $leftactiondefault to "dildoAnusDrop">>
			<<set $NPCList[$lefttarget].vagina to 0>><<set $leftarm to 0>>
			<span class="blue">You move your $currentSexToyLeft.name away from <<hisselect $lefttarget>> ass.</span>
		<</if>>

		<<if $rightaction is "dildoAnusDrop" and $NPCList[$righttarget].vagina is "rightdildoAnus">>
			<<set $rightaction to 0>><<set $rightactiondefault to "dildoAnusDrop">>
			<<set $NPCList[$righttarget].vagina to 0>><<set $rightarm to 0>>
			<span class="blue">You move your $currentSexToyRight away from <<hisselect $righttarget>> ass.</span>
		<</if>>

		<<if $leftaction is "dildoAnusDrop" and $NPCList[$lefttarget].penis is "leftdildoAnus">>
			<<set $leftaction to 0>><<set $leftactiondefault to "dildoAnusDrop">>
			<<set $NPCList[$lefttarget].penis to 0>><<set $leftarm to 0>>
			<span class="blue">You move your $currentSexToyLeft.name away from <<hisselect $lefttarget>> ass.</span>
		<</if>>

		<<if $rightaction is "dildoAnusDrop" and $NPCList[$righttarget].penis is "rightdildoAnus">>
			<<set $rightaction to 0>><<set $rightactiondefault to "dildoAnusDrop">>
			<<set $NPCList[$righttarget].penis to 0>><<set $rightarm to 0>>
			<span class="blue">You move your $currentSexToyRight away from <<hisselect $righttarget>> ass.</span>
		<</if>>

		<<if $leftaction is "dildoOtherAnusTease">>
			<<set $leftaction to 0>><<handskilluse>><<set $leftactiondefault to "dildoOtherAnusTease">><<combatpromiscuity3>>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<submission 1>><<sextoystat>>
				<<if $NPCList[$lefttarget].vagina is 0>>
					<<set $leftactiondefault to "dildoOtherAnusFuck">><<set $NPCList[$lefttarget].vagina to "leftDildoAnus">><<set $leftarm to "dildoOtherAnusFuck">><<personselect $lefttarget>>
					<span class="lblue">You <<handtext>> tease <<hisselect $lefttarget>> ass<<if $NPCList[$lefttarget].chastity.vagina.includes("chastity")>> through <<his>> $NPCList[$lefttarget].chastity.vagina<</if>> with the $currentSexToyLeft.name in your left hand.</span>
				<<elseif $NPCList[$lefttarget].penis is 0>>
					<<set $leftactiondefault to "dildoOtherAnusFuck">><<set $NPCList[$lefttarget].penis to "leftDildoAnus">><<set $leftarm to "dildoOtherAnusFuck">><<personselect $lefttarget>>
					<span class="lblue">You <<handtext>> tease <<hisselect $lefttarget>> ass<<if $NPCList[$lefttarget].chastity.penis.includes("chastity")>> through <<his>> $NPCList[$lefttarget].chastity.penis<</if>> with the $currentSexToyLeft.name in your left hand.</span>
				<<else>>
					<span class="blue">You try to tease <<hisselect $lefttarget>> ass with the $currentSexToyLeft.name in your left hand, but the entrance is already occupied.</span>
				<</if>>
			<<else>>
				You try to tease <<hisselect $lefttarget>> ass with the $currentSexToyLeft.name in your left hand, but <<he>> moves it away.
			<</if>>
		<</if>>

		<<if $rightaction is "dildoOtherAnusTease">>
			<<set $rightaction to 0>><<handskilluse>><<set $rightactiondefault to "dildoOtherAnusTease">><<combatpromiscuity3>>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<submission 1>><<sextoystat>>
				<<if $NPCList[$righttarget].vagina is 0>>
					<<set $rightactiondefault to "dildoOtherAnusFuck">><<set $NPCList[$righttarget].vagina to "rightDildoAnus">><<set $rightarm to "dildoOtherAnusFuck">><<personselect $righttarget>>
					<span class="lblue">You <<handtext>> tease <<hisselect $righttarget>> ass<<if $NPCList[$righttarget].chastity.vagina.includes("chastity")>> through <<his>> $NPCList[$righttarget].chastity.vagina<</if>> with your right hand.</span>
				<<elseif $NPCList[$righttarget].penis is 0>>
					<<set $rightactiondefault to "dildoOtherAnusFuck">><<set $NPCList[$righttarget].penis to "rightDildoAnus">><<set $rightarm to "dildoOtherAnusFuck">><<personselect $righttarget>>
					<span class="lblue">You <<handtext>> tease <<hisselect $righttarget>> ass<<if $NPCList[$righttarget].chastity.penis.includes("chastity")>> through <<his>> $NPCList[$righttarget].chastity.penis<</if>> with your right hand.</span>
				<<else>>
					<span class="blue">You try to tease <<hisselect $righttarget>> ass with the $currentSexToyRight.name in your right hand, but the entrance is already occupied.</span>
				<</if>>
			<<else>>
				You try to tease <<hisselect $righttarget>> ass with the $currentSexToyRight.name in your right hand, but <<he>> moves it away.
			<</if>>
		<</if>>

		/* NPC Penis stroker */

		<<if $leftaction is "strokerOtherPenisTease">>
			<<set $leftaction to 0>><<handskilluse>><<set $leftactiondefault to "strokerOtherPenisTease">><<combatpromiscuity3>>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<submission 1>><<sextoystat>>
				<<if $NPCList[$lefttarget].penis is 0>>
					<<set $leftactiondefault to "strokerOtherPenisTease">><<set $NPCList[$lefttarget].penis to "leftStroker">><<set $leftarm to "strokerOtherPenisFuck">><<personselect $lefttarget>>
					<span class="lblue">You <<handtext>> tease <<hisselect $lefttarget>> <<npcPenis $lefttarget>><<if $NPCList[$lefttarget].chastity.penis.includes("chastity")>> through <<his>> $NPCList[$lefttarget].chastity.penis<</if>> with the $currentSexToyLeft.name in your left hand.</span>
				<<else>>
					<span class="blue">You try to tease <<hisselect $lefttarget>> <<npcPenis $lefttarget>> with the $currentSexToyLeft.name in your left hand, but the entrance is already occupied.</span>
				<</if>>
			<<else>>
				You try to tease <<hisselect $lefttarget>> <<npcPenis $lefttarget>> with the $currentSexToyLeft.name in your left hand, but <<he>> moves it away.
			<</if>>
		<</if>>

		<<if $rightaction is "strokerOtherPenisTease">>
			<<set $rightaction to 0>><<handskilluse>><<set $rightactiondefault to "strokerOtherPenisTease">><<combatpromiscuity3>>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<submission 1>><<sextoystat>>
				<<if $NPCList[$righttarget].penis is 0>>
					<<set $rightactiondefault to "strokerOtherPenisTease">><<set $NPCList[$righttarget].penis to "rightstroker">><<set $rightarm to "strokerOtherPenisFuck">><<personselect $righttarget>>
					<span class="lblue">You <<handtext>> tease <<hisselect $righttarget>> <<npcPenis $righttarget>><<if $NPCList[$righttarget].chastity.penis.includes("chastity")>> through <<his>> $NPCList[$righttarget].chastity.penis<</if>> with the $currentSexToyRight.name in your right hand.</span>
				<<else>>
					<span class="blue">You try to tease <<hisselect $righttarget>> <<npcPenis $righttarget>> with the $currentSexToyRight.name in your right hand, but the entrance is already occupied.</span>
				<</if>>
			<<else>>
				You try to tease <<hisselect $righttarget>> <<npcPenis $righttarget>> with the $currentSexToyRight.name in your right hand, but <<he>> moves it away.
			<</if>>
		<</if>>


		<<if $leftaction is "strokerOtherPenisFuck">>
			/* Note: deliberately does not take virginities */
			<<set $leftaction to 0>><<set $leftactiondefault to "strokerOtherPenisFuck">><<handskilluse>>
			<<if combatSkillCheck("hand", $lefttarget)>>
				<<submission 10>><<set $speechstroker to 1>><<set $leftarm to "strokerOtherPenisFuck">><<set $NPCList[$lefttarget].penis to "leftStroker">>

				You <<handtext>> fuck <<their $lefttarget>> <<npcPenis $lefttarget>> with the $currentSexToyLeft.name in your left hand.

			<<elseif $NPCList[$lefttarget].penis is "leftStroker">>
				<<set $leftarm to 0>><<set $leftactiondefault to "strokerOtherPenisTease">>
				<<set $NPCList[$lefttarget].penis to 0>><<personselect $lefttarget>>
				<span class="blue">You try to fuck <<hisselect $lefttarget>> <<npcPenis $lefttarget>> with your $currentSexToyLeft.name, but <<he>>
				<<if $enemytype isnot "beast">>slaps your hand away<<else>>shifts way from you and growls<</if>>.</span>
			<</if>>
		<</if>>

		<<if $rightaction is "strokerOtherPenisFuck">>
			/* Note: deliberately does not take virginities */
			<<set $rightaction to 0>><<set $rightactiondefault to "strokerOtherPenisFuck">><<handskilluse>>
			<<if combatSkillCheck("hand", $righttarget)>>
				<<submission 10>><<set $speechstroker to 1>><<set $rightarm to "strokerOtherPenisFuck">><<set $NPCList[$righttarget].penis to "rightstroker">>

				You <<handtext>> fuck <<their $righttarget>> <<npcPenis $righttarget>> with the $currentSexToyRight.name in your right hand.

			<<elseif $NPCList[$righttarget].penis is "rightstroker">>
				<<set $rightarm to 0>><<set $rightactiondefault to "strokerOtherPenisTease">>
				<<set $NPCList[$righttarget].penis to 0>><<personselect $righttarget>>
				<span class="blue">You try to fuck <<hisselect $righttarget>> <<npcPenis 0>> with your $currentSexToyRight.name, but <<he>>
				<<if $enemytype isnot "beast">>slaps your hand away<<else>>shifts way from you and growls<</if>>.</span>
			<</if>>
		<</if>>


		/*Stalked actions */
		<<if !$stalk_end>>
			<<if $leftaction is "clench" and $rightaction is "clench">>
				<<if $earSlime.growth gt 50 and $earSlime.growth - random(0, Math.clamp(300 - ($earSlime.defyCooldown * 20), 0, 300)) gte (currentSkillValue('willpower')/ 10) and $exhibitionism gte 15>>
					<<if ($player.penisExist or playerHasStrapon()) and (!$player.vaginaExist or $worn.genitals.name is "chastity parasite" or random(0,100) gte 50)>>
						<<set _slimeTarget to playerHasStrapon() ? "strap-on" : (playerChastity("penis") ? $worn.genitals.name : "penis")>>
						<<set _slimeWidget to "penis">>
					<<elseif $player.vaginaExist>>
						<<set _slimeTarget to "vagina">>
						<<set _slimeWidget to "vagina">>
					<<else>>
						<<set _slimeTarget to "butt">>
						<<set _slimeWidget to "anus">>
					<</if>>
					You try to clench your fists, <span class="red">but you suddenly find them moving towards your _slimeTarget.</span> You feel the slime steal your control away.
					<<switch _slimeWidget>>
						<<case "penis">><<effectsCoverPenis "both" "lewd">>
						<<case "vagina">><<effectsCoverVagina "both" "lewd">>
						<<case "anus">><<effectsCoverAnus "both" "lewd">>
					<</switch>>
				<<else>>
					<<set $leftactiondefault to "clench">><<set $leftaction to 0>><<set $rightactiondefault to "clench">><<set $rightaction to 0>><<brat 6>>
					You clench your fists.
				<</if>>
			<<elseif $leftaction is "clench">>
				<<if $earSlime.growth gt 50 and $earSlime.growth - random(0, Math.clamp(300 - ($earSlime.defyCooldown * 20), 0, 300)) gte (currentSkillValue('willpower')/ 10) and $exhibitionism gte 15>>
					<<if ($player.penisExist or playerHasStrapon()) and (!$player.vaginaExist or $worn.genitals.name is "chastity parasite" or random(0,100) gte 50)>>
						<<set _slimeTarget to playerHasStrapon() ? "strap-on" : (playerChastity("penis") ? $worn.genitals.name : "penis")>>
						<<set _slimeWidget to "penis">>
					<<elseif $player.vaginaExist>>
						<<set _slimeTarget to "vagina">>
						<<set _slimeWidget to "vagina">>
					<<else>>
						<<set _slimeTarget to "butt">>
						<<set _slimeWidget to "anus">>
					<</if>>
					You try to clench your fists, <span class="red">but you suddenly find them moving towards your _slimeTarget.</span> You feel the slime steal your control away.
					<<switch _slimeWidget>>
						<<case "penis">><<effectsCoverPenis "left" "lewd">>
						<<case "vagina">><<effectsCoverVagina "left" "lewd">>
						<<case "anus">><<effectsCoverAnus "left" "lewd">>
					<</switch>>
				<<else>>
					<<set $leftactiondefault to "clench">><<set $leftaction to 0>><<brat 3>>
					You clench your left fist.
				<</if>>
			<<elseif $rightaction is "clench">>
				<<if $earSlime.growth gt 50 and $earSlime.growth - random(0, Math.clamp(300 - ($earSlime.defyCooldown * 20), 0, 300)) gte (currentSkillValue('willpower')/ 10) and $exhibitionism gte 15>>
					<<if ($player.penisExist or playerHasStrapon()) and (!$player.vaginaExist or $worn.genitals.name is "chastity parasite" or random(0,100) gte 50)>>
						<<set _slimeTarget to playerHasStrapon() ? "strap-on" : (playerChastity("penis") ? $worn.genitals.name : "penis")>>
						<<set _slimeWidget to "penis">>
					<<elseif $player.vaginaExist>>
						<<set _slimeTarget to "vagina">>
						<<set _slimeWidget to "vagina">>
					<<else>>
						<<set _slimeTarget to "butt">>
						<<set _slimeWidget to "anus">>
					<</if>>
					You try to clench your fists, <span class="red">but you suddenly find them moving towards your _slimeTarget.</span> You feel the slime steal your control away.
					<<switch _slimeWidget>>
						<<case "penis">><<effectsCoverPenis "right" "lewd">>
						<<case "vagina">><<effectsCoverVagina "right" "lewd">>
						<<case "anus">><<effectsCoverAnus "right" "lewd">>
					<</switch>>
				<<else>>
					<<set $rightactiondefault to "clench">><<set $rightaction to 0>><<brat 3>>
					You clench your right fist.
				<</if>>
			<</if>>

			<<if $leftaction is "fold" and $rightaction is "fold">>
				<<set $leftaction to 0>><<set $rightaction to 0>><<set $leftactiondefault to "fold">><<set $rightactiondefault to "fold">>
				<<if $player.breastsize gte 3>>
					You fold your arms beneath your <<breasts>>.
				<<else>>
					You fold your arms in front of you.
				<</if>>
				<<meek 6>>
			<</if>>

			<<if $leftaction is "fold">>
				<<set $leftaction to 0>><<set $leftactiondefault to "fold">>
				<<if $player.breastsize gte 3>>
					You fold your left arm beneath your <<breasts>>.
				<<else>>
					You fold your left arm in front of you.
				<</if>>
				<<meek 3>>
			<</if>>

			<<if $rightaction is "fold">>
				<<set $rightaction to 0>><<set $rightactiondefault to "fold">>
				<<if $player.breastsize gte 3>>
					You fold your right arm beneath your <<breasts>>.
				<<else>>
					You fold your right arm in front of you.
				<</if>>
				<<meek 3>>
			<</if>>

			<<if $leftaction is "pursuit_grab" and $rightaction is "pursuit_grab">>
				<<set $leftaction to 0>><<set $leftactiondefault to "pursuit_grab">><<set $rightaction to 0>><<set $rightactiondefault to "pursuit_grab">>
				<<set $feetaction to "rest">>
				<<set $feetuse to 0>>
				You grasp the back of the <<persons>> shirt with both hands, <span class="green">and force <<him>> to stop.</span> <<He>> turns to face you.
				<<stalk_catch>>
			<</if>>

			<<if $leftaction is "pursuit_grab">>
				<<set $leftaction to 0>><<set $leftactiondefault to "pursuit_grab">>
				<<set $feetaction to "rest">>
				<<set $feetuse to 0>>
				You grasp the back of the <<persons>> shirt with your left hand, <span class="green">and force <<him>> to stop.</span> <<He>> turns to face you.
				<<stalk_catch>>
			<</if>>

			<<if $rightaction is "pursuit_grab">>
				<<set $rightaction to 0>><<set $rightactiondefault to "pursuit_grab">>
				<<set $feetaction to "rest">>
				<<set $feetuse to 0>>
				You grasp the back of the <<persons>> shirt with your right hand, <span class="green">and force <<him>> to stop.</span> <<He>> turns to face you.
				<<stalk_catch>>
			<</if>>
		<</if>>

		/*End of stalked actions */

		/***
		*    ███████ ███████ ███████ ███████
		*    ██      ██      ██        ███
		*    ███████ ███████ ███████   ███
		*    ██      ██      ██        ███
		*    ██      ███████ ███████   ███
		*
		*/
		<<if $newtarget isnot undefined>>
			<<setnewtarget>>
		<</if>>

		<<if $feetaction is "grab">>
			<<set $feetaction to 0>><<set $feetactiondefault to "grab">><<combatpromiscuity3>>
			<<if combatSkillCheck("feet", $feettarget)>>
				<<submission 2>>
				<<if $NPCList[$feettarget].penis is 0>>
					<<set $feetactiondefault to "grabrub">><<set $NPCList[$feettarget].penis to "feet">><<set $feetuse to "penis">><<feetstat>><<feetskilluse>>
					<span class="lblue">You <<feettext>> <<if $NPCList[$feettarget].chastity.penis.includes("chastity")>>rub your foot on <<hisselect $feettarget>> $NPCList[$feettarget].penisdesc through <<hisselect $feettarget>> $NPCList[$feettarget].chastity.penis<<else>>grab <<hisselect $feettarget>> $NPCList[$feettarget].penisdesc between your feet<</if>>.</span>
				<<else>>
					<span class="blue">You try to grab <<hisselect $feettarget>> $NPCList[$feettarget].penisdesc with your feet, but the phallus is already occupied.</span>
				<</if>>
			<<else>>
				You clumsily try to grab <<hisselect $feettarget>> penis between your feet, but fail.
				<<feetskilluse>><<submission 2>>
			<</if>>
		<</if>>

		<<if $feetaction is "rest">>
			<<set $feetaction to 0>><<set $feetactiondefault to "rest">>You rest your legs.
		<</if>>

		/* 北极星模组 */
		<<if $feetaction is "pleaseagain">>
			<<set $feetaction to 0>><<set $feetactiondefault to "rest">>
			<<ejaculation>>
			<span class='lewd'>"再来一次嘛~"你摆出一个诱人的姿势: "人家还想要~"</span>
			<br>
			<<set $seductiondifficulty to (10000 - $enemyarousalmax * 10)>>
			<<seductionskilluse>>
			<<seductioncheck>>
			<br>
			<<if $enemyarousalmax gt 0 and $seductionrating gte $seductionrequired>>
				<span class='green'>你的诱惑成功让对方再次提起了性致。</span>
				<br>
				<<set $againfail to false>>
				<<if !$options.bjx_endlessagain>>
				    <<set $enemyarousalmax -= 200>>
				<</if>>
				<<set $enemyarousal to 0>>
				<<submission 10>>
			<<else>>
				<span class='red'>任你百般诱惑，对方却再无法提起干劲了。</span>
				<br>
				<<set $againfail to true>>
				<<set $finish to 1>>
				<<set $enemyarousalmax to 0>>
			<</if>>
		<</if>>

		<<if $feetaction is "forceagain">>
			<<set $feetaction to 0>><<set $feetactiondefault to "rest">>
			<<ejaculation>>
			<span class='lewd'>"还不够，还不够。"你用双腿牢牢地锁住对方: "满足我，别想逃！"</span>
			<br>
			<<physiquedifficulty `$enemyhealth * 50 - $enemyarousalmax * 10` `$enemyhealth * 50 - $enemyarousalmax * 10`>>
			<br>
			<<if $enemyarousalmax gt 0 and $physiqueSuccess>>
				<span class='green'>尽管不太情愿，对方还是在你的动作下有了感觉。</span>
				<br>
				<<set $againfail to false>>
				<<if !$options.bjx_endlessagain>>
				    <<set $enemyarousalmax -= 200>>
				<</if>>
				<<set $enemyarousal to 0>>
				<<set $enemyhealth = $enemyhealthmax>>
				<<brat 10>>
			<<else>>
				<span class='red'>被你的疯狂吓到，对方拼命挣脱了你的掌控逃跑了。</span>
				<br>
				<<set $againfail to true>>
				<<set $finish to 1>>
				<<set $enemyarousalmax to 0>>
			<</if>>
		<</if>>
		/* 北极星 */

		<<if $feetaction is "kick">>
			<<set $feetaction to 0>><<set $feetactiondefault to "kick">>
			<<if $parasite.left_ear.name is "slime" and random(1, 3) is 3 or $parasite.right_ear.name is "slime" and random(1, 3) is 3>>
				<<if $earSlime.corruption gte (currentSkillValue('willpower') / 10)>>
					You try to kick the <<if $enemytype is "beast">><<beasttype>>,<<else>><<personselect $feettarget>><<person>>,<</if>>
					<span class="red">but the slime immobilises your legs.</span>
					<<gwillpower>><<willpower 1>>
				<<else>>
					The slime tries to immobilise your legs, <span class="green">but you wrestle control away from it.</span>
					<<actionskick $feettarget>><<defiance 5 $feettarget>><<set $attackstat += 1>>
					<<if $worn.feet.type.includes("heels")>>
						Your high heels strengthen the blow!
						<<defiance 1 $feettarget>>
					<</if>>
					/* 北极星模组 */
					<<if $transformationParts.traits.kicks isnot "disabled">>
						你有力的双腿加强了打击力度！
						<<defiance 10 $feettarget>>
					<</if>>
					/* 北极星 */
				<</if>>
			<<else>>
				<<actionskick $feettarget>><<defiance 5 $feettarget>><<set $attackstat += 1>>
				<<if $worn.feet.type.includes("heels")>>
					Your high heels strengthen the blow!
					<<defiance 1 $feettarget>>
				<</if>>
				/* 北极星模组 */
				<<if $transformationParts.traits.kicks isnot "disabled">>
					你有力的双腿加强了打击力度！
					<<defiance 10 $feettarget>>
				<</if>>
				/* 北极星 */
			<</if>>
		<</if>>

		<<if $feetaction is "rub">>
			<<set $feetaction to 0>><<submission 1>><<actionsfeetrub $feettarget>>
		<</if>>

		<<rng>>

		<<if $feetaction is "grabrub">>
			<<feetskilluse>><<set $feetactiondefault to "grabrub">><<set $feetaction to 0>>
			<<if combatSkillCheck("feet", $feettarget)>>
				<<actionsgrabrub $feettarget>><<submission 2>>
			<<elseif $NPCList[$feettarget].penis is "feet">>
				<<set $feetactiondefault to "grab">><<personselect $feettarget>>
				<span class="blue">You try to rub <<hisselect $feettarget>> penis between your feet, but <<he>> moves away.</span>
				<<set $feetuse to 0>><<set $NPCList[$feettarget].penis to 0>><<set $NPCList[$feettarget].location.genitals to 0>>
			<</if>>
		<</if>>

		<<rng>>

		<<if $feetaction is "vaginagrab">>
			<<feetskilluse>><<set $feetaction to 0>><<set $feetactiondefault to "vaginagrab">><<combatpromiscuity3>>
			<<if combatSkillCheck("feet", $feettarget)>>
				<<submission 2>>
				<<if $NPCList[$feettarget].vagina is 0>>
					<<set $feetactiondefault to "vaginagrabrub">><<set $feetuse to "othervagina">><<set $NPCList[$feettarget].vagina to "feet">><<feetstat>><span class="lblue">You <<feettext>> press your feet against <<hisselect $feettarget>> pussy<<if $NPCList[$feettarget].chastity.vagina.includes("chastity")>> through <<hisselect $feettarget>> $NPCList[$feettarget].chastity.vagina<</if>>.</span>
				<<else>>
					<span class="blue">You to try press your feet against <<hisselect $feettarget>> pussy, but the entrance is already occupied.</span>
				<</if>>
			<<else>>
				You try to keep <<hisselect $feettarget>> pussy away with your feet, but <<he>> moves it away.
			<</if>>
		<</if>>

		<<rng>>

		<<if $feetaction is "vaginagrabrub">>
			<<set $feetaction to 0>><<feetskilluse>><<set $feetactiondefault to "vaginagrabrub">>
			<<if combatSkillCheck("feet", $feettarget)>>
				<<actionsfeetpussy $feettarget>><<submission 2>>
			<<elseif $NPCList[$feettarget].vagina is "feet">>
				<<set $feetactiondefault to "vaginagrab">><<personselect $feettarget>>
				<span class="blue">You try to keep <<hisselect $feettarget>> pussy away with your feet, but <<he>> moves away.</span>
				<<set $feetuse to 0>><<set $NPCList[$feettarget].vagina to 0>>
			<</if>>
		<</if>>

		<<if $feetaction is "stop">>
			<<set $feetaction to 0>><<set $feetactiondefault to "stop">>
			You move your feet away from <<his>> genitals.
			<<set $feetuse to 0>>
			<<if $NPCList[$feettarget].penis is "feet">>
				<<set $NPCList[$feettarget].penis to 0>>
			<</if>>
			<<if $NPCList[$feettarget].vagina is "feet">>
				<<set $NPCList[$feettarget].vagina to 0>>
			<</if>>
		<</if>>

		<<if $feetaction is "feetshoes">>
			<<set $feetaction to 0>>
			You kick off your $worn.feet.name.
			<<feetstrip>>
		<</if>>

		<<if $feetaction is "feetsocks">>
			<<set $feetaction to 0>>
			<<if $worn.legs.state is "thighs">>
				You peel your $worn.legs.name down your thighs with your toes.
				<<set $worn.legs.state to "ankles">>
			<<elseif $worn.legs.state is "ankles">>
				You kick off your $worn.legs.name.
				<<legsstrip>>
			<</if>>
		<</if>>

		<<if $feetaction is "legLock">>
			<<set $feetaction to 0>><<thighskilluse>><<set $feetactiondefault to "legLock">>
			<<if $consensual is 0>><<combatpromiscuity6>><<else>><<combatpromiscuity3>><</if>>
			<<set $_legLockDif to Math.floor((100 - $NPCList[$feettarget].pregnancyAvoidance) * 15)>>
			<<if combatSkillCheck("thigh", $feettarget, $_legLockDif)>>
				<<brat 2>><<sex 5 "genitals" $feettarget>><<set $feetactiondefault to "legLocked">><<set $feetuse to "legLock">><<set $leglocktarget to $feettarget>>
				<<set $speechleglock to 1>><<personselect $feettarget>>
				<<thighstat>><span class="lblue">You <<thightext>> <<if $position is "missionary">>wrap your legs around<<else>>push back against<</if>> <<combatperson $feettarget>>, preventing <<him>> from pulling out.</span>
			<<else>>
				You try to <<if $position is "missionary">>wrap your legs around<<else>>push back against<</if>> <<combatperson $feettarget>>, but <<he>> pulls your legs away.
			<</if>>
		<</if>>

		<<if $feetaction is "legLocked">>
			<<set $feetaction to 0>><<thighskilluse>><<set $feetactiondefault to "legLocked">>
			<<set $_legLockDif to Math.floor((100 - $NPCList[$feettarget].pregnancyAvoidance) * 10)>>
			<<if combatSkillCheck("thigh", $feettarget, $_legLockDif)>>
				<<brat 2>><<sex 5 "genitals" $feettarget>><<set $speechleglock to 1>><<personselect $feettarget>>
				<span class="lewd">You keep <<if $position is "missionary">>your legs wrapped around<<else>>pushing back against<</if>> <<combatperson $feettarget>>, giving <<him>> no chance to escape.</span>
			<<elseif $orgasmdown gte 1>>
				<<sex 5 "genitals" $feettarget>><<set $speechleglock to 1>><<personselect $feettarget>>
				<span class="lewd">You <<if $position is "missionary">>wrap your legs around<<else>>push back against<</if>> <<combatperson $feettarget>> even harder as you orgasm, preventing <<his>> escape. </span>
			<<else>>
				<<set $feetactiondefault to "legLock">><<set $feetuse to 0>><<unset $leglocktarget>>
				<span class="blue">You try to keep <<if $position is "missionary">>your legs wrapped around<<else>>pushing back against<</if>> <<combatperson $feettarget>>, but <<he>> manages to pry your legs away.</span>
			<</if>>
		<</if>>

		<<if $feetaction is "legRelease">>
			<<set $feetaction to 0>><<set $feetactiondefault to "legRelease">><<personselect $feettarget>>
			You <<if $position is "missionary">>release the leg lock<<else>>stop pushing back<</if>>, allowing <<combatperson $feettarget>> to escape.
			<<set $feetuse to 0>><<unset $leglocktarget>>
		<</if>>

		/*Stalked actions */
		<<if !$stalk_end>>
			<<if $feetaction is "walk">>
				<<if $earSlime.growth gt 50 and $earSlime.growth - random(0, Math.clamp(75 - ($earSlime.defyCooldown * 5), 0, 75)) gte (currentSkillValue('willpower')/ 10) and $exhibitionism gte 15>>
					Your walking, <span class="red">but you suddenly find yourself moving differently.</span> You feel the slime steal your control away.
					<<set $feetaction to "strut">>
				<<else>>
					<<set $feetaction to 0>><<set $feetactiondefault to "walk">>
					<<set $feetuse to "walk">>
					You keep walking,
					<<if $control gte ($controlmax * 0.8)>>
						your feet sure and steady.
					<<elseif $control gte ($controlmax * 0.6)>>
						putting one foot in front of the other.
					<<elseif $control gte ($controlmax * 0.4)>>
						though worried about the gaining footsteps.
					<<elseif $control gte ($controlmax * 0.2)>>
						doing your best to stay calm.
					<<else>>
						suppressing the urge to break into a run.
					<</if>>
					<<stalk_walk_events>>
				<</if>>
			<</if>>

			<<if $feetaction is "strut">>
				<<set $feetaction to 0>><<set $feetactiondefault to "strut">>
				<<set $feetuse to "strut">>
				You strut,
				<<if $control gte ($controlmax * 0.8)>>
					swaying your shoulders and hips.
				<<elseif $control gte ($controlmax * 0.6)>>
					putting one foot in front of the other.
				<<elseif $control gte ($controlmax * 0.4)>>
					though worried about the gaining footsteps.
				<<elseif $control gte ($controlmax * 0.2)>>
					doing your best to stay calm.
				<<else>>
					suppressing the urge to break into a run.
				<</if>>
				<<meek 3>>
				<<stalk_walk_events>>
			<</if>>

			<<if $feetaction is "run">>
				<<set $feetaction to 0>><<set $feetactiondefault to "run">>
				<<if _stalkNoRunning is "chastity parasite">>
					<<set $feetactiondefault to "walk">><<set $feetuse to "walk">>
					<<if $earSlime.growth gte 150>><<set $earSlime.defyCooldown++>><</if>>
					You attempt to run, <span class="lewd">but you find the pleasure your feeling too much to run.</span>
					<<stalk_walk_events>>
				<<elseif $earSlime.growth - random(0, Math.clamp(110 - ($earSlime.defyCooldown * 10), 0, 110)) gte (currentSkillValue('willpower')/ 10)>>
					<<if $earSlime.growth gt 50 and $exhibitionism gte 15>>
						<<set $feetactiondefault to "strut">><<set $feetuse to "strut">>
						You attempt to run, <span class="red">but you suddenly find yourself strutting.</span> You feel the slime steal your control away.
						<<meek 3>>
					<<else>>
						<<set $feetactiondefault to "walk">><<set $feetuse to "walk">>
						You attempt to run, <span class="red">but you find yourself being unable to move any quicker.</span> You feel the slime steal your control away.
					<</if>>
					<<if $daily.stalkWillpower lt 20>>
						<<gwillpower>><<willpower 1>>
						<<set $daily.stalkWillpower to ($daily.stalkWillpower or 0) + 1>>
					<</if>>

					<<stalk_walk_events>>
				<<elseif $NPCList[0].state is "pursuit">>
					<<if $feetuse isnot "run">>
						You break into a run, and chase the thief.
						<<stalk_run>>
					<<else>>
						You chase the thief.
					<</if>>
					<<run_text>>
					<<if $worn.feet.type.includes("heels")>>
						<<if currentSkillValue("feetskill") gte random(1, 1000)>>
							<<set _stalk_feet to true>>
						<<else>>
							<<set _stalk_feet to false>>
						<</if>>
					<<else>>
						<<set _stalk_feet to true>>
					<</if>>
					<<if currentSkillValue('athletics') gte random(1, $NPCList[0].skills.athletics)>>
						<<set _stalk_athletics to true>>
					<<else>>
						<<set _stalk_athletics to false>>
					<</if>>
					<<if _stalk_athletics and _stalk_feet>>
						<span class="teal">You catch up.</span>
						<<set $NPCList[0].distance -= 2>>
					<<else>>
						<span class="red"><<He>> outpaces you.</span>
						<br>
					<</if>>
					<<stalk_run_events>>
				<<else>>
					<<if $feetuse isnot "run">>
						You break into a run.
						<<if $NPCList[0].fullDescription is "Ivory Wraith" or $NPCList[0].bold * 2 gte random(1, 1000)>>
							The footsteps behind you speed up. <span class="red">You are being chased.</span>
							<<stalk_run>>
							<<if $worn.feet.type.includes("heels")>>
								<<if currentSkillValue("feetskill") gte random(1, 1000)>>
									<<set _stalk_feet to true>>
								<</if>>
							<<else>>
								<<set _stalk_feet to true>>
							<</if>>
							<<if currentSkillValue('athletics') gte random(1, $NPCList[0].skills.athletics)>>
								<<set _stalk_athletics to true>>
							<<else>>
								<<set _stalk_athletics to false>>
							<</if>>
							<<if _stalk_athletics and _stalk_feet>>
								<span class="teal">The footsteps fall behind.</span>
								<<set $NPCList[0].distance += 2>>
							<<else>>
								<span class="red">The footsteps get closer.</span>
							<</if>>
						<<else>>
							<span class="teal">No one pursues.</span>
							<<set $stalk_end to "escaped">>
						<</if>>
					<<else>>
						You keep running.
						<<run_text>>
						<<if $worn.feet.type.includes("heels")>>
							<<if currentSkillValue("feetskill") gte random(1, 1000)>>
								<<set _stalk_feet to true>>
							<</if>>
						<<else>>
							<<set _stalk_feet to true>>
						<</if>>
						<<if currentSkillValue('athletics') gte random(1, $NPCList[0].skills.athletics)>>
							<<set _stalk_athletics to true>>
						<<else>>
							<<set _stalk_athletics to false>>
						<</if>>
						<<if _stalk_athletics and _stalk_feet>>
							<span class="teal">The footsteps fall behind.</span>
							<<set $NPCList[0].distance += 2>>
						<<else>>
							<span class="red">The footsteps get closer.</span>
						<</if>>
					<</if>>
					<<if $NPCList[0].distance gte 5>>
						<span class="green">You leave them far behind,</span> and escape to safety.
						<<set $stalk_end to "escaped">>
					<<else>>
						<<stalk_run_events>>
					<</if>>
				<</if>>
			<</if>>

			<<if $feetaction is "stand">>
				<<set $feetaction to 0>><<set $feetactiondefault to "stand">>
				<<if $control gte ($controlmax * 0.8)>>
					You stand still, your feet firm.
				<<elseif $control gte ($controlmax * 0.6)>>
					You stand still, and take a deep breath.
				<<elseif $control gte ($controlmax * 0.4)>>
					Despite your nerves, you stand still.
				<<elseif $control gte ($controlmax * 0.2)>>
					You stand still, despite your fear.
				<<else>>
					Shaking with fear, you stand still.
				<</if>>
				<<set $NPCList[0].distance to 0>>
			<</if>>

			<<if $feetaction is "hobble">>
				<<set $feetaction to 0>><<set $feetactiondefault to "hobble">>
				<<if $leftleg is "bound" or $rightleg is "bound">>
					You hobble as fast as your bound legs will allow,
				<<else>>
					You hobble as fast as your inexperience with high heels will allow,
				<</if>>
				<<if $control gte ($controlmax * 0.8)>>
					your feet steady despite your predicament.
				<<elseif $control gte ($controlmax * 0.6)>>
					careful not to trip.
				<<elseif $control gte ($controlmax * 0.4)>>
					suppressing the growing fear of the footsteps behind you.
				<<elseif $control gte ($controlmax * 0.2)>>
					struggling to stay calm.
				<<else>>
					suppressing the urge to cower in terror.
				<</if>>
			<</if>>

			<<if $feetaction is "hide">>
				<<set $feetaction to 0>><<set $feetactiondefault to "hide">>
				<<set _difficulty to $NPCList[0].skills.security>>
				<<set _difficulty += $liquidcount * 20>>
				<<if currentSkillValue('skulduggery') gte random(1, _difficulty)>>
					<<set _hide_success to true>>
				<</if>>
				<<if $earSlime.growth - random(0, Math.clamp(75 - ($earSlime.defyCooldown * 5), 0, 75)) gte (currentSkillValue('willpower')/ 10)>>
					<<if $earSlime.growth gte 150>><<set $earSlime.defyCooldown++>><</if>>
					<<if $earSlime.growth gt 50 and $exhibitionism gte 15>>
						<<set $feetactiondefault to "strut">><<set $feetuse to "strut">>
						You attempt to hide, <span class="red">but you suddenly find yourself strutting.</span> You feel the slime steal your control away.
						<<meek 3>>
					<<else>>
						<<set $feetactiondefault to "walk">><<set $feetuse to "walk">>
						You attempt to hide, <span class="red">but you find yourself being unable to move any quicker.</span> You feel the slime steal your control away.
					<</if>>
					<<if $daily.stalkWillpower lt 20>>
						<<gwillpower>><<willpower 1>>
						<<set $daily.stalkWillpower to ($daily.stalkWillpower or 0) + 1>>
					<</if>>

					<<stalk_walk_events>>
				<<elseif _hide_success and $NPCList[0].state is "pursuit">>
					<<switch $location>>
						<<case forest lake>>
							You hide behind a tree, and hope that no one's watching.
						<<case moor>>
							You crouch behind a small ridge, and hope that no one's watching.
						<<default>>
							You dive down a small alley, and take cover behind a dumpster.
					<</switch>>
					<<set $stalk_end to "hide">>
				<<elseif !_hide_success and ($NPCList[0].fullDescription isnot "Ivory Wraith" and ($NPCList[0].legs is "run" or $NPCList[0].bold gte random(1, 1000))
				or $NPCList[0].fullDescription is "Ivory Wraith" and C.npc["Ivory Wraith"].lust gte random(5,15))>>
					<<switch $location>>
						<<case alley>>
							You dive down a thin alley, and take cover behind a dumpster. You peek around the corner. You don't see anyone.
						<<case forest lake>>
							You run into a dense copse, and take cover behind a thick trunk. You peek around the side. You don't see anyone.
						<<case moor>>
							You crest a small ridge, and dive into a ditch. You look up, and don't see anyone.
						<<default>>
							You dive down a thin alley, and take cover behind a dumpster. You peek around the side. You don't see anyone.
					<</switch>>
					<span class="red">Then you feel a presence.</span>

					/* Prevents stalking mouth actions from appearing once the encounter starts */
					<<set $mouthaction to 0>><<set $mouthactiondefault to "rest">>

					<<if $npcrow.includes(0)>>
						<<stalk_nnpc_text_attack $NPCList[0].fullDescription>>
						<<if !$stalk_assess>>
							<<if $NPCList[0].fullDescription is "Ivory Wraith">>
								<span class="red">A<<if $wraith.seen gte 3>> familiar<</if>> pale figure stares down at you, eyes flashing <<wraithEyes>>.</span>
							<<else>>
								<span class="pink">It's <<print $npc[$npcrow.indexOf(0)]>>.</span>
							<</if>>
						<</if>>
						<br><br>
						<<events_stalk_nnpc $NPCList[0].fullDescription>>
					<<else>>
						<br><br>
						<<events_stalk>>
					<</if>>
				<<else>>
					<<switch $location>>
						<<case alley>>
							You dive down a thin alley, and take cover behind a dumpster.
							<<if $NPCList[0].fullDescription isnot "Ivory Wraith">>
								<span class="green"><<if $enemyno gt 1>>They pass<<else>>The <<person>> passes<</if>> without looking your way.</span>
							<</if>>
						<<case forest lake>>
							You run into a dense copse, and take cover behind a thick trunk. You peek around the edge.
							<<if $NPCList[0].fullDescription isnot "Ivory Wraith">>
								<span class="green"><<if $enemyno gt 1>>They pass<<else>>The <<person>> passes<</if>> by without looking your way.</span>
							<</if>>
						<<case moor>>
							You crest a small ridge, and dive into a ditch.
							<<if $NPCList[0].fullDescription isnot "Ivory Wraith">>
								The <<if $enemyno gt 1>><<person1>><</if>><<person>> pauses at the top, <span class="green">then moves on without looking your way.</span>
							<</if>>
						<<default>>
							You dive down a thin alley, and take cover behind a dumpster. You peek around the side.
							<<if $NPCList[0].fullDescription isnot "Ivory Wraith">>
								<span class="green"><<if $enemyno gt 1>>They pass<<else>>The <<person>> passes<</if>> without looking your way.</span>
							<</if>>
					<</switch>>
					<<if $NPCList[0].fullDescription is "Ivory Wraith">>
						<<set $stalk_assess to true>>
						The pale figure cackles and <span class="teal">dissipates into a thick, cool mist</span>. Its voice echoes around you.
						<<switch random(1, 3)>>
							<<case 3>><<set _wraith_output to "You can only hide from yourself for so long.">>
							<<case 2>><<set _wraith_output to "As the sun rests below the horizon.">>
							<<case 1>><<set _wraith_output to "Before they lose their shine.">>
						<</switch>>
						"<span class="wraith"><<print _wraith_output>></span>"
						<<trauma 2>><<stress 4>><<gtrauma>><<gstress>>
					<</if>>
					<<set $stalk_end to "hide">>
				<</if>>
			<</if>>

			<<if $feetaction is "confront">>
				<<famescrap 1>>
				You swivel around, and come face to face with
				<<person1>>
				<<if $npcrow.includes(0)>>
					<<if $NPCList[0].fullDescription is "Ivory Wraith">>
						<<if $stalk_assess>>
							the pale figure.
						<<else>>
							a<<if $wraith.seen gte 3>> familiar<</if>> pale figure.
						<</if>>
					<<else>>
						<<if $stalk_assess>>
							<<if $enemyno gte 3>>
								<<print $NPCList[0].fullDescription>> and <<his>> companions.
							<<elseif $enemyno is 2>>
								<<print $NPCList[0].fullDescription>> and <<his>> companion.
							<<else>>
								<<print $NPCList[0].fullDescription>>.
							<</if>>
						<<else>>
							<<if $enemyno gte 3>>
								a <<personsimple>> and <<his>> companions.
							<<elseif $enemyno is 2>>
								a <<personsimple>> and <<his>> companion.
							<<else>>
								a <<personsimple>>.
							<</if>>
							<span class="pink">It's <<print $NPCList[0].fullDescription>>.</span>
						<</if>>
					<</if>>
				<<elseif $enemyno gte 3>>
					the <<person>> and <<his>> companions.
				<<elseif $enemyno is 2>>
					the <<person>> and <<his>> companion.
				<<else>>
					the <<person>>.
				<</if>>
				<<set $stalk_assess to true>>
				<<if $npcrow.includes(0)>>
					<<actionsconfrontNNPC>>
				<<else>>
					<<actionsconfront>>
				<</if>>
				<br><br>
				<<if $combatgoal is "confront">>
					<<if $NPCList[0].fullDescription is "Ivory Wraith">>
						<<set $stalk_assess to true>>
						You blink. When you open your eyes, <span class="red">the pale figure is inches from your face.</span>
					<<else>>
						<span class="purple"><<He>> comes to a stop in front of you.</span>
					<</if>>
					<br><br>
					<<set $stalk_end to "confront">>
				<<elseif $NPCList[0].fullDescription isnot "Ivory Wraith" and $NPCList[0].bold * 2 gte random(1, 1000)
				or $NPCList[0].fullDescription is "Ivory Wraith" and C.npc["Ivory Wraith"].lust gte random(1,10)>>
					<<if $NPCList[0].fullDescription is "Ivory Wraith">>
						You blink. When you open your eyes, <span class="red">the pale figure is inches from your face.</span>
					<<else>>
						<span class="red"><<He>> marches towards you.</span>
					<</if>>

					/* Prevents stalking mouth actions from appearing once the encounter starts */
					<<set $mouthaction to 0>><<set $mouthactiondefault to "rest">>

					<<if $npcrow.includes(0)>>
						<<stalk_nnpc_text_attack $NPCList[0].fullDescription>>
					<<else>>
						<<if $NPCList[0].traits.includes("relaxed")>>
							"Best play along," <<he>> says. "It'll be easier for you."
						<<elseif $NPCList[0].traits.includes("sociable")>>
							"That's no way to talk to a <<if $pronoun is "m">>gentleman<<else>>lady<</if>> like me," <<he>> says. "I know how you can make it up to me."
						<<elseif $NPCList[0].traits.includes("brooding")>>
							"This is the way of the world," <<he>> says. "It'll be over soon."
						<<else>>
							"You're such a hot piece," <<he>> says. "You're gonna get jumped sooner or later. I might as well benefit."
						<</if>>
					<</if>>
					<br><br>
					<<stalk_attack>>
				<<else>>
					<<if $npcrow.includes(0)>>
						<<stalk_nnpc_text_threat $NPCList[0].fullDescription>>
					<<else>>
						<span class="green"><<He>> throws up <<his>> hands.</span>
						<<if $NPCList[0].traits.includes("relaxed")>>
							"Easy <<girl>>," <<he>> says, giving you a wide berth. "I didn't mean to frighten you."
						<<elseif $NPCList[0].traits.includes("sociable")>>
							"Damn <<girl>>," <<he>> says. "Am I that ugly?" <<He>> gives you a wide berth.
						<<elseif $NPCList[0].traits.includes("brooding")>>
							The <<person>> laughs. "The streets that rough for you?" <<he>> asks. "I'll give you space."
						<<else>>
							"I was only looking!" <<he>> says. "Wasn't gonna try anything, honest." <<He>> gives you a wide berth.
						<</if>>
						<br><br>

						<<He>> walks ahead. You feel a little silly.
					<</if>>
					<br><br>
					<<set $stalk_end to "passed">>
					<<set $NPCList[_n].distance to 1>>
				<</if>>
			<</if>>
		<</if>>

		/*End of stalked actions */
		/* 北极星模组 */
		
		/***
		/*████████  ████████  ██████   ██     */ 
		/*   ██     ██    ██    ██     ██     */
        /*   ██     ████████    ██     ██     */
		/*   ██     ██    ██    ██     ██     */
		/* 	 ██     ██    ██  ██████   ███████*/
		/*                                    */
		
		<<if $newtarget isnot undefined>>
			<<setnewtarget>>
		<</if>>
		
		<<if $hastail is "true" and $tailaction is "rest">>
			<<set $tailaction to 0>><<set $tailactiondefault to "rest">>你的尾巴放松下来。
		<</if>>

		<<if $tailaction is "tailshake">>
			<<set $tailaction to 0>><<set $tailactiondefault to "tailshake">>
		    你快速地摇动着尾巴，讨好着对方。
		    <<meek 10>>
		    <<if !$tailshaked and setup.NPCNameList.includes($NPCList[$tailtarget].fullDescription)>>
		        <<npcincr $NPCList[$tailtarget].fullDescription love 2>>
		        <<set $tailshaked to true>>
		        你温顺的样子打动了对方，对方对你的<span class="green">好感提高了。</span>
		    <</if>>
		<</if>>
		<<if $tailaction is "tailspin">>
			<<set $tailaction to 0>><<set $tailactiondefault to "tailspin">>
		    你朝着对方吐出蜘蛛丝线，迅速织成一张蜘蛛网，将对方紧紧包裹住。
		    <<set $cobweb = ($cobweb ? $cobweb + 1 : 1)>>
		    <<if $cobwebuse is undefined>>
				<<set $cobwebuse to 0>>
			<</if>>
			<<set $cobwebuse += 1>>
		<</if>>
		<<if $tailaction is "tailstab">>
			<<set $tailaction to 0>><<set $tailactiondefault to "tailstab">>
			<<if $parasite.left_ear.name is "slime" and random(1, 3) is 3 or $parasite.right_ear.name is "slime" and random(1, 3) is 3>>
				<<if $corruption_slime gte (currentSkillValue('willpower') / 10)>>
					你试着刺中<<if $enemytype is "beast">><<beasttype>>，<<else>><<personselect $feettarget>><<person>>，<</if>>
					<span class="red">但史莱姆让你的尾巴动弹不得。</span>
					<<gwillpower>><<willpower 1>>
				<<else>>
					史莱姆试图固定你的尾巴，<span class="green">但你挣脱了它的控制。</span>
					<<actionsstab $tailtarget>><<defiance 5 $tailtarget>><<set $attackstat += 1>>
			    <<if $options.bjx_animal>>
			        <<set $NPCList[$tailtarget].poison += 3>>
			    <</if>>
				<</if>>
			<<else>>
				<<actionsstab $tailtarget>><<defiance 5 $tailtarget>><<set $attackstat += 1>>
			    <<if $options.bjx_animal>>
			        <<set $NPCList[$tailtarget].poison += 3>>
			    <</if>>
			<</if>>
		<</if>>
		/* 北极星 */

		/***
		*    ██   ██  █████  ██   ██ ███████ ██   ██
		*    ███ ███ ██   ██ ██   ██   ███   ██   ██
		*    ██ █ ██ ██   ██ ██   ██   ███   ███████
		*    ██   ██ ██   ██ ██   ██   ███   ██   ██
		*    ██   ██  █████   █████    ███   ██   ██
		*
		*/
		<<if $newtarget isnot undefined>>
			<<setnewtarget>>
		<</if>>

		<<if $mouthaction is "rest">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "rest">>
		<</if>>

		<<if $mouthaction is "kissskin">>
			<<set $mouthaction to 0>><<actionskiss $mouthtarget>><<submission 3>><<set $mouthactiondefault to "kissskin">>
		<</if>>

		<<if $mouthaction is "kisslips">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "kisslips">><<personselect $mouthtarget>><<combatpromiscuity1>>
			<<if combatSkillCheck("oral", $mouthtarget)>>
				You move your lips close to <<hers>>.
				<<set $mouthuse to "kiss">><<set $mouthstate to "kissentrance">>
				<<set $NPCList[$mouthtarget].mouth to "kissentrance">>
				<<set $NPCList[$mouthtarget].location.head = "head">>
			<<else>>
				You try to move your head closer to <<hers>>, but <<he>> moves away.
			<</if>>
		<</if>>

		/* 北极星模组 */
		<<if $mouthaction is "growl">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "growl">><<set _sound to 1>>
			<<if $options.bjx_animal>>
    			<<if $consensual is 1>>
        			<<if playerRutMinArousal() or playerHeatMinArousal()>>
        				<<set $speechgrowlrut to 1>>
        				你努力咆哮，<span class="pink">但发情的身体使它听起来像是娇嗔。</span>
    				<<else>>
        				<<set $speechgrowlheat to 1>>
        				你假装咆哮,<span class="pink">以此增加此时的情趣。</span>
    				<</if>>
    				<<stress -5 10>>
    				<<trauma `-5`>>
    			<<else>>
    				<<set $speechgrowl to 1>>
    				<<actionsgrowl>>
    				<<brat 10>>
    				<<set $enemyarousal -= 50>>
    		        <<combatcontrol `5`>>
    			<</if>>
    		<<else>>
        		<<if playerAwareTheyAreInHeat()>>
    				<<set $speechgrowlheat to 1>>
    				<<submission 2>>
    				你想咆哮,<span class="pink">但是发情让它听起来像是淫荡的牢骚。</span>
    			<<elseif playerRutMinArousal() or playerHeatMinArousal()>>
    				<<set $speechgrowlrut to 1>>
    				<<submission 2>>
    				你想咆哮，<span class="pink">但是发情使它听起来像是一个下流的抱怨。</span>
    			<<else>>
    				<<set $speechgrowl to 1>>
    				<<actionsgrowl>>
    				<<brat 2>>
    			<</if>>
			<</if>>
		<</if>>
		<<if $mouthaction is "sing">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "sing">><<set _sound to 1>>
    		你轻声歌唱，<span class="green">悦耳的曲调让人感到轻松与宁静。</span>
			<<if $consensual is 1>>
			    <<control `2`>>
    		    <<stress -5 10>>
				<<trauma `-5`>>
    		<<else>>
    		<</if>>
    		<<enemytrustgain `1`>>
    		<<enemyangerloss `15`>>
		<</if>>
		<<if $mouthaction is "coquetry">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "coquetry">><<set _sound to 1>>
    		你眨着水汪汪的眼睛撒娇道: "<span class="pink">好不好嘛，求求你啦～</span>"
    		<<actionsmoan>>
			<<if $consensual is 1>>
    			<<control `2`>>
    			<<stress -5 10>>
    		<<else>>
    		    <<combatcontrol `5`>>
    			<<set $assertive += 1>>
    		<</if>>
    		<<submission `5`>>
    		<<enemytrustgain `5`>>
		<</if>>
		/* 北极星 */

		<<if $mouthaction is "plead">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "plead with <<him>>">>
			<<else>>
				<<set $mouthactiondefault to "plead">>
				<<actionsplead>><<set $speechplead to 1>>
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words, but <<if $enemyno gte 2>>react<<else>>reacts<</if>> to your tone.
				<</if>>
				<<meek `1 + $englishtrait`>>
			<</if>>
		<</if>>

		<<if $mouthaction is "moan">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "say something sexy" 2>><<set $speechmoan to 1>>
			<<else>>
				<<set $mouthactiondefault to "moan">>
				<<actionsmoan>><<set $speechmoan to 1>>
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words, but <<if $enemyno gte 2>>react<<else>>reacts<</if>> to your tone.
				<</if>>
				<<submission `1 + $englishtrait`>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "askchoke" and $askedtochoke isnot 1>>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "ask to choke you" 1>>
			<<else>>
				<<set $askedtochoke to 1>>
				<<set $mouthactiondefault to 0>>
				<<actionschoke>>
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<</if>>
				<<submission `1 + $englishtrait`>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "askrough">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "ask to be rougher" 2>>
			<<else>>
				<<askrough>>
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<</if>>
				<<submission 1>><<set $enemyanger += (10 * $englishtrait)>><<set $speechaskrough to 1>>
			<</if>>
		<</if>>

		<<if $mouthaction is "demand">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "demand something">>
			<<else>>
				<<set $mouthactiondefault to "demand">>
				<<actionsdemand>><<set $speechdemand to 1>>
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words, but <<if $enemyno gte 2>>flinch<<else>>flinches<</if>> at your tone.
				<</if>>
				<<defiance `1 + $englishtrait`>>
			<</if>>
		<</if>>

		<<if $mouthaction is "mock">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "mock <<him>>">>
			<<else>>
				<<set $mouthactiondefault to "mock">>
				<<actionsmock>><<set $speechdemand to 1>>
				<<brat `1 + $englishtrait` $mouthtarget>>
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
				<<elseif $mockaction is $NPCList[$mouthtarget].insecurity>>
					<<if $consensual is 1>>
						<<submission `1 + $englishtrait` $mouthtarget>>
					<<else>>
						<<combatcontrol `1 + $englishtrait`>>
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "mouth">>
			<<set $mouthaction to 0>><<meek 1 $mouthtarget>><<set $mouthactiondefault to "mouth">><<combatpromiscuity4>>
			<<if $penisbitten is 1>>
				<<He>> smacks your head away from <<his>> penis.
				<<violence 5>>
			<<elseif combatSkillCheck("oral", $mouthtarget)>>
				<<set $mouthsubmit to 1>><<oralskilluse>>
				<<if $NPCList[$mouthtarget].penis is 0>>
					<<set $NPCList[$mouthtarget].penis to "mouthentrance">><<set $mouthactiondefault to "lick">><<set $mouthuse to "penis">><<set $mouthstate to "entrance">>
					<span class="lblue">You <<oraltext>> move your mouth to <<hisselect $mouthtarget>> <<npcPenis $mouthtarget>><<if !$npcSub>> and <<he>> waits expectantly<</if>>.</span>
					<<if $enemytype is "beast">><<set $NPCList[$mouthtarget].stance to "topface">><</if>>
					<<set $NPCList[$mouthtarget].location.genitals to "head">>
				<<else>>
					<span class="blue">You try to move your mouth to <<hisselect $mouthtarget>> <<npcPenis $mouthtarget>>, but the phallus is already occupied.</span>
				<</if>>
			<<else>>
				You try to move into a position where your mouth can take <<hisselect $mouthtarget>> penis, but <<he>> has other ideas.
				<<oralskilluse>>
			<</if>>
		<</if>>

		<<if $mouthaction is "swallow" and $NPCList[$mouthtarget].penis.toString().includes("mouth")>>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "swallow">><<combatpromiscuity5>>
			<<set $NPCList[$mouthtarget].penis to "mouth">>
			<span class="pink">You take <<hisselect $mouthtarget>> $NPCList[$mouthtarget].penisdesc into your mouth.</span>
			<<switch $NPCList[$mouthtarget].penissize>>
				<<case 4>>
					<span class="pink"> You struggle to accommodate its girth.</span>
				<<case 1>>
					<span class="pink"> You struggle to keep your mouth on something so small.</span>
			<</switch>>
			<<if $player.virginity.oral isnot true>>
				<<if $NPCList[$mouthtarget].type is "plant">>
					<span class="pink"> It tastes sweet.</span>
				<</if>>
				<<submission 10>><<bruise face>><<oralstat>><<raped>><<set $mouthstate to "penetrated">><<set $speechmouthpenetrated to 1>>
			<<elseif $player.virginity.oral is true>>
				<<if $NPCList[$mouthtarget].type is "plant">>
					<span class="red">It tastes uncomfortably sweet.</span>
				<<else>>
					<span class="red">It tastes strange.</span>
				<</if>>
				<<submission 30>>
				<<takeVirginity $NPCList[$mouthtarget].fullDescription "oral">><<bruise face>><<oralstat>><<violence 1>><<raped>>
				<<set $mouthstate to "penetrated">><<set $speechmouthvirgin to 1>>
			<</if>>
		<</if>>

		<<if $mouthaction is "othervagina">>
			<<set $mouthaction to 0>><<meek 1 $mouthtarget>><<set $mouthactiondefault to "othervagina">><<combatpromiscuity4>>
			<<if $penisbitten is 1>>
				<<He>> smacks your head away from <<his>> pussy.
				<<violence 5>>
			<<elseif combatSkillCheck("oral", $mouthtarget)>>
				<<oralskilluse>>
				<<if $NPCList[$mouthtarget].vagina is 0>>
					<span class="lblue">You <<oraltext>> move your mouth to <<hisselect $mouthtarget>> <<npcVagina $mouthtarget>><<if !$npcSub>> and <<he>> waits expectantly<</if>>.</span>
					<<set $NPCList[$mouthtarget].vagina to "mouth">><<set $mouthstate to "othervagina">><<set $mouthuse to "othervagina">>
					<<if $enemytype is "beast">><<set $NPCList[$mouthtarget].stance to "topface">><</if>><<set $mouthactiondefault to "vaginalick">>
					<<set $NPCList[$mouthtarget].location.genitals to "head">>
				<<else>>
					<span class="blue">You try to move your mouth to <<hisselect $mouthtarget>> <<npcVagina $mouthtarget>>, but the entrance is already occupied.</span>
				<</if>>
			<<else>>
				You try to move into a position where your mouth can eat <<hisselect $mouthtarget>> pussy, but <<he>> has other ideas.
				<<oralskilluse>>
			<</if>>
		<</if>>

		<<if $mouthaction is "breastpull" and $NPCList[$mouthtarget].chest.toString().includes("mouth")>>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "breastpull">><<personselect $mouthtarget>>
			You try to pull your head away from the chest pressing against your face.
			<<oralskilluse>><<brat 1 $mouthtarget>>
			<<set _nectarDifficulty to Math.clamp($drugged, 0, 500) + Math.clamp($nectar_addiction, 0, 500)>>
			<<willpowerdifficulty _nectarDifficulty $willpowermax "silent">>
			<<if $NPCList[$mouthtarget].type is "plant" and !$willpowerSuccess>>
				<span class="red">However, you can't tear yourself from the sweet nectar.</span>
				<<if $mouthstate is "nipple">>
					You desperately suck their $NPCList[$mouthtarget].breastdesc.
				<<else>>
					You push your face back into their $NPCList[$mouthtarget].breastdesc.
				<</if>>
				<<gwillpower>><<willpower 1>>
			<<else>>
				<<if combatSkillCheck("oral", $mouthtarget)>>
					<<set $mouthstate to 0>><<set $mouthuse to 0>>
					<<set $NPCList[$mouthtarget].chest to 0>>
					<<set $NPCList[$mouthtarget].location.head to 0>>
					<span class="green"><<He>> doesn't stop you.</span>
					<<if $NPCList[$mouthtarget].lefthand is "head_breasts" or $NPCList[$mouthtarget].lefthand is "head_nipples">>
						<<set $NPCList[$mouthtarget].lefthand to 0>>
					<</if>>
					<<if $NPCList[$mouthtarget].righthand is "head_breasts" or $NPCList[$mouthtarget].righthand is "head_nipples">>
						<<set $NPCList[$mouthtarget].righthand to 0>>
					<</if>>
				<<else>>
					<<if $consensual is 1>>
						<<set $consensual to 0>><<molested>><<controlloss>>
					<</if>>
					<<violence 1>>
					<<if $mouthstate is "breasts">>
						<span class="red">However, <<he>> refuses to allow it,</span> instead pushing your head back against their chest.
					<<elseif $mouthstate is "nipple">>
						<span class="red">However, <<he>> refuses to allow it,</span> instead pushing your head back against their chest.
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "movetochest">>
			<<set $mouthaction to 0>><<meek 1 $mouthtarget>><<set $mouthactiondefault to "movetochest">><<combatpromiscuity3>>
			<<if $breastbitten is 1>>
				<<He>> smacks your head away from <<his>> chest.
				<<violence 5>>
			<<elseif combatSkillCheck("oral", $mouthtarget)>>
				<<if $NPCList[$mouthtarget].chest is 0>>
					<<set $mouthactiondefault to "breastlick">>
					<span class="lblue">You <<oraltext>> move your mouth to <<hisselect $mouthtarget>> $NPCList[$mouthtarget].breastsdesc.</span>
					<<if $NPCList[$mouthtarget].type is "plant" and $NPCList[$mouthtarget].pronoun is "f" and $breastfeedingdisable is "f">>
						<span class="purple">It carries a sweet scent.</span>
					<<elseif $NPCList[$mouthtarget].lactation is 1 and $breastfeedingdisable is "f">>
						<span class="purple">It carries a scent of milk.</span>
					<</if>>
					<<set $NPCList[$mouthtarget].chest to "mouthentrance">><<set $mouthstate to "breasts">><<set $mouthuse to "breasts">><<set $head to "breasts">><<oralskilluse>>
					<<set $NPCList[$mouthtarget].location.head to "head">>
				<<else>>
					<span class="blue">You try to move your mouth to <<someones $mouthtarget>> chest, but the place is already occupied.</span><<oralskilluse>>
				<</if>>
			<<else>>
				You try to move your mouth to <<someones $mouthtarget>> chest, but <<he>> has other ideas.
				<<oralskilluse>>
			<</if>>
		<</if>>

		<<if $mouthaction is "breastbite" and $NPCList[$mouthtarget].chest is "mouth">>
			<<if $earSlime.growth gt 50 and $earSlime.growth - random(0, Math.clamp(50 - ($earSlime.defyCooldown * 5), 0, 50)) gte (currentSkillValue('willpower')/ 10)>>
				You try to bite down on the nipple, <span class="red">but find your unable to.</span> You feel the slime steal your control away.
				<<set $mouthaction to "breastsuck">>
				<<if $earSlime.growth gte 100>><<set $earSlime.defyCooldown++>><</if>>
			<<else>>
				<<set $mouthaction to 0>><<set $mouthactiondefault to "breastbite">><<personselect $mouthtarget>>
				/* 北极星模组 */
				<<if $options.bjx_animal and $spider gte 6>>
			    	<<set $NPCList[$mouthtarget].poison += 3>>
				<</if>>
				你咬住那乳头<<if $slime is 1 and $options.bjx_eventTF>><span class='green'>并开始吞噬它</span><</if>>，<<he>><<if $enemytype is "man">>惨叫<<elseif $enemytype is "beast">>低吼<<else>>尖叫<</if>>着后退，痛苦地缩了回去。
				/* 北极星 */
				<<defiance 20 $mouthtarget>><<attackstat>><<set $mouthuse to 0>><<set $breastbitten to 1>><<set $mouthstate to 0>>
				<<if $transformationParts.traits.fangs isnot "disabled">>
					<<defiance 40 $mouthtarget>>
					You lick your fangs clean.
				<</if>>
				<<if $head is "breasts">>
					<<set $head to 0>>
				<</if>>
				<<set $NPCList[$mouthtarget].chest to 0>>
				<<set $NPCList[$mouthtarget].location.head to 0>>
				<<if $NPCList[$mouthtarget].lefthand is "head_nipples">>
					<<set $NPCList[$mouthtarget].lefthand to 0>>
				<</if>>
				<<if $NPCList[$mouthtarget].righthand is "head_nipples">>
					<<set $NPCList[$mouthtarget].righthand to 0>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "breastlick" and $NPCList[$mouthtarget].chest is "mouthentrance">>
			<<set $mouthactiondefault to "breastlick">><<set $mouthaction to 0>><<submission 3>>
			You lick <<hisselect $mouthtarget>> $NPCList[$mouthtarget].breastsdesc.
			/* 北极星模组 */
			<<if $options.bjx_animal and $transformationParts.traits.longtongue isnot "disabled">>
        		<span class='lewd'>你敏感的长舌带给其更加强烈的感觉。</span>
        	<</if>>
        	/* 北极星 */
		<</if>>

		<<if $mouthaction is "breastclosed" and $NPCList[$mouthtarget].chest.toString().includes("mouth")>>
			<<set $mouthactiondefault to "breastclosed">><<set $mouthaction to 0>><<brat 3 $mouthtarget>>
			You keep your mouth closed.
			<<if $NPCList[$mouthtarget].type is "plant" and $NPCList[$mouthtarget].pronoun is "f" and $breastfeedingdisable is "f">>
				<span class="pink">Nectar leaks from <<hisselect $mouthtarget>> $NPCList[$mouthtarget].breastdesc.</span>
			<<elseif $NPCList[$mouthtarget].lactation is 1 and $breastfeedingdisable is "f">>
				<span class="pink">Milk leaks from <<hisselect $mouthtarget>> $NPCList[$mouthtarget].breastdesc.</span>
			<</if>>
		<</if>>

		<<if $mouthaction is "breastsuck" and $NPCList[$mouthtarget].chest.toString().includes("mouth")>>
			<<set $mouthactiondefault to "breastsuck">><<set $mouthaction to 0>><<submission 3>>
			<<set $mouthstate to "nipple">>
			<<set $NPCList[$mouthtarget].chest to "mouth">>
			You <<oraltext>> suck <<hisselect $mouthtarget>> $NPCList[$mouthtarget].breastdesc.
			<<if $NPCList[$mouthtarget].lefthand is "head_breasts">><<set $NPCList[$mouthtarget].lefthand to "head_nipples">><</if>>
			<<if $NPCList[$mouthtarget].righthand is "head_breasts">><<set $NPCList[$mouthtarget].righthand to "head_nipples">><</if>>
			<<if $breastfeedingdisable is "f" and $NPCList[$mouthtarget].type is "plant" and $NPCList[$mouthtarget].pronoun is "f">>
				<span class="purple">Sweet nectar fills your mouth.</span>
				<<nectarfed 15>><<set $speechheadsuckle to 1>><<submission 2>>
			<<elseif $breastfeedingdisable is "f" and $NPCList[$mouthtarget].lactation is 1>>
				<span class="purple">Sweet, creamy milk fills your mouth.</span>
				<<breastfed>><<set $speechheadsuckle to 1>><<submission 2>>
			<<else>>
				<<set $speechheadnipple to 1>>
			<</if>>
		<</if>>

		<<if $mouthaction is "scream">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "scream for help">>
			<<elseif $drugged gt 0 or $arousal gte $arousalmax * 0.9>>
				You try to scream for help, <span class="pink">but your arousal makes it sound like a lewd moan.</span>
				<<neutral 1>><<set $speechmoan to 1>>
			<<elseif $uncomfortable.hypnosis is false and $hypnosis_traits.scream gte random(1,5)>>
				<<hypnosisicon>> You intend to scream for help, but a lewd thought intrudes <span class="lewd">and your mind immediately accepts it.</span>
				<<hypnotised 1>>
				<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
				<<askrough>>
				<<submission 1>><<set $enemyanger += (10 * $englishtrait)>>
				<<hypnosisicon>>
			<<elseif $hypnosis_traits.scream gte 1 and $willpower lt random(1, (200 * $hypnosis_traits.scream))>>
				<<hypnosisicon>> You intend to scream for help, <span class="pink">but the thought is snatched from your mind, and replaced with another.</span>
				<<hypnotised 1>><<willpower 1>>
				<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
				<<askrough>>
				<<submission 1>><<set $enemyanger += (10 * $englishtrait)>>
				<<hypnosisicon>>
			<<elseif ($parasite.left_ear.name is "slime" or $parasite.right_ear.name is "slime") and $earSlime.corruption gte (currentSkillValue('willpower')/ 10)>>
				You open your mouth to scream for help, <span class="red">but your voice catches in your throat.</span> You feel the slime steal your breath away.
				<<gwillpower>><<willpower 1>>
			<<else>>
				<<if $hypnosis_traits.scream gte 1>>
					<span class="green">You resist intrusive thoughts,</span> and scream for help.
				<<else>>
					You scream for help.
				<</if>>
				<<if isLoveInterest("Eden") and $location is "forest" and !($npc.includes("Eden")) and (!$undergroundbrothel or !$undergroundbrothel.active)>>
					<<if $rng lte 50>>
						"Eden! Get them off of me!"
					<<else>>
						"Eden! Help!"
					<</if>>
				<</if>>
				<<brat 10>><<set $alarm to 1>><<set $mouthactiondefault to "scream">><<set $speechscream to 1>>
				<<if $NPCList[0].lefthand is 0 and $mouthuse is 0 and $position isnot "wall" and !$robinRentEvent>>
					<<set $NPCList[0].lefthand to "mouth">><<person1>><<He>> clasps <<his>> hand over your mouth to silence you.
					<<set $enemytrust -= 40>><<set $mouthuse to "lefthand">>
				<<elseif $NPCList[0].righthand is 0 and $mouthuse is 0 and $position isnot "wall" and !$robinRentEvent>>
					<<set $NPCList[0].righthand to "mouth">><<person1>><<He>> clasps <<his>> hand over your mouth to silence you.
					<<set $enemytrust -= 40>><<set $mouthuse to "righthand">>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "apologise">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "apologise">>
			<<elseif $enemytype is "beast">>
				You tell <<him>> you're sorry for being bad.
				<<set $mouthactiondefault to "plead">>
				<<if $apologised is 0>>
					<<if $monster is 1>>
						<<bHe>> growls. "Good. Now stay still."
					<<else>>
						While it doesn't understand you, your tone of voice has an impact.
					<</if>>
					<<set $apologised to 1>><<set $speechapologise to 1>>
					<<set $enemyanger -= 50 * (1 + $englishtrait)>>
				<<else>>
					<<bHe>> ignores you.
					<<set $speechapologiseno to 1>>
				<</if>>
			<<else>>
				<<if $robinmist>>
					You shout. "I'm sorry I wasn't there for you!"
					<<set $speechapologiseno to 1>>
				<<elseif $robinRentEvent is 1 and $combatPhase is "Robin">>
					You tell <<him>> you're sorry for not paying <<him>>.
					<<set $speechapologiseno to 1>>
				<<elseif $npc.includes("Ivory Wraith") and $wraithPrison and $wraithPrison.vision and !$wraithApologiseCooldown>>
					<<if $wraith.state is "haunt">>
						You tell <<him>> you're sorry for taking everything from <<him>>.
					<<else>>
						You tell <<him>> you're sorry for everything that's happened to <<him>>.
					<</if>>
					<<set $mouthactiondefault to "plead">>
					<<if $apologised is 0>>
						<<set $apologised to 1>><<set $speechapologise to 1>><<set $wraithApologise to true>><<set $wraithApologiseCooldown to true>>
						<<set $enemyanger -= 100 * (1 + $englishtrait)>>
					<<else>>
						<<He>> angrily claws at <<his>> neck.
						<<set $speechapologiseno to 1>>
					<</if>>
				<<else>>
					You tell <<him>> you're sorry for being bad.
					<<set $mouthactiondefault to "plead">>
					<<if $apologised is 0>>
						<<His>> face softens.
						<<set $apologised to 1>><<set $speechapologise to 1>>
						<<set $enemyanger -= 50 * (1 + $englishtrait)>>
					<<else>>
						<<He>> ignores you.
						<<set $speechapologiseno to 1>>
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "forgive">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze>>
			<<else>>
				<<set $mouthactiondefault to "plead">>
				<<set $trauma -= $traumagain>><<set $traumagain to 0>><<set $speechforgive to 1>><<set $angelforgive to 1>>
				<<traumaclamp>>
				<<if $enemytype is "beast">>
					"You don't know any better. You're just a <<beasttype>>," you say. "I forgive you."
				<<else>>
					"Even though you're doing such a horrible thing, don't worry," you say. "I forgive you."
				<</if>>
			<</if>>
		<</if>>
		
		/* 北极星模组 */
		<<if $mouthaction is "hypnosis">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze>>
			<<else>>
				<<set $mouthactiondefault to "rest">>
				<<set $demonhunterhypnosis to 1>>
				<<if $enemytype is "beast">>
					"乖乖<<beasttype>>，不准射射哦！"
				<<else>>
					"没有我的允许，你不许高潮哦！"
				<</if>>
			<</if>>
		<</if>>
		
		<<if $mouthaction is "retribution">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze>>
			<<else>>
				<<set $mouthactiondefault to "demand">>
				<<set $fallenangelretribution to 1>>
                <<if $options.bjx_divine>>
				    <<defiance `1 + $englishtrait`>>
				<</if>>
				<<if $enemytype is "beast">>
					"退散吧，<<beasttype>>！"
				<<else>>
					"你会为你的罪恶付出代价！"
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "seduce">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze>>
			<<else>>
				<<set $mouthactiondefault to "moan">>
				<<set $demonseduce to 1>>
				<<submission 150>>
				<<if $enemytype is "beast">>
					"为我高潮吧你这头小野兽~"
				<<else>>
					"为我高潮~"
				<</if>>
			<</if>>
		<</if>>
		/* 北极星 */

		<<if $mouthaction is "peniskiss">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "peniskiss">>
			<<actionspeniskiss `($chestuse is "penis" ? $chesttarget : $mouthtarget)`>>
			<<submission 3>><<oralskilluse>>
		<</if>>

		<<if $mouthaction is "lick">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "lick">><<actionspenislick $mouthtarget>><<submission 5>><<oralskilluse>>
		<</if>>

		<<if $mouthaction is "suck">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "suck">><<actionspenissuck $mouthtarget>><<submission 10>><<oralskilluse>>
		<</if>>

		<<if $mouthaction is "oraledge">>
			<<personselect $mouthtarget>><<actionsoraledge $mouthtarget>><<set $mouthaction to 0>><<set $mouthactiondefault to "oraledge">>
			<<submission 5>><<sexControl 5 `currentSkillValue("oralskill")` $mouthtarget>><<oralskilluse>>
		<</if>>

		<<if $mouthaction is "pullaway">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "pullaway">><<personselect $mouthtarget>>
			You try to pull your head away from the penis threatening your mouth.
			<<oralskilluse>><<brat 1 $mouthtarget>>
			<<set _nectarDifficulty to Math.clamp($drugged, 0, 500) + Math.clamp($nectar_addiction, 0, 500)>>
			<<willpowerdifficulty _nectarDifficulty $willpowermax "silent">>
			<<if $NPCList[$mouthtarget].type is "plant" and $mouthstate is "penetrated" and !$willpowerSuccess>>
				<span class="red">However, you can't tear yourself from the sweet nectar.</span>
				You desperately suck on the penis invading your mouth.
				<<willpower 1>>
			<<else>>
				<<if combatSkillCheck("oral", $mouthtarget)>>
					<<set $pullaway to 1>>
					<<if $NPCList[$mouthtarget].penis is "mouth">>
						<<set $NPCList[$mouthtarget].penis to "mouthimminent">><<set $mouthstate to "imminent">><span class="green"><<He>> doesn't stop you.</span>
					<<elseif $NPCList[$mouthtarget].penis is "mouthimminent">>
						<<set $NPCList[$mouthtarget].penis to "mouthentrance">><<set $mouthstate to "entrance">><span class="green"><<He>> doesn't stop you.</span>
					<<elseif $NPCList[$mouthtarget].penis is "mouthentrance">>
						<<set $NPCList[$mouthtarget].penis to 0>><<set $mouthstate to 0>><<set $mouthuse to 0>><<set $mouthstate to 0>><<set $NPCList[$mouthtarget].location.genitals to 0>>
						<span class="green"><<He>> doesn't stop you.</span>
					<</if>>
				<<else>>
					<<if $consensual is 1>>
						<<set $consensual to 0>><<molested>><<controlloss>>
					<</if>>
					<<violence 1>>
					<<if $mouthstate is "penetrated">>
						<span class="red">However, <<he>> refuses to allow it,</span> forcing the phallus back into your mouth.
					<<elseif $mouthstate is "imminent">>
						<span class="red">However, <<he>> refuses to allow it,</span> instead pushing the penis against your lips.
					<<elseif $mouthstate is "entrance">>
						<span class="red">However, <<he>> refuses to allow it,</span> instead pushing the penis against your lips.
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "pullawayvagina" and ($NPCList[$mouthtarget].vagina is "mouth" or $NPCList[$mouthtarget].vagina is "facesit")>>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "pullawayvagina">><<personselect $mouthtarget>><<set $mouthstate to 0>>
			<<if $consensual is 1>>
				You try to move your head away from the pussy.
				<<oralskilluse>><<brat 1 $mouthtarget>>
			<<else>>
				You try to pull your head away from the pussy threatening your mouth.
				<<oralskilluse>><<brat 1 $mouthtarget>>
			<</if>>
			<<oralskilluse>><<brat 1 $mouthtarget>>
			<<set _nectarDifficulty to Math.clamp($drugged, 0, 500) + Math.clamp($nectar_addiction, 0, 500)>>
			<<willpowerdifficulty _nectarDifficulty $willpowermax "silent">>
			<<if $NPCList[$mouthtarget].type is "plant" and !$willpowerSuccess>>
				<span class="red">However, you can't tear yourself from the sweet nectar.</span> You desperately lick the pussy pressing against your mouth.
				<<willpower 1>>
			<<else>>
				<<if combatSkillCheck("oral", $mouthtarget)>>
					<<set $mouthuse to 0>><<set $mouthstate to 0>><<set $pullaway to 1>>
					<<set $NPCList[$mouthtarget].vagina to 0>><span class="green"><<He>> doesn't stop you.</span>
					<<set $NPCList[$mouthtarget].location.genitals to 0>>
				<<else>>
					<<if $consensual is 1>>
						<<set $consensual to 0>><<molested>><<controlloss>>
					<</if>>
					<span class="red">However, <<theowner>> refuses to allow it,</span> forcing it against your face.
					<<violence 1>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "bite" and $NPCList[$mouthtarget].penis is "mouth">>
			<<if $earSlime.growth gt 50 and $earSlime.growth - random(0, Math.clamp(50 - ($earSlime.defyCooldown * 5), 0, 50)) gte (currentSkillValue('willpower')/ 10)>>
				You try to bite down on the <<npcPenisSimple $mouthtarget>>, <span class="red">but find your unable to.</span> You feel the slime steal your control away.
				<<set $mouthaction to 0>><<set $mouthactiondefault to "suck">><<actionspenissuck $mouthtarget>><<submission 10>><<oralskilluse>>
				<<if $earSlime.growth gte 100>><<set $earSlime.defyCooldown++>><</if>>
			<<else>>
				<<set $mouthaction to 0>><<set $mouthactiondefault to "bite">><<personselect $mouthtarget>>
				/* 北极星模组 */
				<<if $options.bjx_animal and $spider gte 6>>
			    	<<set $NPCList[$mouthtarget].poison += 3>>
				<</if>>
				/* 北极星 */
				You bite down on <<his>> <<npcPenisSimple $mouthtarget>>,
				<<if npcHasStrapon($mouthtarget)>>
					but it has no effect.
				<<else>>
					<<he>> <<if $enemytype is "man">>yelps<<elseif $enemytype is "beast">>growls<<else>>shrieks<</if>> and recoils in agony.
					<<set $NPCList[$mouthtarget].penis to 0>><<set $NPCList[$mouthtarget].location.genitals to 0>>
					<<defiance 20 $mouthtarget>><<attackstat>><<control 15>><<set $mouthuse to 0>><<set $penisbitten to 1>><<set $mouthstate to 0>>
					<<if $transformationParts.traits.fangs isnot "disabled">>
						<<defiance 20 $mouthtarget>><<defiance 20 $mouthtarget>>
						You lick your fangs clean.
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "bitepussy" and ($NPCList[$mouthtarget].vagina is "mouth" or $NPCList[$mouthtarget].vagina is "facesit")>>
			<<if $earSlime.growth gt 50 and $earSlime.growth - random(0, Math.clamp(50 - ($earSlime.defyCooldown * 5), 0, 50)) gte (currentSkillValue('willpower')/ 10)>>
				You try to bite down on <<hisselect $mouthtarget>> labia, <span class="red">but find your unable to.</span> You feel the slime steal your control away.
				<<set $mouthaction to "vaginalick">>
				<<if $earSlime.growth gte 100>><<set $earSlime.defyCooldown++>><</if>>
			<<else>>
				<<set $mouthaction to 0>><<set $mouthactiondefault to "bitepussy">><<personselect $mouthtarget>>
				/* 北极星模组 */
				<<if $options.bjx_animal and $spider gte 6>>
			    	<<set $NPCList[$mouthtarget].poison += 3>>
				<</if>>
				/* 北极星 */
				You bite down on <<hisselect $mouthtarget>> labia. <<He>> <<if $enemytype is "man">>yelps<<elseif $enemytype is "beast">>growls<<else>>shrieks<</if>> and recoils in agony.
				<<set $NPCList[$mouthtarget].vagina to 0>><<set $NPCList[$mouthtarget].location.genitals to 0>>
				<<defiance 20 $mouthtarget>><<attackstat>><<control 15>><<set $mouthuse to 0>><<set $penisbitten to 1>><<set $mouthstate to 0>><<set $speechhit to 1>>
				<<if $transformationParts.traits.fangs isnot "disabled">>
					<<defiance 40 $mouthtarget>>
					You lick your fangs clean.
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "vaginalick" and ($NPCList[$mouthtarget].vagina is "mouth" or $NPCList[$mouthtarget].vagina is "facesit")>>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "vaginalick">><<actionspussylick $mouthtarget>><<submission 10>><<oralskilluse>>
		<</if>>

		<<if $mouthaction is "pullawaykiss" and $NPCList[$mouthtarget].mouth.toString().includes("kiss")>>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "pullawaykiss">><<personselect $mouthtarget>>
			You try to pull your head away from <<his>> lips.
			<<oralskilluse>><<brat 1 $mouthtarget>>
			<<set _nectarDifficulty to Math.clamp($drugged, 0, 500) + Math.clamp($nectar_addiction, 0, 500)>>
			<<willpowerdifficulty _nectarDifficulty $willpowermax "silent">>
			<<if $NPCList[$mouthtarget].type is "plant" and $mouthstate isnot "kissentrance" and !$willpowerSuccess>>
				<span class="red">However, you can't tear yourself from the sweet nectar.</span>
				<<if $mouthstate is "kissimminent">>
					You kiss <<him>> back, parting <<his>> lips with your tongue.
				<<elseif $mouthstate is "kiss">>
					You kiss <<him>> back, caressing <<his>> tongue with your own.
				<</if>>
				<<willpower 1>>
			<<else>>
				<<if combatSkillCheck("oral", $mouthtarget)>>
					<<set $mouthuse to 0>><<set $mouthstate to 0>>
					<<set $NPCList[$mouthtarget].mouth to 0>><span class="green"><<He>> doesn't stop you.</span>
					<<set $NPCList[$mouthtarget].location.head to 0>>
				<<else>>
					<<if $consensual is 1>>
						<<set $consensual to 0>><<molested>><<controlloss>>
					<</if>>
					<<if $mouthstate is "kissentrance">>
						<span class="red">However, <<he>> refuses to allow it,</span> preventing you from moving away from their face.
					<<else>>
						<span class="red">However, <<he>> refuses to allow it,</span> kissing you more firmly.
					<</if>>
					<<violence 1>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "kissback">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "kissback">><<actionskissback $mouthtarget>><<submission 2>><<oralskilluse>>
		<</if>>

		<<if $mouthaction is "anallick">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "anallick">><<actionsAnalLick $mouthtarget>><<submission 10>><<oralskilluse>>
		<</if>>

		<<if $mouthaction is "analkiss">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "analkiss">><<actionsAnalKiss $mouthtarget>><<submission 12>>
		<</if>>

		<<if $mouthaction is "analpull" and ($NPCList[$mouthtarget].penis is "mouthotheranus" or $NPCList[$mouthtarget].vagina is "mouthotheranus")>>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "analpull">><<personselect $mouthtarget>>
			You try to pull away from the anus menacing your mouth.
			<<oralskilluse>><<brat 1 $mouthtarget>>
			<<if combatSkillCheck("oral", $mouthtarget)>>
				<span class="green"><<He>> doesn't stop you.</span>
				<<set $mouthstate to 0>><<set $mouthuse to 0>>
				<<if $NPCList[$mouthtarget].penis is "mouthotheranus">><<set $NPCList[$mouthtarget].penis to 0>><</if>>
				<<if $NPCList[$mouthtarget].vagina is "mouthotheranus">><<set $NPCList[$mouthtarget].vagina to 0>><</if>>
				<<set $NPCList[$mouthtarget].location.genitals to 0>>
			<<else>>
				<span class="red">However, <<combatperson>> refuses to allow it,</span> forcing your face into <<his>> ass.
				<<violence 1>>
				<<if $consensual is 1>>
					<<set $consensual to 0>><<molested>><<controlloss>>
				<</if>>
			<</if>>
		<</if>>

		<<rng>>

		<<if $mouthaction is "handbite">>
			<<if $earSlime.growth gt 50 and $earSlime.growth - random(0, Math.clamp(50 - ($earSlime.defyCooldown * 5), 0, 50)) gte (currentSkillValue('willpower')/ 10)>>
				You try to bite down on <<hisselect $mouthtarget>> labia, <span class="red">but find your unable to.</span> You feel the slime steal your control away.
				<<set $mouthactiondefault to "rest">>
				<<if $earSlime.growth gte 100>><<set $earSlime.defyCooldown++>><</if>>
			<<else>>
				<<set $mouthaction to 0>><<set $mouthactiondefault to "handbite">><<personselect $mouthtarget>>
				/* 北极星模组 */
				<<if $options.bjx_animal and $spider gte 6>>
			    	<<set $NPCList[$mouthtarget].poison += 3>>
				<</if>>
				/* 北极星 */
				<<actionshandbite $mouthtarget>>
				<<if $transformationParts.traits.fangs isnot "disabled">>
					<<defiance 6 $mouthtarget>>
				<<else>>
					<<defiance 2 $mouthtarget>>
				<</if>>
				<<if random(1, 5) gte 3 and ($transformationParts.traits.fangs isnot "disabled") or random(1, 5) gte 5>>
					<<set $mouthuse to 0>>
					<<if $NPCList[$mouthtarget].lefthand is "mouth">>
						<<set $NPCList[$mouthtarget].lefthand to 0>>
						<<control 15>>
						<span class="teal"><<He>> flinches away in pain, freeing your mouth.</span>
					<</if>>
					<<if $NPCList[$mouthtarget].righthand is "mouth">>
						<<set $NPCList[$mouthtarget].righthand to 0>>
						<<control 15>>
						<span class="teal"><<He>> flinches away in pain, freeing your mouth.</span>
					<</if>>
				<<else>>
					<<control -5>>
					<span class="purple">It remains over your mouth.</span>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "headbutt" and $NPCList[$mouthtarget].mouth.toString().includes("kiss")>>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "headbutt">><<personselect $mouthtarget>>
			<<if $mouthstate is "kiss">>
				You disengage from the kiss, and headbutt <<him>> in retaliation.
			<<else>>
				You quickly rear back and headbutt <<him>>.
			<</if>>
			<<He>> <<if $enemytype is "beast">>yelps and backs off<<else>>yells and stumbles back, clutching <<his>> head<</if>>.
			<<if ($description is "faithful" or $description is "fallen") and $sydney.glasses is "glasses">>
				<<set $sydney.glasses to "playerbroken">>
				<span class="purple"><<His>> glasses shatter.</span>
			<</if>>
			<<defiance 10 $mouthtarget>><<attackstat>><<set $mouthuse to 0>><<set $mouthstate to 0>>
			/* 北极星模组 */
			<<if !$options.bjx_animal and ($cow gte 2 and $demon gte 2) or $options.bjx_animal and $chimera.demoncow.horns is "default">>
			/* 北极星 */
				<<defiance 10 $mouthtarget>><<defiance 10 $mouthtarget>>
			<</if>>
			/* 北极星模组 */
			<<if !$options.bjx_animal and $demon gte 2 or $options.bjx_animal and ($transformationParts.demon.horns isnot "disabled" or $transformationParts.deer.horns isnot "disabled")>>
			/* 北极星 */
				<<defiance 10 $mouthtarget>>
				<<if $leftarm isnot "bound" or $rightarm isnot "bound">>
					You rub your horns.
				<</if>>
			<</if>>
			/* 北极星模组 */
			<<if !$options.bjx_animal and $cow gte 2 or $options.bjx_animal and ($transformationParts.cow.horns isnot "disabled" or $transformationParts.sheep.horns isnot "disabled" or $transformationParts.dragon.horns isnot "disabled")>>
			/* 北极星 */
				<<print either("That didn't hurt you at all!", "You remain unshaken by the blow.", "You're unharmed by the hit.")>>
			<<else>>
				<<pain 4>>
				<<if $pain lte 20>>
					Your own head immediately stings.
				<<elseif $pain lte 60>>
					Your ears begin to ring from the blow.
				<<else>>
					Your mind feels rattled by the impact.
				<</if>>
				<<gpain>>
			<</if>>
			<<set $head to 0>>
			<<set $NPCList[$mouthtarget].mouth to 0>>
			<<set $NPCList[$mouthtarget].location.head to 0>>
		<</if>>
		
		/* 北极星模组 */
		<<if $mouthaction is "corrode" and $NPCList[$mouthtarget].mouth.toString().includes("kiss")>>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "corrode">><<personselect $mouthtarget>>
			<<if $mouthstate is "kiss">>
				<span class='green'>感受到嘴唇上的灼烧感，<<His>>的眼睛瞪得大大的。</span>
			<<else>>
				<span class='green'>你迅速将嘴唇凑了上去，而你的腐蚀性粘液将会完成剩下的工作。</span>
			<</if>>
			<<He>><<if $enemytype is "beast">>惨叫一声，向后退去<<else>>惨叫一声，捂住了<<his>>的嘴，跌跌撞撞地向后退去<</if>>。
			<<defiance 10 $mouthtarget>><<attackstat>><<set $mouthuse to 0>><<set $mouthstate to 0>>
			<<set $head to 0>>
			<<set $NPCList[$mouthtarget].mouth to 0>>
			<<set $NPCList[$mouthtarget].location.head to 0>>
		<</if>>
		/* 北极星 */

		<<if $mouthaction is "grasp" and $NPCList[$mouthtarget].penis is "mouthentrance">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "grasp">><<chestskilluse>><<combatpromiscuity3>>
			<<if combatSkillCheck("chest", $mouthtarget)>>
				<<set $chestactiondefault to "rub">><<set $chestuse to "penis">><<cheststat>><<set $mouthstate to 0>><<set $mouthuse to 0>><<set $mouthactiondefault to "peniskiss">>
				<<set $NPCList[$mouthtarget].penis to "chest">><<personselect $mouthtarget>><<set $chesttarget to $mouthtarget>>
				<<if $breastcup is "none">>
					<span class="lblue">You <<chesttext>> squeeze your <<breasts>> together as best you can and try to grab <<hisselect $mouthtarget>> $NPCList[$mouthtarget].penisdesc between them.
					Your breasts are too small for it to be effective, but your cute attempt succeeds in charming <<him>>.</span> <<He>> rubs <<his>> penis against your chest.
				<<else>>
					<span class="lblue">You <<chesttext>> grab <<hisselect $mouthtarget>> $NPCList[$mouthtarget].penisdesc between your <<breasts>>.</span>
				<</if>>
			<<else>>
				<<if $player.breastsize is 0>>
					You squeeze your <<breasts>> together as best you can and try to grab <<his>> penis between them, to no avail.
				<<else>>
					You try to grab <<hisselect $mouthtarget>> penis between your <<breasts>>, but fail.
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "finish">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2 and $gamemode isnot "soft">>
				<<wheeze "tell <<him>> you want to stop">>
			<<else>>
				<<set $mouthactiondefault to "rest">><<brat 10>>
				You tell <<him>> you've had enough and want to stop.
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif !$loveDrunk and $NPCList[0].type isnot "plant" and combatSkillCheck("seduction", $mouthtarget) or $gamemode is "soft" or $gloryhole>>
					<<set $finish to 1>>
					<<if $trueconsensual isnot 1 and $gamemode is "soft">>
						<<set $enemyhealth to -100>>
					<</if>>
					<<if $enemytype is "man" or $monster is 1>>
						<<if $enemyno gte 2>>They look<<else>><<He>> looks<</if>> disappointed, <span class="green">but <<if $enemyno gte 2>>comply<<else>>complies<</if>>.</span>
					<<else>>
						It can't speak, <span class="green">but understands your tone and complies.</span>
					<</if>>
					<<if $gamemode is "soft">>
						<<set $enemyhealth to -1000>>
					<</if>>
				<<else>>
					<<set $consensual to 0>>
					<<switch $enemytype>>
						<<case "plant">>
							<span class="red"><<He>> shakes <<his>> head happily.</span>
						<<case "beast">>
							Eager to <<if $pregnancyspeechdisable is "f">>breed<<else>>fuck<</if>>, <span class="red"><<bhe>> ignores your desire.</span>
						<<default>>
							<span class="red"><<if $enemyno gte 2>>They refuse!<<else>><<He>> refuses!<</if>></span>
					<</switch>>
					<<molested>><<controlloss>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "novaginal">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "tell <<him>> you don't want anything penetrating your vagina">>
			<<else>>
				<<set $mouthactiondefault to "rest">><<brat 5>><<if !$gloryhole and $gamemode isnot "soft">><<seductionskillusecombat>><</if>>
				<<if $player.virginity.vaginal is true>>
					You tell <<him>> you don't want anything penetrating your vagina, you are a virgin after all.
				<<else>>
					You tell <<him>> you don't want anything penetrating your vagina.
				<</if>>
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif combatSkillCheck("seduction", $mouthtarget) or $gamemode is "soft" or $gloryhole>>
					<<set $novaginal to 1>><span class="green"><<if $enemyno gte 2>>They nod<<else>><<He_Short>> nods<</if>> in acknowledgement.</span>
					<<if $vaginastate is "doublepenetrated">>
						<<set $vaginastate to "doubleentrance">><<set $vaginaaction to 0>>
						<<if $NPCList[$vaginatarget].penis is "vaginadouble" and $NPCList[$vaginadoubletarget].penis is "vaginadouble">>
							<<set $NPCList[$vaginatarget].penis to "vaginaentrancedouble">>
							<<set $NPCList[$vaginadoubletarget].penis to "vaginaentrancedouble">>
							<<combatPerson>> and <<personselect $vaginadoubletarget>><<combatperson>> withdraw their penises from your vagina.
						<</if>>
					<<elseif $vaginastate is "penetrated">>
						<<set $vaginastate to "entrance">><<set $vaginaaction to 0>>
						<<if $NPCList[$vaginatarget].penis is "vagina">>
							<<set $NPCList[$vaginatarget].penis to "vaginaentrance">>
							<<combatPerson>> withdraws <<his>> penis from your vagina.
						<</if>>
					<</if>>
				<<else>>
					<<set $consensual to 0>>
					<<if $NPCList[$mouthtarget].type is "plant">>
						<<He>> scoffs. <span class="red">"Are you kidding? That's the fun part!"</span>
					<<else>>
						They pause a moment before responding, <span class="red">"Stupid slut, you think you can tell me what to do?"</span>
					<</if>>
					<<molested>><<controlloss>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "noanal">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "tell <<him>> you don't want anything inside your anus">>
			<<else>>
				<<set $mouthactiondefault to "rest">><<brat 5>><<if !$gloryhole and $gamemode isnot "soft">><<seductionskillusecombat>><</if>>
				<<if $player.virginity.anal is true>>
					You tell <<him>> you don't want anything inside your anus, it's dirty there!
				<<else>>
					You tell <<him>> you don't want anything penetrating your anus.
				<</if>>
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif combatSkillCheck("seduction", $mouthtarget) or $gamemode is "soft" or $gloryhole>>
					<<set $noanal to 1>><span class="green"><<if $enemyno gte 2>>They nod<<else>><<He_Short>> nods<</if>> in acknowledgement.</span>
					<<if $anusstate is "doublepenetrated">>
						<<set $anusstate to "doubleentrance">><<set $anusaction to 0>>
						<<if $NPCList[$anustarget].penis is "anusdouble" and $NPCList[$anusdoubletarget].penis is "anusdouble">>
							<<set $NPCList[$anustarget].penis to "anusentrancedouble">>
							<<set $NPCList[$anusdoubletarget].penis to "anusentrancedouble">>
							<<combatPerson>> and <<personselect $anusdoubletarget>><<combatperson>> withdraw their penises from your vagina.
						<</if>>
					<<elseif $anusstate is "penetrated">>
						<<set $anusstate to "entrance">><<set $anusaction to 0>>
						<<if $NPCList[$anustarget].penis is "anus">>
							<<set $NPCList[$anustarget].penis to "anusentrance">>
							<<combatPerson>> withdraws <<his>> penis from your anus.
						<</if>>
					<</if>>
				<<else>>
					<<set $consensual to 0>>
					<<if $NPCList[$mouthtarget].type is "plant">>
						<<He>> scoffs. <span class="red">"Are you kidding? That's the fun part!"</span>
					<<else>>
						They pause a moment before responding, <span class="red">"Stupid slut, you think you can tell me what to do?"</span>
					<</if>>
					<<molested>><<controlloss>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "nopenile">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "tell <<him>> you don't want your penis put inside anything">>
			<<else>>
				<<set $mouthactiondefault to "rest">><<brat 5>><<if !$gloryhole and $gamemode isnot "soft">><<seductionskillusecombat>><</if>>
				<<if $player.virginity.penile is true>>
					You tell <<him>> you don't want your penis put inside anything, you are a virgin after all.
				<<else>>
					You tell <<him>> you don't want your penis put inside anything.
				<</if>>
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif combatSkillCheck("seduction", $mouthtarget) or $gamemode is "soft" or $gloryhole>>
					<<set $nopenile to 1>><span class="green"><<if $enemyno gte 2>>They nod<<else>><<He_Short>> nods<</if>> in acknowledgement.</span>
					<<if $penisstate is "penetrated">>
						<<set $penisstate to "entrance">>
						<<if $NPCList[$penistarget].vagina is "penis">>
							<<personselect $penistarget>>
							<<set $NPCList[$penistarget].vagina to "penisentrance">>The <<person>> frees your penis from <<his>> vagina.
						<</if>>
					<</if>>
					<<if $penisstate is "otheranus">>
						<<set $penisstate to "otheranusentrance">>
						<<if $NPCList[$penistarget].penis is "otheranus">>
							<<personselect $penistarget>>
							<<set $NPCList[$penistarget].penis to "otheranusentrance">>The <<person>> frees your penis from <<his>> anus.
						<</if>>
					<</if>>
					<<if $penisstate is "othermouth">>
						<<set $penisstate to "othermouthentrance">>
						<<if $NPCList[$penistarget].mouth is "penis">>
							<<personselect $penistarget>>
							<<set $NPCList[$penistarget].mouth to "penisentrance">>The <<person>> slips your penis out of <<his>> mouth.
						<</if>>
					<</if>>
				<<else>>
					<<set $consensual to 0>>
					<<if $NPCList[$mouthtarget].type is "plant">>
						<<He>> scoffs. <span class="red">"Are you kidding? That's the fun part!"</span>
					<<else>>
						They pause a moment before responding, <span class="red">"Stupid slut, you think you can tell me what to do?"</span>
					<</if>>
					<<molested>><<controlloss>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "noupper">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "tell <<him>> to leave your top on">>
			<<else>>
				<<set $mouthactiondefault to "rest">><<brat 5 demanding>><<if !$gloryhole and $gamemode isnot "soft">><<seductionskillusecombat>><</if>><<unset $askAction>>
				<<set $noupperasked to 1>>
				You tell <<him>> to leave your top on.

				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif $combatgoal is "strip">>
					<span class="pink">"No," <<if $enemyno gte 2>>they laugh<<else>><<he>> laughs<</if>>. "You'll look better without it."</span>
				<<elseif combatSkillCheck("seduction", $mouthtarget) or $gamemode is "soft" or $gloryhole>>
					<<set $noupper to 1>><span class="green"><<if $enemyno gte 2>>They nod<<else>><<He_Short>> nods<</if>> in acknowledgement.</span>
					<<for _j = 0; _j lt $enemynomax; _j++>>
						<<if $NPCList[_j].lefthand is "overupperclothes">>
							<<personselect _j>>
							<<set $NPCList[_j].lefthand to 0>>The <<person>> releases your $worn.over_upper.name.
						<<elseif $NPCList[_j].lefthand is "upperclothes">>
							<<personselect _j>>
							<<set $NPCList[_j].lefthand to 0>>The <<person>> releases your $worn.upper.name.
						<<elseif $NPCList[_j].lefthand is "underupperclothes">>
							<<personselect _j>>
							<<set $NPCList[_j].lefthand to 0>>The <<person>> releases your $worn.under_upper.name.
						<</if>>
						<<if $NPCList[_j].righthand is "overupperclothes">>
							<<personselect _j>>
							<<set $NPCList[_j].righthand to 0>>The <<person>> releases your $worn.over_upper.name.
						<<elseif $NPCList[_j].righthand is "upperclothes">>
							<<personselect _j>>
							<<set $NPCList[_j].righthand to 0>>The <<person>> releases your $worn.upper.name.
						<<elseif $NPCList[_j].righthand is "underupperclothes">>
							<<personselect _j>>
							<<set $NPCList[_j].righthand to 0>>The <<person>> releases your $worn.under_upper.name.
						<</if>>
					<</for>>
				<<else>>
					<<set $consensual to 0>>
					<<if $NPCList[$mouthtarget].type is "plant">>
						<<He>> scoffs. <span class="red">"Are you kidding? That's the fun part!"</span>
					<<else>>
						They pause a moment before responding, <span class="red">"Stupid slut, you think you can tell me what to do?"</span>
					<</if>>
					<<molested>><<controlloss>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "nomask">>
			<<set $mouthaction to 0>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "tell <<him>> to leave your "+ $worn.face.name " on">>
			<<else>>
				<<set $mouthactiondefault to "rest">><<brat 5 demanding>><<if !$gloryhole and $gamemode isnot "soft">><<seductionskillusecombat>><</if>><<unset $askAction>>
				<<set $noupperasked to 1>>
				You tell <<him>> to leave your $worn.face.name on.

				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif $combatgoal is "strip">>
					<span class="pink">"No," <<if $enemyno gte 2>>they laugh<<else>><<he>> laughs<</if>>. "You'll look better without it."</span>
				<<elseif combatSkillCheck("seduction", $mouthtarget) or $gamemode is "soft" or $gloryhole>>
					<<set $noupper to 1>><span class="green"><<if $enemyno gte 2>>They nod<<else>><<He_Short>> nods<</if>> in acknowledgement.</span>
					<<for _j = 0; _j lt $enemynomax; _j++>>
						<<if $NPCList[_j].lefthand is "mask">>
							<<personselect _j>>
							<<set $NPCList[_j].lefthand to 0>>The <<person>> releases your $worn.face.name.
						<</if>>
						<<if $NPCList[_j].righthand is "mask">>
							<<personselect _j>>
							<<set $NPCList[_j].righthand to 0>>The <<person>> releases your $worn.face.name.
						<</if>>
					<</for>>
				<<else>>
					<<set $consensual to 0>>
					<<if $NPCList[$mouthtarget].type is "plant">>
						<<He>> scoffs. <span class="red">"Are you kidding? That's the fun part!"</span>
					<<else>>
						They pause a moment before responding, <span class="red">"Stupid slut, you think you can tell me what to do?"</span>
					<</if>>
					<<molested>><<controlloss>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "nochoke">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "tell <<him>> you don't want to be choked">>
			<<else>>
				<<set $mouthactiondefault to "rest">><<brat 5>><<if !$gloryhole and $gamemode isnot "soft">><<seductionskillusecombat>><</if>>
				You tell <<him>> you don't want <<his>> hands around your neck.
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif combatSkillCheck("seduction", $mouthtarget) or $gamemode is "soft" or $gloryhole>>
					<<set $nochoke to 1>><span class="green"><<if $enemyno gte 2>>They nod<<else>><<He_Short>> nods<</if>> in acknowledgement.</span>
					<<if $neckuse is "hand">>
						<<unset $neckuse>>
						<<for _j = 0; _j lt $enemynomax; _j++>>
							<<if $NPCList[_j].lefthand is "throat" or $NPCList[_j].righthand is "throat">>
								<<personselect _j>>
								<<if $NPCList[_j].lefthand is "throat">><<set $NPCList[_j].lefthand to 0>><</if>>
								<<if $NPCList[_j].righthand is "throat">><<set $NPCList[_j].righthand to 0>><</if>>
								The <<person>> releases your neck.
							<</if>>
						<</for>>
					<</if>>
				<<else>>
					<<set $consensual to 0>>
					<<if $NPCList[$mouthtarget].type is "plant">>
						<<He>> scoffs.
						<<if $NPCList[0].lefthand is 0 or $NPCList[0].righthand is 0>>
							<span class="red">Are you kidding? That's the fun part! Here, look!"</span>
						<<else>>
							<span class="red">Are you kidding? That's the fun part!"</span>
						<</if>>
					<<else>>
						They pause a moment before responding, <span class="red">"Stupid slut, you think you can tell me what to do?"</span>
					<</if>>
					<<molested>><<controlloss>>
					<<for _j = 0; _j lt $enemynomax; _j++>>
						<<if $NPCList[_j].lefthand is 0>>
							<<personselect _j>>
							<<set $NPCList[_j].lefthand to "throat">>
							<<set $neckuse to "hand">>
							<span class="red">The <<person>> immediately grabs your neck with <<his>> free hand.</span>
							<<break>>
						<<elseif $NPCList[_j].righthand is 0>>
							<<personselect _j>>
							<<set $NPCList[_j].lefthand to "throat">>
							<<set $neckuse to "hand">>
							<span class="red">The <<person>> immediately grabs your neck with <<his>> free hand.</span>
							<<break>>
						<</if>>
					<</for>>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "condoms">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<personselect $mouthtarget>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "tell <<him>> to use a condom">>
			<<else>>
				<<set $mouthactiondefault to "rest">><<sub 2>>
				<<if $NPCList[$mouthtarget].condom and $NPCList[$mouthtarget].condom.willUse is true>><<set $_checkSkip to true>><</if>>
				<<if $consensual is 0>>
					<<set $_condomAskBaseDifficulty to 2000 + 10 * (100 - $NPCList[$mouthtarget].pregnancyAvoidance)>>
					<<set $_condomAskDifficultyMultiplier to 200>>
				<<else>>
					<<set $_condomAskBaseDifficulty to 1500 + 5 * (100 - $NPCList[$mouthtarget].pregnancyAvoidance)>>
					<<set $_condomAskDifficultyMultiplier to 100>>
				<</if>>
				<<if !$gloryhole and $gamemode isnot "soft" and !$npcrow.includes($mouthtarget) and !$_checkSkip>><<seductionskillusecombat>><</if>>
				<<set $NPCList[$mouthtarget].condomAsk to true>>
				You ask <<combatperson>> to use a condom.
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif combatSkillCheck("seduction", $mouthtarget, $_condomAskBaseDifficulty, $_condomAskDifficultyMultiplier) or $gamemode is "soft" or $gloryhole or $npcrow.includes($mouthtarget) or $_checkSkip>>
					<<if !$npcrow.includes($mouthtarget)>>
						<<if $condomLvl is 1 or !$NPCList[$mouthtarget].condom>>
							<<set $NPCList[$mouthtarget].condomCanGive to true>>
							<<if $consensual is 0>>
								<<He_Short>> pauses a moment before responding.
								<<set _response to [
									"I'll use one if you have one.",
									"I hope you brought one.",
									"I don't have one. Do you?",
									"Looks like I forgot mine at home.",
									"You better have one."
								]>>
							<<else>>
								<<He_Short>> looks nervous for a moment.
								<<set _response to [
									"I didn't bring one. Do you have one?"
								]>>
							<</if>>
							<span class="blue">"<<print _response.pluck()>>"</span>
						<<elseif $NPCList[$mouthtarget].condom>>
							<<if $NPCList[$mouthtarget].condom.willUse is true>>
								<<if $consensual is 0>>
									<<He_Short>> nods.
									<<set _response to [
										"I was going to, anyways.",
										"Don't tell me what to do, I would have anyways.",
										"You think I'd fuck you raw? Stupid slut."
									]>>
								<<else>>
									<<He_Short>> nods.
									<<set _response to [
										"I was planning on using one anyways."
									]>>
								<</if>>
								<<if $pregnancyspeechdisable is "f">>
									<<if playerPregnancyPossibleWith($NPCList[$mouthtarget])>>
										<<run _response.pushUnique(
											"Do I look like I want a kid on my hands?",
											"I don't want to get you pregnant, slut.",
											"I'm not about to get a whore like you pregnant."
										)>>
									<<elseif NPCPregnancyPossibleWithPlayer($NPCList[$mouthtarget])>>
										<<run _response.pushUnique(
											"Do I look like I want a kid on my hands?",
											"I'm not about to let myself get pregnant.",
											"You're not putting a kid in me."
										)>>
									<</if>>
								<</if>>
								<span class="teal">"<<print _response.pluck()>>"</span>
							<<else>>
								<<set $NPCList[$mouthtarget].condom.willUse to true>>
								<<if $consensual is 0>>
									<<He_Short>> pauses a moment before responding.
									<<set _response to [
										"Sure thing, slut.",
										"Yeah, you probably have something contagious.",
										"Fine, but I expect you to cooperate.",
										"Good idea, I don't want any evidence traced back to me."
									]>>
								<<else>>
									<<He_Short>> nods in acknowledgement.
									<<set _response to [
										"I brought one, just in case."
									]>>
								<</if>>
								<<if $pregnancyspeechdisable is "f">>
									<<if playerPregnancyPossibleWith($NPCList[$mouthtarget])>>
										<<run _response.pushUnique(
											"I don't want a kid on my hands.",
											"I don't want to get you pregnant.",
											"Last thing I want is a brat with my name on it."
										)>>
									<<elseif NPCPregnancyPossibleWithPlayer($NPCList[$mouthtarget])>>
										<<run _response.pushUnique(
											"I don't want a kid on my hands.",
											"I'm not about to let myself get pregnant.",
											"You're not putting a kid in me."
										)>>
									<</if>>
								<</if>>
								<span class="green">"<<print _response.pluck()>>"</span>
							<</if>>
						<</if>>
					<<else>>
						/*Named NPC section*/
						/*If the NPC does not have a condom, or NPC condoms are disabled*/
						<<if $condomLvl is 1 or !$NPCList[$mouthtarget].condom>>
							/*If the NPC's pregnancyAvoidance is 50 or higher*/
							<<if $NPCList[$mouthtarget].pregnancyAvoidance gte 50>>
								<<set $NPCList[$mouthtarget].condomCanGive to true>>
								<<set $_speech to "acceptGive">>
							<<else>>
								<<set $_speech to "reject">>
							<</if>>
						/*If the NPC brought their own condom */
						<<elseif $NPCList[$mouthtarget].condom>>
							/*If the NPC was going to use the condom anyways*/
							<<if $NPCList[$mouthtarget].condom.willUse is true>>
								<<set $_speech to "acceptHas">>
							<<else>>
								<<set $NPCList[$mouthtarget].condom.willUse to true>>
								<<set $_speech to "accept">>
							<</if>>
						<</if>>
						<<set $_npcn to $npc[$npcrow.indexOf($mouthtarget)]>>
						<<switch $_npcn>>
							<<case "Robin">>
								/*Default pregnancyAvoidance is 50. Will have a condom if NPC condoms are enabled.*/
								<<switch $_speech>>
									<<case "accept">>
										<<He_Short>> nods. "Better to stay safe, right?"
									<<case "acceptGive">>
										<<He_Short>> nods. "Better to stay safe, right? <span class="blue">Do you have one?</span>"
									<<case "acceptHas">>
										<<He_Short>> nods. "Better to stay safe, right? <span class="teal">I have one.</span>"
									<<case "reject">>
										/*MEANT TO BE UNREACHABLE*/
										<<He_Short>> refuses! "<span class="red">That orphan ass is mine!</span>"
								<</switch>>
							<<case "Kylar">>
								/*Default pregnancyAvoidance is 0, and any condoms they use will be sabotaged beforehand.*/
								<<switch $_speech>>
									<<case "accept">>
										<<He_Short>> excitedly nods.
										<<if $awareness gte 300>>
											"O-of course! <span class="red">I even brought my own!</span>"
										<<else>>
											"O-of course! <span class="teal">I even brought my own!</span>"
										<</if>>
									<<case "acceptGive">>
										/*MEANT TO BE UNREACHABLE*/
										<<He_Short>> sadly nods. "Okay, but only because you cheated and reached this debug line. <span class="blue">Do you have one?</span>"
									<<case "acceptHas">>
										<<He_Short>> excitedly nods.
										<<if $awareness gte 300>>
											"O-of course! <span class="red">I even brought my own!</span>"
										<<else>>
											"O-of course! <span class="teal">I even brought my own!</span>"
										<</if>>
									<<case "reject">>
										<<He_Short>> looks sad for a moment.
										<<if pregnancyCompatible("Kylar") and $pregnancyspeechdisable is "f">>
											"B-but why? We're going to have many children. <span class="lewd">We should start now</span>."
										<<else>>
											"B-but why? We don't need one! <span class="lewd">I want to do it raw.</span>"
										<</if>>
								<</switch>>
							<<case "Eden">>
								/*Default pregnancyAvoidance is 0, maybe increase after having 1 or 2 children?*/
								<<switch $_speech>>
									<<case "accept">>
										<<He_Short>> looks annoyed. "<span class="green">Fine.</span><<if pregnancyCompatible("Eden") and $pregnancyspeechdisable is "f">> I don't need another mouth to feed<<else>> I guess cleanup would be a pain<</if>>."
									<<case "acceptGive">>
										<<He_Short>> looks annoyed. "<span class="blue">Fine, if you have one.</span><<if pregnancyCompatible("Eden") and $pregnancyspeechdisable is "f">> I don't need another mouth to feed<<else>> I guess cleanup would be a pain<</if>>."
									<<case "acceptHas">>
										<<He_Short>> looks annoyed. "<span class="teal">Fine, I have one lying around.</span> Don't blame me if it breaks, it's probably as old as you."
									<<case "reject">>
										<<He_Short>> sneers. "No. <span class="lewd">We're doing it my way.</span>"
								<</switch>>
							<<case "Whitney">>
								/*Default pregnancyAvoidance is 50*/
								<<switch $_speech>>
									<<case "accept">>
										<<He_Short>> grins. "<span class="green">Sure thing, slut.</span>."
									<<case "acceptGive">>
										<<He_Short>> grins. "<span class="blue">Sure, if you have one.</span>"
									<<case "acceptHas">>
										<<He_Short>> grins. "<span class="teal">Yeah, yeah, I'm working on it.</span> Impatient <<bitch>>."
									<<case "reject">>
										<<He_Short>> grins. "Nah, <span class="lewd">I don't think you deserve it.</span>"
								<</switch>>
							<<case "Alex">>
								/*Default pregnancyAvoidance is 50, but always forgets to bring a condom.*/
								<<switch $_speech>>
									<<case "accept">>
										/*MEANT TO BE UNREACHABLE*/
										<<He_Short>> frowns, and digs through a pocket. <<His>> face lights up. "<span class="green">How the hell did this get here?</span> I never remember these."
									<<case "acceptGive">>
										<<He_Short>> perks up. "Oh, sure!" <<He_Short>> digs through a pocket, then frowns. "<span class="blue">I didn't think to bring one. Do you have one?</span>"
									<<case "acceptHas">>
										/*MEANT TO BE UNREACHABLE*/
										<<He_Short>> frowns, and digs through a pocket. <<His>> face lights up. "<span class="teal">How the hell did this get here?</span> I never remember these."
									<<case "reject">>
										<<He_Short>> gives you a coy smile. <span class="lewd">Ask me when I'm sober.</span>"
								<</switch>>
							<<case "Sydney">>
								<<run statusCheck("Sydney")>>
								<<switch $_speech>>
									<<case "accept">>
										<<if _sydneyStatus.includes("corrupt")>>
											<<He_Short>> mockingly frowns, and sighs. "Fiiiiiiine."
										<<else>>
											<<He_Short>> nods. "We need to prevent the transfer of impure fluids."
										<</if>>
									<<case "acceptGive">>
										<<if _sydneyStatus.includes("corrupt")>>
											<<He_Short>> frowns. "Okay, but... <span class="blue">I didn't bring one.</span> Sorry."
										<<else>>
											<<He_Short>> nods, but pauses. "I don't... usually carry those... <span class="blue">do you have one?</span>"
										<</if>>
									<<case "acceptHas">>
										<<He_Short>> nods. "Way ahead of you. I've got one right..." <<he>> sticks a hand into <<his>> pocket.
										<<He_Short>> freezes, before feeling around some more. "Uh oh." <<He_Short>> checks <<his>> other pocket.
										"Aha! Right here!"
									<<case "reject">>
										You feel a hand tighten around your throat. "<span class="red">No.</span>"
								<</switch>>
							<<case "Morgan">>
								/*Default pregnancyAvoidance is random every encounter. I am so, so sorry.*/
								<<switch $_speech>>
									<<case "accept">>
										<span class="green"><<He_Short>> excitedly nods.</span> "All sorts of nasty things these protect against! I even wear them on my fingers sometimes."
									<<case "acceptGive">>
										<<He_Short>> excitedly nods. "Look at my <<charles>>, always thinking of my safety! <span class="blue">Give one here.</span>"
									<<case "acceptHas">>
										<<He_Short>> excitedly nods. "Yes, <<charles>>, <span class="teal">I was going to use protection!</span> Be patient!"
									<<case "reject">>
										<span class="red"><<He_Short>> frowns, and growls.</span> "I will not fuck the bag! The government can't make me do it! I won't!"
								<</switch>>
							<<default>>
								/*Need a case for Wren*/
								<<switch $_speech>>
									<<case "accept">>
										<span class="green"><<He_Short>> nods in acknowledgement.</span>
									<<case "acceptGive">>
										<<He_Short>> nods. "<span class="blue">If you have one.</span>"
									<<case "acceptHas">>
										<<He_Short>> nods. "<span class="teal">I was planning on using one anyways.</span>"
									<<case "reject">>
										<span class="red"><<He_Short>> refuses!</span>
								<</switch>>
						<</switch>>
					<</if>>
					<<npcCondomEquipImmediate $mouthtarget>>
				<<else>>
					<<if $consensual is 1>>
						<<set $consensual to 0>>
						<<molested>><<controlloss>>
					<</if>>
					<<set _response to [
						"You're not in charge here, slut.",
						"I'm clean. You have nothing to worry about.",
						"Hah! You wish!"
					]>>
					<<if $pregnancyspeechdisable is "f">>
						<<if playerPregnancyPossibleWith($NPCList[$mouthtarget])>>
							<<run _response.pushUnique(
								"You should feel lucky if I knock you up.",
								"Maybe I should just put a baby in you now.",
								"I could make you have my kids, and you wouldn't be able to do a damn thing."
							)>>
						<<elseif NPCPregnancyPossibleWithPlayer($NPCList[$mouthtarget])>>
							<<run _response.pushUnique(
								"I want your seed.",
								"No, you're going to give me kids.",
								"You don't have a choice. Make me a mother."
							)>>
						<</if>>
					<</if>>
					<<He_Short>> pauses a moment before responding.
					<span class="red">"<<print _response.pluck()>>"</span>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "noCondoms">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<personselect $mouthtarget>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "tell <<him>> to not use a condom">>
			<<else>>
				<<if !$NPCList[$mouthtarget].condom or ($NPCList[$mouthtarget].condom and !$NPCList[$mouthtarget].condom.willUse) or $NPCList[$mouthtarget].pregnancyAvoidance gte 90>><<set $_checkSkip to true>><</if>>
				<<set $mouthactiondefault to "rest">><<sub 2>><<if !$gloryhole and $gamemode isnot "soft" and !$_checkSkip>><<seductionskillusecombat>><</if>>
				<<set $NPCList[$mouthtarget].condomAsk to true>>
				<<if wearingCondom($mouthtarget) or wearingCondom("player")>>
					You ask <<combatperson>> to remove the condom.
				<<else>>
					You tell <<combatperson>> you don't want to use a condom.
				<</if>>
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif combatSkillCheck("seduction", $mouthtarget) or $gamemode is "soft" or $gloryhole or $npcrow.includes($mouthtarget) or $_checkSkip>>
					<<if !$npcrow.includes($mouthtarget)>>
						<<if $NPCList[$mouthtarget].pregnancyAvoidance lt 80 or ($condomLvl is 2 and !pregnancyCompatible($NPCList[$mouthtarget]))>>
							<<if !$player.condom and (!$NPCList[$mouthtarget].condom or $NPCList[$mouthtarget].condom.willUse is false)>>
								<<if !$NPCList[$mouthtarget].condom>>
									<<if $consensual is 0>>
										<<He_Short>> grins.
										<<set _response to [
											"Didn't have one anyway.",
											"Do you think I carry around condoms?",
											"Ah, yes, let me get the condom I specifically put aside for when I want to molest someone. Oh, wait. Stupid whore.",
											"Condoms are expensive. Don't have one.",
											"I don't have one anyways, slut."
										]>>
									<<else>>
										<<He_Short>> looks at you with a smug grin.
										<<set _response to [
											"I didn't bring one, anyways."
										]>>
									<</if>>
									<span class="blue">"<<print _response.pluck()>>"</span>
								<<else>>
									<<if $consensual is 0>>
										<<He_Short>> grins.
										<<set _response to [
											"Wasn't gonna use one anyways, slut.",
											"These things are expensive, I wouldn't waste one on you.",
											"I prefer it raw, anyways."
										]>>
									<<else>>
										<<He_Short>> looks at you with a smug grin.
										<<set _response to [
											"I wasn't planning on using it, anyways."
										]>>
									<</if>>
									<span class="teal">"<<print _response.pluck()>>"</span>
								<</if>>
							<<else>>
								<<if $NPCList[$mouthtarget].condom>>
									<<set $NPCList[$mouthtarget].condom.willUse to false>>
								<</if>>
								<<set _noCondom to true>>
								<<if $consensual is 0>>
									<<He_Short>> pauses a moment before responding.
									<<set _response to [
										"Sure thing, slut.",
										"You like it bareback, eh?",
										"Fine, but I expect you to cooperate.",
										"You better be clean."
									]>>
								<<else>>
									<<set _response to [
										"It probably feels better raw.",
										"Alright, let's do it."
									]>>
								<</if>>
								<<if $pregnancyspeechdisable is "f">>
									<<if playerPregnancyPossibleWith($NPCList[$mouthtarget])>>
										<<run _response.pushUnique(
											"Looking to get knocked up? Nice.",
											"I'll breed you good, slut.",
											"Maybe I'll put a baby in you."
										)>>
									<<elseif NPCPregnancyPossibleWithPlayer($NPCList[$mouthtarget])>>
										<<run _response.pushUnique(
											"Trying to knock me up? Nice.",
											"You'd better knock me up.",
											"Good. Put a baby in me."
										)>>
									<</if>>
								<</if>>
								<span class="lewd">"<<print _response.pluck()>>"</span>
							<</if>>
						<<else>>
							<<He_Short>> shakes <<his>> head.
							<<set _response to [
								"Not taking that chance.",
								"Sorry, I'm being safe about this.",
								"Shut up, don't be stupid."
							]>>
							<<if $pregnancyspeechdisable is "f">>
								<<if playerPregnancyPossibleWith($NPCList[$mouthtarget])>>
									<<run _response.pushUnique(
										"I'm not going to risk knocking you up.",
										"Look for someone else to be your baby daddy."
									)>>
								<<elseif NPCPregnancyPossibleWithPlayer($NPCList[$mouthtarget])>>
									<<run _response.pushUnique(
										"I'm not going to risk getting knocked up.",
										"Tempting, but no, I don't want to get pregnant.",
									)>>
								<</if>>
							<</if>>
							<span class="red">"<<print _response.pluck()>>"</span>
						<</if>>
					<<else>>
						/*Named NPC section*/
						/*If the NPC does not have a condom, or NPC condoms are disabled*/
						<<if !$NPCList[$mouthtarget].condom and !$player.condom>>
							<<set $_speech to "acceptNone">>
						/*If the NPC wasn't going to use one anyways*/
						<<elseif (!$NPCList[$mouthtarget].condom or ($NPCList[$mouthtarget].condom and !$NPCList[$mouthtarget].condom.willUse)) and !$player.condom>>
							<<set $_speech to "acceptWont">>
						<<else>>
							/*Outcome dependant on pregnancyAvoidance*/
							<<if $NPCList[$mouthtarget].pregnancyAvoidance lte 80>>
								<<if $NPCList[$mouthtarget].condom>>
									<<set $NPCList[$mouthtarget].condom.willUse to false>>
								<</if>>
								<<set _noCondom to true>>
								<<set $_speech to "accept">>
							<<else>>
								<<set $_speech to "reject">>
							<</if>>
						<</if>>
						<<set $_npcn to $npc[$npcrow.indexOf($mouthtarget)]>>
						<<switch $_npcn>>
							<<case "Robin">>
								<<switch $_speech>>
									<<case "accept">>
										<<He_Short>> nervously nods. "<span class="lewd">Are you sure this is safe?</span>"
									<<case "acceptNone">>
										<<He_Short>> nervously nods. "<span class="blue">I don't have one anyways...</span>"
									<<case "acceptWont">>
										<<He_Short>> nervously nods. "<span class="teal">I wasn't going to.</span>"
									<<case "reject">>
										<<He_Short>> refuses. "<span class="red">We can't be reckless!</span>"
								<</switch>>
							<<case "Kylar">>
								<<switch $_speech>>
									<<case "accept">>
										<<He_Short>> exciedly nods. "<span class="lewd">Good! No protection!</span>"
									<<case "acceptNone">>
										<<He_Short>> excitedly nods. "<span class="blue">Ah... all mine are broken anyways...</span>" <<He_Short>> quickly covers <<his>> mouth to shush <<himself>>.
									<<case "acceptWont">>
										<<He_Short>> excitedly nods. "<span class="teal">I would never dream of using one with you.</span>"
									<<case "reject">>
										/*MEANT TO BE UNREACHABLE*/
										<<He_Short>> refuses. "<span class="red">I am suddenly out of character and no longer interested in breeding.</span>"
								<</switch>>
							<<case "Eden">>
								<<switch $_speech>>
									<<case "accept">>
										<<He_Short>> nods. "<span class="lewd">Natural is best.</span> I don't trust the flimsy rubbers they make in town."
									<<case "acceptNone">>
										<<He_Short>> nods. "<span class="blue">I don't keep any of those around.</span>"
									<<case "acceptWont">>
										<<He_Short>> nods. "<span class="teal">I wasn't going to use one.</span>"
									<<case "reject">>
										<<He_Short>> refuses. "<span class="red">We need to be safe for a while.</span>"
								<</switch>>
							<<case "Whitney">>
								<<switch $_speech>>
									<<case "accept">>
										<<He_Short>> nods. "<span class="lewd">You want it raw? Good.</span>"
									<<case "acceptNone">>
										<<He_Short>> nods. "<span class="blue">I didn't bring one.</span> I thought you'd want it raw."
									<<case "acceptWont">>
										<<He_Short>> nods. "<span class="teal">I wasn't going to use one anyways, slut.</span>"
									<<case "reject">>
										<<He_Short>> refuses. "<span class="red">You're not in charge, <<bitch>>.</span>"
								<</switch>>
							<<case "Alex">>
								<<switch $_speech>>
									<<case "accept">>
										<<He_Short>> puts <<his>> arms up triumphantly. "<span class="lewd">Woo, we're riding bareback!</span>"
									<<case "acceptNone">>
										<<He_Short>> looks down sheepishly. "<span class="blue">I forgot to bring one anyways.</span>"
									<<case "acceptWont">>
										<<He_Short>> looks down sheepishly. "<span class="teal">I forgot to bring one anyways.</span>"
									<<case "reject">>
										<<He_Short>> refuses. "<span class="red">I didn't forget for once, so we're gonna use it, damn it!</span>"
								<</switch>>
							<<case "Sydney">>
								<<run statusCheck("Sydney")>>
								<<switch $_speech>>
									<<case "accept" "acceptNone" "acceptWont">>
										<<if _sydneyStatus.includes("corrupt")>>
											<<He_Short>> grins. "<span class="lewd">Good. Fuck me raw.</span>"
										<<else>>
											<<He_Short>> flushes. "<span class="lewd">Oh, okay! If you're sure...</span>"
										<</if>>
									<<case "reject">>
										<<He_Short>> refuses. "<span class="red">We need to be safe! I can't let the temple down.</span>"
								<</switch>>
							<<case "Morgan">>
								You're not even sure if <<he>> heard you.
							<<default>>
								<<switch $_speech>>
									<<case "accept" "acceptNone" "acceptWont">>
										<span class="green"><<He_Short>> nods in acknowledgement.</span>
									<<case "reject">>
										<span class="red"><<He_Short>> refuses.</span>
								<</switch>>
						<</switch>>
					<</if>>
					<<if _noCondom>>
						/*Your penis*/
						<<if wearingCondom("player")>>
							<<if $penisstate is "entrance" or $penisstate is "imminent" or $penisstate is "otheranusentrance" or $penisstate is "otheranusimminent">>
								<<if ($NPCList[$mouthtarget].vagina is "penis" or $NPCList[$mouthtarget].penis is "otheranus")>>
									<<personselect $mouthtarget>>
									<span class="green"><<He_Short>> rolls <<condomDesc "player" "the">> off your penis.</span>
									<<removeNPCCondom $mouthtarget "player">>
								<</if>>
							<</if>>
							<<if $penisstate is "penetrated">>
								<<if $NPCList[$mouthtarget].vagina is "penis">>
									<<personselect $mouthtarget>>
									<span class="green"><<He_Short>> briefly frees your penis from <<his>> vagina, rolls off <<condomDesc "player" "the">>, and slides it back in.</span>
									<<removeNPCCondom $mouthtarget "player">>
								<</if>>
							<</if>>
							<<if $penisstate is "otheranus">>
								<<if $NPCList[$mouthtarget].penis is "otheranus">>
									<<personselect $mouthtarget>>
									<span class="green"><<He_Short>> briefly frees your penis from <<his>> ass, rolls off <<condomDesc "player" "the">>, and slides it back in.</span>
									<<removeNPCCondom $mouthtarget "player">>
								<</if>>
							<</if>>
						<</if>>
						/*Their penis*/
						<<if $vaginastate is "entrance" or $vaginastate is "imminent" or $vaginastate is "doubleentrance" or $vaginastate is "doubleimminent">>
							<<if ($NPCList[$mouthtarget].penis is "vaginaentrance" or $NPCList[$mouthtarget].penis is "vaginaimminent" or $NPCList[$mouthtarget].penis is "vaginaentrancedouble" or $NPCList[$mouthtarget].penis is "vaginadoubleimminent") and wearingCondom($mouthtarget)>>
								<<personselect $mouthtarget>>
								<span class="green"><<He_Short>> rolls <<condomDesc $mouthtarget "the">> off <<his>> penis.</span>
								<<removeNPCCondom $mouthtarget>>
							<</if>>
						<</if>>
						<<if $vaginastate is "penetrated" or $vaginastate is "doublepenetrated">>
							<<if ($NPCList[$mouthtarget].penis is "vagina" or $NPCList[$mouthtarget].penis is "vaginadouble") and wearingCondom($mouthtarget)>>
								<<personselect $mouthtarget>>
								<span class="green"><<He_Short>> briefly withdraws <<his>> penis from your vagina, rolls off <<condomDesc $mouthtarget "the">>, and slides it back in.</span>
								<<removeNPCCondom $mouthtarget>>
							<</if>>
						<</if>>
						<<if $anusstate is "entrance" or $anusstate is "imminent" or $anusstate is "doubleentrance" or $anusstate is "doubleimminent">>
							<<if ($NPCList[$anustarget].penis is "anusentrance" or $NPCList[$mouthtarget].penis is "anusimminent" or $NPCList[$mouthtarget].penis is "anusdoubleentrance" or $NPCList[$mouthtarget] is "anusdoubleimminent") and wearingCondom($mouthtarget)>>
								<<personselect $mouthtarget>>
								<span class="green"><<He_Short>> rolls <<condomDesc $mouthtarget "the">> off <<his>> penis.</span>
								<<removeNPCCondom $mouthtarget>>
							<</if>>
						<</if>>
						<<if $anusstate is "penetrated" or $anusstate is "doublepenetrated">>
							<<if ($NPCList[$mouthtarget].penis is "anus" or $NPCList[$mouthtarget].penis is "anusdouble") and wearingCondom($mouthtarget)>>
								<<personselect $mouthtarget>>
								<span class="green"><<He_Short>> briefly withdraws <<his>> penis from your anus, rolls off <<condomDesc $mouthtarget "the">>, and slides it back in.</span>
								<<removeNPCCondom $mouthtarget>>
							<</if>>
						<</if>>
					<</if>>
				<<else>>
					<<if $consensual is 1>>
						<<set $consensual to 0>>
						<<molested>><<controlloss>>
					<</if>>
					<<set _response to [
						"Stupid slut, you think you can tell me what to do?",
						"You're not in charge here, slut.",
						"I'll do what I want, slut."
					]>>
					<<He_Short>> pauses a moment before responding,
					"<span class="red"><<print _response.pluck()>></span>"
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "askPullOut">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<personselect $mouthtarget>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "tell <<him>> to pull out">>
			<<else>>
				<<set $pullOutAsk to true>>
				<<set $_npcn to $npc[$npcrow.indexOf($mouthtarget)]>>
				<<if $consensual is 0>>
					<<set $_pullOutAskBaseDifficulty to 1500 + 10 * (100 - $NPCList[$mouthtarget].pregnancyAvoidance)>>
				<<else>>
					<<set $_pullOutAskBaseDifficulty to 1000 + 5 * (100 - $NPCList[$mouthtarget].pregnancyAvoidance)>>
				<</if>>
				<<if $NPCList[$mouthtarget].pregnancyAvoidance gte 90 or $_npcn is "Kylar">><<set $_checkSkip to true>><</if>>
				<<set $mouthactiondefault to "rest">><<if !$gloryhole and $gamemode isnot "soft" and !$_checkSkip>><<seductionskillusecombat>><</if>>
				<<brat `Math.floor((100 - $NPCList[$mouthtarget].pregnancyAvoidance) / 20)`>>
				You ask <<combatperson>> to pull out and finish outside.
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif $npc[$npcrow.indexOf($mouthtarget)] is "Kylar">>
					<<He_Short>> freezes for a moment. <span class="red">"No, my love."</span>
				<<elseif combatSkillCheck("seduction", $mouthtarget, $_pullOutAskBaseDifficulty) or $gamemode is "soft" or $gloryhole or $_checkSkip>>
					<<set $pullOut to true>>
					<<if $consensual is 0>>
						<<He_Short>> pauses a moment before responding.
						<<set _response to [
							"Sure thing, slut.",
							"Fine, but I expect you to cooperate.",
							"Good idea, I don't want any evidence traced back to me."
						]>>
						<span class="green">"<<print _response.pluck()>>"</span>
					<<else>>
						<span class="green"><<He_Short>> nods in acknowledgement.</span>
					<</if>>
				<<else>>
					<<if $consensual is 1>>
						<<set $consensual to 0>>
						<<molested>><<controlloss>>
					<</if>>
					<<set _response to [
						"Stupid slut, you think you can tell me what to do?",
						"You're not in charge here, slut.",
						"I'll do what I want, slut."
					]>>
					<<if $pregnancyspeechdisable is "f" and $NPCList[$mouthtarget].penis is "vagina" and playerPregnancyPossibleWith($NPCList[$mouthtarget])>>
						<<run _response.pushUnique(
							"You should feel lucky if I knock you up.",
							"Maybe I should just put a baby in you now.",
							"I could make you have my kids, and you wouldn't be able to do a damn thing."
						)>>
					<</if>>
					<<He_Short>> pauses a moment before responding,
					<span class="red">"<<print _response.pluck()>>"</span>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "pay">>
			<<set $mouthaction to 0>><<set $mouthactiondefault to "rest">>
			<<if $money gte $rentmoney + ($babyRent or 0)>>
				<<set $speechpay to 1>>
				<<if $speech_attitude is "meek">>
					"S-stop!" you shout. "I'll pay you, so... j-just let Robin go."
				<<elseif $speech_attitude is "bratty">>
					"I'll pay you," you say through gritted teeth. "So get your hands off <<nnpc_him "Robin">>."
				<<else>>
					"Let go of <<nnpc_him "Robin">>!" you shout. "I have your money. I'll pay."
				<</if>>
			<<else>>
				<<set $speechpay to -1>>
				<<if $speech_attitude is "meek">>
					"S-stop!" you shout. "I don't have enough, b-but... just let <<nnpc_him "Robin">> go, please!"
				<<elseif $speech_attitude is "bratty">>
					"I don't have enough," you say through gritted teeth. "So get your hands off <<nnpc_him "Robin">>."
				<<else>>
					"Let go of <<nnpc_him "Robin">>!" you shout. "I don't have your money. I can't pay."
				<</if>>
			<</if>>
			<<control -10>><<lcontrol>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "wearStrapon">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "ask <<him>> to wear <<his>> strap-on">><<meek 1>>
			<<else>>
				<<brat 5>>
				<<set $mouthactiondefault to "rest">>
				You ask <<him>> to wear <<his>> strap-on.
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif ($npc[$npcrow.indexOf(_n)] is "Eden" and $NPCName[$NPCNameList.indexOf("Eden")].love lte 100)
				or ($npc[$npcrow.indexOf(_n)] is "Whitney" and $NPCName[$NPCNameList.indexOf("Whitney")].love lte 10)>>
					<<print either("I'll do what I want, bitch.","Shut up slut, I'm in control here.")>>
					<<violence 5>><<brat 2>>
				<<else>>
					<<personselect $mouthtarget>>
					<<He>> nods and moves to don <<his>> strap-on.
					<<npcstrapon $mouthtarget>>
					<<set $NPCList[$mouthtarget].penis to "strap-on">>
				<</if>>
			<</if>>
		<</if>>

		<<if $mouthaction is "ask" and $askAction is "removeStrapon">>
			<<set $mouthaction to 0>><<unset $askAction>><<set _sound to 1>>
			<<if $neckuse is "hand" and $oxygen lt $oxygenmax and $asphyxiaLvl gte 2>>
				<<wheeze "ask <<him>> to remove <<his>> strap-on">><<brat 1>>
			<<else>>
				<<brat 5>><<set $mouthactiondefault to "rest">>
				You ask <<personselect $mouthtarget>><<combatperson>> to remove <<his>> strap-on.
				<<if $role is "islander" and (!$islander_language or $islander_language lt 100)>>
					<span class="red"><<if $enemyno gte 2>>They don't<<else>><<He>> doesn't<</if>> understand your words,</span> and <<if $enemyno gte 2>>ignore<<else>>ignores<</if>> them.
				<<elseif !$gloryhole and $gamemode isnot "soft">><<seductionskillusecombat>><</if>>
				<<if (1000 - ($rng * 10) - ($enemytrust * 10) - currentSkillValue("seductionskill") + $enemyanger) lte (($enemyarousalmax / ($enemyarousal + 1)) * 100) or $gamemode is "soft" or $gloryhole>>
					<<He>> nods and removes <<his>> $NPCList[$mouthtarget].penisdesc.

					/* Remove their strap-on. If they have a penis, give them back their penis. */
					<<set $_npcname to $npc[$npcrow.indexOf($mouthtarget)]>>
					<<set $_npctarget to $NPCName[$NPCNameList.indexOf($_npcname)]>>
					<<if ["Robin","Kylar","Alex","Avery","Whitney","Eden","Sydney"].includes($_npcname) and $_npctarget.penis isnot "none">>
						<<set $NPCList[$mouthtarget].penisdesc to $_npctarget.penisdesc>><<set $NPCList[$mouthtarget].penis to 0>>
					<<else>>
						<<set $NPCList[$mouthtarget].penis to "none">><<set $NPCList[$mouthtarget].vagina to 0>>
					<</if>>
					<<set $NPCList[$mouthtarget].strapon.state to "removed">>
				<<else>>
					<<if $consensual is 1>>
						<<set $consensual to 0>>
						<<molested>><<controlloss>>
					<</if>>
					They pause a moment before responding. <span class="red">"Stupid slut, you think you can tell me what to do?"</span>
				<</if>>
			<</if>>
		<</if>>
		
		/* 北极星模组 */
		<<if $mouthaction is "dragonBreath">>
			<<set $mouthactiondefault to "dragonBreath">><<set $mouthaction to 0>>
			<<set $enemyhealth -= 200>>
			<<set _npctodefeat to []>>
			<<for _npctodamage to 0; _npctodamage lt $enemynomax; _npctodamage++>>
    			<<if $NPCList[_npctodamage].active is "active" and $NPCList[_npctodamage].stance isnot "defeated" and (!$fightTargets or $fightTargets.includes(_npctodamage))>>
    				<<set _enemydivide to $fightTargets ? $enemyno-$fightTargets.length : $enemyno>>
    				<<set $NPCList[_npctodamage].health -= (200/_enemydivide)>>
    				<<if $enemyno gte 2 and $NPCList[_npctodamage].health lte 0>>
    					<<set _npctodefeat.push(_npctodamage)>>
    				<</if>>
    			<</if>>
    		<</for>>
    		<<for $_defeatcontroller to 0; $_defeatcontroller lt _npctodefeat.length; $_defeatcontroller++>>
    			<<if $enemyno gte 2>>
    			    <<defeatnpc _npctodefeat[$_defeatcontroller]>>
    			<</if>>
    		<</for>>
			<<if $dragonbreathuse is undefined>>
				<<set $dragonbreathuse to 0>>
			<</if>>
			<<set $dragonbreathuse += 1>><<set $speechdragonbreath to 1>>
			<<if $enemytype is "beast">>
				<span class='gold'>你向着<<beasttype>>喷射龙息。它呜咽了起来。</span>
			<<elseif $enemyno gte 2>>
				<span class='gold'>你向着<<group>>喷射龙息。他们痛苦地后退。</span>
				<<if !$npc.includes("Eden") and !$npc.includes("Morgan") and !$npc.includes("Kylar") and !$npc.includes("Ivory Wraith") and !$abomination>>
					<<ggcrime "assault">><<crimeUp 500 "assault">>
				<</if>>
			<<else>>
				<span class='gold'>你向着袭击者喷射龙息。<<He>>痛苦地后退。</span>
				<<if !$npc.includes("Eden") and !$npc.includes("Morgan") and !$npc.includes("Kylar") and !$npc.includes("Ivory Wraith") and !$abomination>>
					<<ggcrime "assault">><<crimeUp 500 "assault">>
				<</if>>
			<</if>>
		<</if>>
		/* 北极星 */

		/*Stalked actions */
		<<if !$stalk_end>>
			<<if $mouthaction is "up">>
				<<set $mouthaction to 0>><<set $mouthactiondefault to "up">>
				<<if $control gte 100>>
					You keep your chin up, and head proud.
				<<elseif $control gte 80>>
					You keep you head up and eyes focused on the path ahead.
				<<elseif $control gte 60>>
					You keep your eyes fixed on the path ahead.
				<<elseif $control gte 40>>
					You keep your eyes ahead, resisting the urge to look around for threats.
				<<elseif $control gte 20>>
					You keep your head up, your eyes searching the path ahead for danger.
				<<else>>
					You keep your head up, but close your eyes in fear.
				<</if>>
				<<brat 3>>
			<</if>>

			<<if $mouthaction is "down">>
				<<set $mouthaction to 0>><<set $mouthactiondefault to "down">>
				<<if $control gte 100>>
					You look at the ground in front of you.
				<<elseif $control gte 80>>
					You watch the ground in front of you.
				<<elseif $control gte 60>>
					You keep your head down, hoping not to be noticed.
				<<elseif $control gte 40>>
					You keep your head down, and hope nothing is watching.
				<<elseif $control gte 20>>
					You keep your head down, and tell yourself the path is safe.
				<<else>>
					You bow your head in fear.
				<</if>>
				<<meek 3>>
			<</if>>

			<<if $mouthaction is "turn">>
				<<set $mouthaction to 0>><<set $mouthactiondefault to "turn">>
				You glance over your shoulder.
				<<if $stalk_assess>>
					<<if $npcrow.includes(0)>>
						<<if $NPCList[0].fullDescription is "Ivory Wraith">>
							<<if $wraith.state is "haunt" or $wraith.offspring is "dead">>
								The pale figure continues to stalk you.
							<<else>>
								The pale figure continues to drift along.
							<</if>>
						<<else>>
							<<print $NPCList[0].fullDescription>> is still following you.
						<</if>>
					<<else>>
						The <<person1>><<person>> is still following you.
					<</if>>
				<<else>>
					<<if $npcrow.includes(0)>>
						<<if $NPCList[0].fullDescription is "Ivory Wraith">>
							<<if $wraith.state is "haunt" or $wraith.offspring is "dead">>
								A<<if $wraith.seen gte 3>> familiar<</if>> pale figure lurks behind you, <span class="red">its eerie <<wraithEyes>> gaze locked on you.</span>
							<<else>>
								A<<if $wraith.seen gte 3>> familiar<</if>> pale figure drifts behind you, seeming unaware of your presence.
							<</if>>
							Its feet don't touch the ground, but you still hear footsteps.
						<<else>>
							You see a <<person1>><<personsimple>> following you. <span class="pink">It's <<print $NPCList[0].fullDescription>>.</span>
						<</if>>
					<<else>>
						You see a <<person1>><<person>> following you.
					<</if>>
				<</if>>
				<<if $npcrow.includes(0)>>
					<<if $NPCList[0].fullDescription is "Ivory Wraith">>
						It
					<<else>>
						<<nnpc_He $NPCList[0].fullDescription>>
					<</if>>
				<<else>>
					<<He>>
				<</if>>
				moves with
				<<if $NPCList[0].skills.athletics gte 800>>
					<span class="pink">an energetic stride</span>
				<<elseif $NPCList[0].skills.athletics gte 600>>
					<span class="purple">a motivated pace</span>
				<<elseif $NPCList[0].skills.athletics gte 400>>
					<span class="blue">a calm gait</span>
				<<elseif $NPCList[0].skills.athletics gte 200>>
					<span class="lblue">a lazy ramble</span>
				<<else>>
					<span class="teal">a slothful shuffle</span>
				<</if>>
				and
				<<if $NPCList[0].skills.security gte 800>>
					<span class="pink">has a devious glint in <<his>> eyes.</span>
				<<elseif $NPCList[0].skills.security gte 600>>
					<span class="purple">looks focused.</span>
				<<elseif $NPCList[0].skills.security gte 400>>
					<span class="blue">looks relaxed.</span>
				<<elseif $NPCList[0].skills.security gte 200>>
					<span class="lblue">seems distracted.</span>
				<<else>>
					<span class="teal">appears to be daydreaming.</span>
				<</if>>
				<<if $enemyno is 2>>
					A <<person2>><<person>> follows <<person1>><<him>>.
				<<elseif $enemyno gte 3>>
					<<switch $enemyno>>
						<<case 6>>Five
						<<case 5>>Four
						<<case 4>>Three
						<<case 3>>Two
					<</switch>>
					others follow <<him>>.
				<</if>>
				<<set $stalk_assess to true>>
			<</if>>
		<</if>>

		/*End of stalked actions */

		/***
		*    ███████ ██   ██ ███████ ███████ ██   ██
		*    ██   ██ ██   ██ ██      ██       ██ ██
		*    ███████ ██   ██ ███████ ███████   ███
		*    ██      ██   ██      ██      ██   ███
		*    ██       █████  ███████ ███████   ███
		*
		*/
		<<if $newtarget isnot undefined>>
			<<setnewtarget>>
		<</if>>

		<<rng>>

		<<if $vaginaaction is "penisthighs" and $NPCList[$vaginatarget].penis is "vaginaentrance">>
			<<set $vaginaaction to 0>><<meek 1 $vaginatarget>><<thighskilluse>><<set $vaginaactiondefault to "penisthighs">><<combatpromiscuity4>>
			<<if combatSkillCheck("thigh", $vaginatarget)>>
				<<set $thighactiondefault to "rub">>
				<<personselect $vaginatarget>>
				<span class="lblue">You <<thightext>> grab <<hisselect $vaginatarget>> $NPCList[$vaginatarget].penisdesc between your thighs.</span>
				<<set $NPCList[$vaginatarget].penis to "thighs">><<set $thightarget to $vaginatarget>>
				<<set $vaginause to 0>><<set $thighuse to "penis">><<thighstat>><<sex 5 "genitals" $vaginatarget>><<set $vaginastate to 0>>
			<<else>>
				You try to hold <<hisselect $vaginatarget>> penis between your thighs, but <<he>> is intent on your pussy.
			<</if>>
		<</if>>

		<<rng>>
		<<effectsvaginatopenis>>
		<<rng>>
		<<effectsvaginatovagina>>
		<<rng>>
		<<effectsvaginapenisfuck>>
		<<rng>>
		<<effectsvaginatovaginafuck>>
		<<rng>>
		<<effectsvaginapenisdoublefuck>>
		<<rng>>
		<<effectsvaginatopenisdouble>>

		<<if $vaginaaction is "rest">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "rest">>
		<</if>>
		/* 北极星模组 */
		<<if $vaginaaction is "endure">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "endure">>
			<span class="lblue">你<<vaginaltext>>忍耐着小穴传来的快感。</span>
		    <<set $arousal -= Math.trunc(200 + $vaginalskill)>><<vaginalskill 5>><<set $vaginalskillup to 1>>
		<</if>>
		/* 北极星 */

		<<rng>>

		<<if $vaginaaction is "penisanus" and $NPCList[$vaginatarget].penis is "vaginaentrance">>
			<<if $anusstate isnot 0 and $anusstate is "entrance" or $anusstate is "imminent">>
				<<if $analdoubledisable is "f">>
					<<set $vaginaaction to "penisanusdouble">>
				<<else>>
					You give your <<bottom>> a little wiggle, but receive a slap.
					<<violence 2>><<hitstat>><<bruise bottom>>
				<</if>>
			<<elseif $anusstate isnot 0 and $anusstate.includes("double")>>
				You give your <<bottom>> a little wiggle, but receive a slap. "Settle down, <<bitch>>."
				<<violence 2>><<hitstat>><<bruise bottom>>
			<<else>>
				<<set $vaginaaction to 0>><<meek 5 $vaginatarget>><<analskilluse>><<set $vaginaactiondefault to "penisanus">>
				<<if combatSkillCheck("anal", $vaginatarget)>>
					<<personselect $vaginatarget>>
					<span class="blue">You give your <<bottom>> a little wiggle, <<combatperson>> responds to the provocation and moves <<his>> <<npcPenisSimple $vaginatarget>> in front of your butt.</span>
					<<if $NPCList[$vaginatarget].type is "plant" and $NPCList[$vaginatarget].penissize gte 4 and canImpregnateParasite("vagina")>>
						<span class="red">Something about it scares you.</span>
					<</if>>
					<<submission 2>><<set $anususe to "penis">><<set $NPCList[$vaginatarget].penis to "anusentrance">><<set $vaginause to 0>><<set $anusstate to "entrance">><<set $vaginastate to 0>>
				<<else>>
					You give your <<bottom>> a little wiggle, but you just receive a slap.
					<<violence 2>><<hitstat>><<bruise bottom>>
				<</if>>
			<</if>>
		<</if>>

		<<rng>>
		<<if $vaginaaction is "penisanusdvp">>
			<<if $anusstate isnot 0 and $anusstate is "entrance" or $anusstate is "imminent">>
				<<if $analdoubledisable is "f" and random(0,2) isnot 0 and $awareness gte 300>>
					<<set $vaginaaction to "penisanusdouble">>
				<<else>>
					You give your <<bottom>> a little wiggle, but receive a slap.
					<<violence 2>><<hitstat>><<bruise bottom>>
				<</if>>
			<<elseif $anusstate isnot 0 and $anusstate.includes("double")>>
				You give your <<bottom>> a little wiggle, but receive a slap. "Settle down, <<bitch>>."
				<<violence 2>><<hitstat>><<bruise bottom>>
			<<else>>
				<<set $vaginaaction to 0>><<meek 5>><<analskilluse>><<set $vaginaactiondefault to "penisanusdvp">>
				<<set _npcA to ($NPCList[$vaginatarget].penis is "vaginaentrancedouble" ? $vaginatarget : $vaginadoubletarget)>>
				<<set _npcB to ($NPCList[$vaginatarget].penis is "vaginaentrancedouble" ? $vaginadoubletarget : $vaginatarget)>>

				<<if combatSkillCheck("anal", _npcA)>>

					<<if $NPCList[_npcB].penis is "vaginadouble">>
						<<set $NPCList[_npcB].penis to "vagina">>
						<<set $vaginastate to "penetrated">>
					<<elseif $NPCList[_npcB].penis is "vaginaimminentdouble">>
						<<set $NPCList[_npcB].penis to "vaginaimminent">>
						<<set $vaginastate to "imminent">>
					<<elseif $NPCList[_npcB].penis is "vaginaentrancedouble">>
						<<set $NPCList[_npcB].penis to "vaginaentrance">>
						<<set $vaginastate to "entrance">>
					<</if>>
					<<personselect _npcA>>
					<span class="blue">You give your <<bottom>> a little wiggle, <<combatperson>> responds to the provocation and moves <<his>> penis in front of your butt.</span>
					<<if $NPCList[_npcA].type is "plant" and $NPCList[_npcA].penissize gte 4 and canImpregnateParasite("anus")>>
						<span class="red">Something about it scares you.</span>
					<</if>>
					<<submission 2>><<set $anususe to "penis">><<set $NPCList[_npcA].penis to "anusentrance">><<set $vaginause to "penis">><<set $anusstate to "entrance">>

				<<else>>
					You give your <<bottom>> a little wiggle, but you just receive a slap.
					<<violence 2>><<hitstat>><<bruise bottom>>
				<</if>>
			<</if>>
		<</if>>

		<<rng>>
		<<if $vaginaaction is "penisanusdouble">>
			<<set $vaginaaction to 0>><<meek 5 $vaginatarget>><<analskilluse>>
			<<if combatSkillCheck("anal", $vaginatarget) and $anususe is "penis">>
				<<personselect $vaginatarget>><<set $vaginaactiondefault to "rest">>
				<span class="blue">You give your <<bottom>> a little wiggle, <<combatperson>> responds to the provocation and moves <<his>> penis to join the phallus in front of your butt.</span>
				<<submission 2>>
				<<set $anususe to "penisdouble">><<set $anusstate to "doubleentrance">><<set $vaginause to 0>><<set $vaginastate to 0>>
				<<set $NPCList[$vaginatarget].penis to "anusentrancedouble">>
				<<set $anusdoubletarget to $vaginatarget>>
				<<if $NPCList[$anustarget].penis is "anus">>
					<<set $NPCList[$anustarget].penis to "anusdouble">>
					<<set $anusstate to "doublepenetrated">>
				<<elseif $NPCList[$anustarget].penis is "anusimminent">>
					<<set $NPCList[$anustarget].penis to "anusimminentdouble">>
					<<set $anusstate to "doubleimminent">>
				<<elseif $NPCList[$anustarget].penis is "anusentrance">>
					<<set $NPCList[$anustarget].penis to "anusentrancedouble">>
					<<set $anusstate to "doubleentrance">>
				<<elseif $NPCList[$anustarget].penis is "cheeks">>
					<<set $NPCList[$anustarget].penis to "anusentrance">>
					<<set $bottomuse to 0>> /* Issues with ass cheeks likely stem from this culprit right here */
				<</if>>
				<<set $NPCList[$anustarget].location.genitals to "genitals">>
			<<else>>
				You give your <<bottom>> a little wiggle, but you just receive a slap.
				<<violence 2>><<hitstat>><<bruise bottom>><<set $vaginaactiondefault to "penisanusdouble">>
			<</if>>
		<</if>>

		<<if $vaginaaction is "penistease">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "penistease">><<actionspenistip $vaginatarget>><<sex 5 "genitals" $vaginatarget>><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "penisdoubletease">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "penistease">><<actionspenisdoubletip>><<sex 5 "genitals" $vaginatarget>><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "doublecooperate">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "doublecooperate">><<actionspenisdoubleride>><<submission 20>><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "penisDoubleEdging">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "penisDoubleEdging">><<actionspenisdoubleedging>><<submission 5>><<sexControl 5 `currentSkillValue("vaginalskill")`>><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "doubletake">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "doubletake">><<actionspenisdoubletake>>
		<</if>>

		<<if $vaginaaction is "rub">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "rub">><<actionspenisrub $vaginatarget>><<sex 10 "genitals" $vaginatarget>><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "cooperate">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "cooperate">><<actionspenisride $vaginatarget>><<submission 20>><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "penisEdging">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "penisEdging">><<actionspenisedging $vaginatarget>><<submission 5>><<sexControl 5 `currentSkillValue("vaginalskill")` $vaginatarget>><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "take">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "take">><<actionspenistake $vaginatarget>>
		<</if>>

		<<if $vaginaaction is "tribtease">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "tribtease">><<actionstribtease $vaginatarget>><<sex 10 "genitals">><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "tribcooperate">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "tribcooperate">><<actionstribcooperate $vaginatarget>><<submission 20>><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "tribtake">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "tribtake">><<actionstribtake $vaginatarget>>
		<</if>>

		<<if $vaginaaction is "tribedge">>
			<<personselect $vaginatarget>><<actionstribedge $vaginatarget>><<set $vaginaaction to 0>><<set $vaginaactiondefault to "tribedge">>
			<<submission 5>><<sexControl 5 `currentSkillValue("vaginalskill")` $vaginatarget>><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "tribrest">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "rest">>
		<</if>>

		<<if $vaginaaction is "tribescape">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "tribescape">><<actionstribescape $vaginatarget>><<brat 10 $vaginatarget>>
			<<if $vaginastate is "othervagina">>
				<<set $vaginastate to "othervaginaimminent">>
			<<else>>
				<<set $vaginastate to "othervaginaentrance">>
			<</if>>
			<<if $NPCList[$vaginatarget].vagina is "vagina">>
				<<set $NPCList[$vaginatarget].vagina to "vaginaimminent">>
			<<elseif $NPCList[$vaginatarget].vagina is "vaginaimminent">>
				<<set $NPCList[$vaginatarget].vagina to "vaginaentrance">>
			<</if>>
		<</if>>

		<<if $vaginaaction is "escape" and $NPCList[$vaginatarget].penis is "vaginaimminent">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "escape">><<actionsvaginaescape $vaginatarget>><<set $vaginause to "penis">><<set $vaginastate to "entrance">>
			<<set $NPCList[$vaginatarget].penis to "vaginaentrance">><<set $NPCList[$vaginatarget].speechvaginaescape to 1>>
			<<if $NPCList[$vaginatarget].penissize gte 5>>
				<<brat 35 $vaginatarget>>
			<<elseif $NPCList[$vaginatarget].penissize is 4>>
				<<brat 30 $vaginatarget>>
			<<elseif $NPCList[$vaginatarget].penissize is 3>>
				<<brat 25 $vaginatarget>>
			<<elseif $NPCList[$vaginatarget].penissize is 2>>
				<<brat 20 $vaginatarget>>
			<<elseif $NPCList[$vaginatarget].penissize is 1>>
				<<brat 15 $vaginatarget>>
			<<else>>
				<<brat 10 $vaginatarget>>
			<</if>>
		<</if>>

		<<if $vaginaaction is "doubleescape">>
			<<set $vaginaaction to 0>>
			<<set $vaginaactiondefault to "doubleescape">><<actionsvaginadoubleescape>><<brat 10>><<set $vaginause to "penisdouble">><<set $vaginastate to "doubleentrance">>
			<<set $enemyanger += 5>>
			<<set _otherNPCindex to "f">>
			<<set _actiontext to "You escape ">>
			<<set _npcA to $vaginatarget>>
			<<set _npcB to $vaginadoubletarget>>

			<<if $NPCList[_npcA].penis is "vaginaimminentdouble">>
				<<set $NPCList[_npcA].penis to "vaginaentrancedouble">><<set $NPCList[_npcA].speechvaginaescape to 1>>

			<<elseif $NPCList[_npcA].penis is "vaginaentrancedouble" and random(0,3) is 0>> /* Chance to drop one of them and switch to regular anal */
				<<set _otherNPCindex to _npcB>><<set $NPCList[_npcA].location.genitals to 0>><<set $NPCList[_npcA].speechvaginaescape to 1>><<set $enemyanger += 15>>
				<<set $NPCList[_npcA].penis to 0>>
				<span class="green"> <<print _actiontext + ($npc_named isnot 1 ? "the " : "") + $NPCList[_npcA].fullDescription + "'s " + $NPCList[_npcA].penisdesc + ".">></span>
			<</if>>
			<<if $NPCList[_npcB].penis is "vaginaimminentdouble">>
				<<set $NPCList[_npcB].penis to "vaginaentrancedouble">><<set $NPCList[_npcB].speechvaginaescape to 1>>

			<<elseif $NPCList[_npcB].penis is "vaginaentrancedouble" and random(0,3) is 0>> /* Chance to drop one of them and switch to regular vaginal */
				<<set _otherNPCindex to _npcA>><<set $NPCList[_npcB].location.genitals to 0>><<set $NPCList[_npcB].speechanusescape to 1>><<set $enemyanger += 15>>
				<<set $NPCList[_npcB].penis to 0>>
				<span class="green"> <<print _actiontext + ($npc_named isnot 1 ? "the " : "") + $NPCList[_npcB].fullDescription + "'s " + $NPCList[_npcB].penisdesc + ".">></span>
			<</if>>

			<<if _otherNPCindex isnot "f" and $NPCList[_otherNPCindex].penis isnot 0 and $NPCList[_otherNPCindex].penis.includes("double")>>
				<<set $vaginause to "penis">>
				<<switch $NPCList[_otherNPCindex].penis>>
					<<case "vaginadouble">>
						<<set $NPCList[_otherNPCindex].penis to "vagina">>
						<<set $vaginastate to "penetrated">>
					<<case "vaginaentrancedouble">>
						<<set $NPCList[_otherNPCindex].penis to "vaginaentrance">>
						<<set $vaginastate to "entrance">>
					<<case "vaginaimminentdouble">>
						<<set $NPCList[_otherNPCindex].penis to "vaginaimminent">>
						<<set $vaginastate to "imminent">>
				<</switch>>
			<</if>>
		<</if>>

		<<if $vaginaaction is "thighbay" and $NPCList[$vaginatarget].mouth is "vaginaentrance">>
			<<set $vaginaaction to 0>><<meek 1 $vaginatarget>><<thighskilluse>><<set $vaginaactiondefault to "thighbay">><<combatpromiscuity1>>
			<<if combatSkillCheck("thigh", $vaginatarget)>>
				<<set $thighactiondefault to "othermouthrub">>
				<<personselect $vaginatarget>>
				<span class="lblue">You <<thightext>> press your thigh against <<hisselect $vaginatarget>> mouth.</span>
				<<set $NPCList[$vaginatarget].mouth to "thigh">><<set $vaginause to 0>><<thighstat>><<neutral 5 $vaginatarget>><<set $vaginastate to 0>><<set $thighuse to "mouth">>
			<<else>>
				You try to keep the mouth menacing your <<pussy>> at bay by pressing your thigh against it, but <<theowner>> has other ideas.
			<</if>>
		<</if>>

		<<if $vaginaaction is "othervaginarub">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "othervaginarub">><<actionsothervaginavaginarub $vaginatarget>><<sex 10 "genitals">><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "othermouthtease">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "othermouthtease">><<actionsothermouthvaginatease $vaginatarget>><<sex 5 "genitals">><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "othermouthrub">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "othermouthrub">><<actionsothermouthvaginarub $vaginatarget>><<sex 10 "genitals">><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "othermouthcooperate">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "othermouthcooperate">><<actionsothermouthvaginathrust $vaginatarget>><<submission 20>><<vaginalskilluse>>
		<</if>>

		<<if $vaginaaction is "othermouthescape">>
			<<set $vaginaaction to 0>><<set $vaginaactiondefault to "othermouthescape">><<actionsothermouthvaginaescape $vaginatarget>><<brat 10 $vaginatarget>>
			<<set $vaginause to "othermouth">><<set $vaginastate to "othermouthentrance">>
			<<if $NPCList[$vaginatarget].mouth is "vaginaimminent">>
				<<set $NPCList[$vaginatarget].mouth to "vaginaentrance">>
			<</if>>
		<</if>>

		/***
		*      ███   ██   ██ ██   ██ ███████
		*     ██ ██  ███  ██ ██   ██ ██
		*    ██   ██ ██ █ ██ ██   ██ ███████
		*    ███████ ██  ███ ██   ██      ██
		*    ██   ██ ██   ██  █████  ███████
		*
		*/
		<<if $newtarget isnot undefined>>
			<<setnewtarget>>
		<</if>>

		<<rng>>

		<<if $anusaction is "rest">>
			<<set $anusaction to 0>><<set $anusactiondefault to "rest">>
		<</if>>

		/*Stalked actions */
		<<if !$stalk_end>>
			<<if $anusaction is "wiggle">>
				<<set $anusaction to 0>><<set $anusactiondefault to "wiggle">>
				<<if currentSkillValue('seductionskill') gte random(1, 1000)>>
					<<meek 2>>
					<<if $rng gte 81>>
						You wiggle your <<bottom>> in time with your steps,
					<<elseif $rng gte 61>>
						You sway your <<bottom>>,
					<<elseif $rng gte 41>>
						You shake your <<bottom>>,
					<<elseif $rng gte 21>>
						You add some bounce to your steps, lifting your <<bottom>> and
					<<else>>
						You emphasise your <<bottom>> with each step,
					<</if>>
					drawing attention to it.
				<<else>>
					<<meek 1>>
					<<if $rng gte 81>>
						You wiggle your <<bottom>>.
					<<elseif $rng gte 61>>
						You sway your <<bottom>>.
					<<elseif $rng gte 41>>
						You shake your <<bottom>>.
					<<elseif $rng gte 21>>
						You bounce your <<bottom>>.
					<<else>>
						You put emphasis on your <<bottom>>.
					<</if>>
				<</if>>
			<</if>>
		<</if>>
		/*End of stalked actions */

		<<if $anusaction is "penischeeks" and $NPCList[$anustarget].penis is "anusentrance">>
			<<set $anusaction to 0>><<meek 1 $anustarget>><<bottomskilluse>><<set $anusactiondefault to "penischeeks">><<combatpromiscuity4>>
			<<if combatSkillCheck("bottom", $anustarget)>>
				<<set $cheekactiondefault to "rub">>
				<<personselect $anustarget>>
				<<set $NPCList[$anustarget].penis to "cheeks">><<bottomstat>><<submission 2>><<set $bottomuse to "penis">><<set $anususe to "penis">><<set $anusstate to "cheeks">>
				<span class="lblue">You <<bottomtext>> grab <<hisselect $anustarget>> $NPCList[$anustarget].penisdesc between your butt cheeks.</span>
			<<else>>
				You try to grab <<hisselect $anustarget>> penis between your cheeks, but <<he>> isn't interested.
			<</if>>
		<</if>>

		<<rng>>

		<<if $anusaction is "penispussy">>
			<!-- Check the player is not attempting to straddle and offer pussy at the same time. If so, switch to double or fail correctly -->
			<<if $vaginastate isnot 0 and !$vaginastate.includes("double") and ($vaginastate is "entrance" or $vaginastate is "imminent" or $vaginastate is "penetrated")>>
				<!-- Note that this action requires "penispussydouble" to come after "penispussy", else it will not work as expected -->
				<<if random(0,2) isnot 0 and $vaginaldoubledisable is "f">>
					<<set $anusaction to "penispussydouble">>
				<<else>>
					You spread your thighs, but fail to garner further interest.
				<</if>>
			<<elseif $vaginastate isnot 0 and $vaginastate.includes("double")>>
				You spread your thighs, but just receive a slap. "Settle down, <<bitch>>."
				<<violence 2>><<hitstat>><<bruise bottom>>
			<<elseif $NPCList[$anustarget].penis is "anusentrance">>
				<<set $anusaction to 0>><<meek 10 $anustarget>><<analskilluse>><<set $anusactiondefault to "penispussy">>
				<<if combatSkillCheck("vaginal", $anustarget)>>
					<<personselect $anustarget>>
					<<submission 2>><<set $vaginause to "penis">><<set $NPCList[$anustarget].penis to "vaginaentrance">><<set $anususe to 0>><<set $vaginastate to "entrance">><<set $anusstate to 0>><<set $vaginatarget to $anustarget>><<set $anustarget to 0>>
					<span class="lblue">You spread your thighs, giving clear access to your pussy, and <<combatperson>> takes advantage and moves <<his>> penis away from your butt.</span>
				<<else>>
					You spread your thighs, but fail to garner interest.
				<</if>>
			<</if>>
		<</if>>

		<<if $anusaction is "penispussydap">>
			<!-- Check the player is not attempting to straddle and offer pussy at the same time. If so, switch to double or fail correctly -->
			<<if $vaginastate isnot 0 and !$vaginastate.includes("double") and $vaginastate is "entrance">>
				<!-- Note that this action requires "penispussydouble" to come after "penispussy", else it will not work as expected -->
				<<if random(0,2) isnot 0 and $vaginaldoubledisable is "f" and $awareness gte 300>>
					<<set $anusaction to "penispussydouble">>
				<<else>>
					You spread your thighs, but fail to garner further interest.
				<</if>>
			<<elseif $vaginastate isnot 0 and $vaginastate.includes("double")>>
				You spread your thighs, but just receive a slap. "Settle down, <<bitch>>."
				<<violence 2>><<hitstat>><<bruise bottom>>
			<<else>>
				<<set $anusaction to 0>><<meek 10 $anustarget>><<analskilluse>><<set $anusactiondefault to "penispussy">>
				<<set _npcA to ($NPCList[$anustarget].penis is "anusentrancedouble" ? $anustarget : $anusdoubletarget)>>
				<<set _npcB to ($NPCList[$anustarget].penis is "anusentrancedouble" ? $anusdoubletarget : $anustarget)>>

				<<if combatSkillCheck("vaginal", _npcA)>>
					<<set $NPCList[_npcB].penis to $NPCList[_npcB].penis.replace("double", "")>>
					<<set $anusstate to $anusstate.replace("double", "")>>
					<<personselect _npcA>>

					<<submission 2 _npcA>><<set $vaginause to "penis">><<set $NPCList[_npcA].penis to "vaginaentrance">><<set $anususe to "penis">><<set $vaginastate to "entrance">><<set $vaginatarget to _npcA>>
					<span class="lblue">You spread your thighs, giving clear access to your pussy, and <<combatperson>> takes advantage and moves <<his>> penis away from your butt.</span>
				<<else>>
					You spread your thighs, but fail to garner interest.
				<</if>>
			<</if>>
		<</if>>

		<<rng>>
		<<if $anusaction is "penispussydouble">>
			<<set $anusaction to 0>><<meek 10>><<analskilluse>><<set $anusactiondefault to "penispussydouble">>
			<<if combatSkillCheck("vaginal", $anustarget) and $vaginause is "penis">>
				<<selectNpcWithPartInPosition "penis" "anusentrance">>
				<<personselect _j>>
				<<submission 2 _j>><<set $vaginause to "penisdouble">><<set $NPCList[_j].penis to "vaginaentrancedouble">><<set $anususe to 0>><<set $vaginastate to "double" + $vaginastate>><<set $anusstate to 0>>
				<span class="lblue">You spread your thighs, giving clear access to your pussy, and <<combatperson>> takes advantage and moves <<his>> penis away from your butt to join the phallus in front of your pussy.</span>
				<<if $NPCList[_j].type is "plant" and $NPCList[_j].penissize gte 4 and canImpregnateParasite("vagina")>>
					<span class="red">Something about it scares you.</span>
				<</if>>

				<<set $vaginadoubletarget to _j>>
				<<unset _npc>>
				<<set _npc to $NPCList[$NPCList.findIndex(npc => npc.penis isnot 0 and npc.penis.includes("vagina") and !npc.penis.includes("double"))]>>
				<<set _npc.penis to _npc.penis + "double">>
			<<else>>
				You spread your thighs, but fail to garner interest.
			<</if>>
		<</if>>

		<<rng>>
		<<effectsanustopenis>>
		<<rng>>
		<<effectsanuspenisfuck>>
		<<rng>>
		<<effectsanustopenisdouble>>
		<<rng>>
		<<effectsanuspenisdoublefuck>>

		<<if $anusaction is "bottombay" and $NPCList[$anustarget].mouth is "anusentrance">>
			<<set $anusaction to 0>><<meek 1 $anustarget>><<bottomskilluse>><<set $anusactiondefault to "bottombay">><<combatpromiscuity1>>
			<<if combatSkillCheck("bottom", $anustarget)>>
				<<set $cheekactiondefault to "othermouthrub">>
				<<personselect $anustarget>>
				<span class="lblue">You <<bottomtext>> press your <<bottom>> against <<hisselect $anustarget>> mouth.</span>
				<<set $NPCList[$anustarget].mouth to "bottom">><<set $anususe to 0>><<bottomstat>><<neutral 5 $anustarget>><<set $anusstate to 0>><<set $bottomuse to "mouth">>
			<<else>>
				You try to keep the mouth menacing your anus at bay by pressing your <<bottom>> against it, but <<theowner>> has other ideas.
			<</if>>
		<</if>>

		<<if $anusaction is "bottomhandbay">>
			<<set $anusaction to 0>><<meek 1 $anustarget>><<bottomskilluse>><<set $anusactiondefault to "bottomhandbay">><<combatpromiscuity1>>
			<<if combatSkillCheck("bottom", $anustarget)>>
				<<set $cheekactiondefault to "handrub">>
				<<personselect $anustarget>>
				<span class="lblue">You <<bottomtext>> rub your clenched <<bottom>> cheeks against <<hisselect $anustarget>> hand.</span>
				<<if $NPCList[$anustarget].lefthand is "anusentrance">>
					<<set $NPCList[$anustarget].lefthand to "bottom">><<set $anususe to 0>><<bottomstat>><<neutral 5 $anustarget>><<set $anusstate to 0>><<set $bottomuse to "hand">>
				<<else>>
					<<set $NPCList[$anustarget].righthand to "bottom">><<set $anususe to 0>><<bottomstat>><<neutral 5 $anustarget>><<set $anusstate to 0>><<set $bottomuse to "hand">>
				<</if>>
			<<else>>
				You try to keep the finger menacing your anus at bay by clenching your <<bottom>> cheeks, but <<theowner>> has other ideas.
			<</if>>
		<</if>>

		<<if $anusaction is "othermouthtease">>
			<<set $anusaction to 0>><<set $anusactiondefault to "othermouthtease">><<actionsothermouthanustease $anustarget>><<sex 5 "anus">><<analskilluse>>
		<</if>>

		<<if $anusaction is "othermouthrub">>
			<<set $anusaction to 0>><<set $anusactiondefault to "othermouthrub">><<actionsothermouthanusrub $anustarget>><<sex 10 "anus">><<analskilluse>>
		<</if>>

		<<if $anusaction is "othermouthcooperate">>
			<<set $anusaction to 0>><<set $anusactiondefault to "othermouthcooperate">><<actionsothermouthanusthrust $anustarget>><<submission 20>><<analskilluse>>
		<</if>>

		<<if $anusaction is "handtease">>
			<<set $anusaction to 0>><<set $anusactiondefault to "handtease">><<actionshandanustease $anustarget>><<sex 5 "anus">><<analskilluse>>
		<</if>>

		<<if $anusaction is "handcooperate">>
			<<set $anusaction to 0>><<set $anusactiondefault to "handcooperate">><<actionshandanusthrust $anustarget>><<submission 20>><<analskilluse>>
		<</if>>

		<<if $anusaction is "othermouthescape">>
			<<set $anusaction to 0>><<set $anusactiondefault to "othermouthescape">><<actionsothermouthanusescape $anustarget>><<brat 10 $anustarget>>
			<<set $anususe to "othermouth">><<set $anusstate to "othermouthentrance">>
			<<if $NPCList[$anustarget].mouth is "anusimminent">>
				<<set $NPCList[$anustarget].mouth to "anusentrance">>
			<</if>>
		<</if>>

		<<if $anusaction is "penistease">>
			<<set $anusactiondefault to "penistease">><<set $cheekaction to 0>>
			You <<analtext>> tease the tip of the penis with your <<bottom>>.
			<<sex 3 "anus">><<analskilluse>>
		<</if>>

		<<if $anusaction is "penisdoubletease">>
			<<set $anusactiondefault to "penisdoubletease">><<set $cheekaction to 0>>
			You <<analtext>> tease their <<penises>> with your <<bottom>>.
			<<sex 3 "anus">><<analskilluse>>
		<</if>>

		<<if $anusaction is "rub">>
			<<set $anusaction to 0>><<set $anusactiondefault to "rub">><<actionsanusrub $anustarget>><<sex 10 "anus">>
			<<analskilluse>>
		<</if>>

		<<if $anusaction is "cooperate">>
			<<set $anusaction to 0>><<set $anusactiondefault to "cooperate">><<actionsanusthrust $anustarget>><<submission 15>><<analskilluse>>
		<</if>>

		<<if $anusaction is "penisEdging">>
			<<set $anusaction to 0>><<set $anusactiondefault to "penisEdging">><<actionsanusedging $anustarget>><<submission 5>><<sexControl 5 `currentSkillValue("analskill")` $anustarget>><<analskilluse>>
		<</if>>

		<<if $anusaction is "take">>
			<<set $anusaction to 0>><<set $anusactiondefault to "take">><<actionsanustake $anustarget>>
		<</if>>

		<<if $anusaction is "handtake">>
			<<set $anusaction to 0>><<set $anusactiondefault to "handtake">><<actionshandanustake $anustarget>>
		<</if>>

		<<if $anusaction is "doubletake">>
			<<set $anusaction to 0>><<set $anusactiondefault to "doubletake">><<actionsanusdoubletake>>
		<</if>>

		<<if $anusaction is "escape">><<set $anusaction to 0>><<set $anusactiondefault to "escape">><<actionsanusescape $anustarget>><<brat 10 $anustarget>><<set $anususe to "penis">><<set $anusstate to "entrance">>
			<<if $NPCList[$anustarget].penis is "anusimminent">>
				<<set $NPCList[$anustarget].penis to "anusentrance">><<set $NPCList[$anustarget].speechanusescape to 1>>
			<</if>>
		<</if>>

		<<if $anusaction is "penisdoubletease">>
			<<set $anusactiondefault to "penisdoubletease">><<set $cheekaction to 0>>
			<<if $NPCList[$anustarget].penis is "anusentrancedouble" and $NPCList[$anusdoubletarget].penis isnot "anusentrancedouble">>
				You tease <<if !($npc.includes($NPCList[$anustarget].fullDescription))>>the <</if>>$NPCList[$anustarget].fullDescription's tip
				while rubbing your bowel walls against <<if !($npc.includes($NPCList[$anusdoubletarget].fullDescription))>>the <</if>>$NPCList[$anusdoubletarget].fullDescription's $NPCList[$anusdoubletarget].penisdesc.
			<<elseif $NPCList[$anustarget].penis isnot "anusentrancedouble" and $NPCList[$anusdoubletarget].penis is "anusentrancedouble">>
				You tease <<if !($npc.includes($NPCList[$anusdoubletarget].fullDescription))>>the <</if>>$NPCList[$anusdoubletarget].fullDescription's tip
				while rubbing your bowel walls against <<if !($npc.includes($NPCList[$anustarget].fullDescription))>>the <</if>>$NPCList[$anustarget].fullDescription's $NPCList[$anustarget].penisdesc.
			<<else>>
				You tease both the tips with your <<bottom>>.<<sex 6 "anus">>
			<</if>>
			<<analskilluse>>
		<</if>>

		<<if $anusaction is "doubleescape">>
			<<set $anusaction to 0>><<set $anusactiondefault to "doubleescape">><<actionsanusdoubleescape $anustarget $anusdoubletarget>><<brat 10 $anustarget $anusdoubletarget>><<set $anususe to "penisdouble">><<set $anusstate to "doubleentrance">>
			<<set $enemyanger += 5>>
			<<set _otherNPCindex to "f">>
			<<set _actiontext to "You escape ">>
			<<set _npcA to $anustarget>>
			<<set _npcB to $anusdoubletarget>>

			<<if $NPCList[_npcA].penis is "anusimminentdouble">>
				<<set $NPCList[$anustarget].penis to "anusentrancedouble">><<set $NPCList[$anustarget].speechanusescape to 1>>

			<<elseif $NPCList[_npcA].penis is "anusentrancedouble" and random(0,3) is 0>> /* Chance to drop one of them and switch to regular anal */
				<<set _otherNPCindex to _npcB>><<set $NPCList[_npcA].location.genitals to 0>><<set $NPCList[_npcA].speechanusescape to 1>><<set $enemyanger += 15>>
				<<set $NPCList[_npcA].penis to 0>>
				<span class="green"> <<print _actiontext + ($npc_named isnot 1 ? "the " : "") + $NPCList[_npcA].fullDescription + "'s " + $NPCList[_npcA].penisdesc + ".">></span>
			<</if>>
			<<if $NPCList[_npcB].penis is "anusimminentdouble">>
				<<set $NPCList[_npcB].penis to "anusentrancedouble">><<set $NPCList[_npcB].speechanusescape to 1>>

			<<elseif $NPCList[_npcB].penis is "anusentrancedouble" and random(0,3) is 0>> /* Chance to drop one of them and switch to regular anal */
				<<set _otherNPCindex to _npcA>><<set $NPCList[_npcB].location.genitals to 0>><<set $NPCList[_npcB].speechanusescape to 1>><<set $enemyanger += 15>>
				<<set $NPCList[_npcB].penis to 0>>
				<span class="green"> <<print _actiontext + ($npc_named isnot 1 ? "the " : "") + $NPCList[_npcB].fullDescription + "'s " + $NPCList[_npcB].penisdesc + ".">></span>
			<</if>>

			<<if _otherNPCindex isnot "f" and $NPCList[_otherNPCindex].penis isnot 0 and $NPCList[_otherNPCindex].penis.includes("double")>>
				<<set $anususe to "penis">>
				<<switch $NPCList[_otherNPCindex].penis>>
					<<case "anusdouble">>
						<<set $NPCList[_otherNPCindex].penis to "anus">>
						<<set $anusstate to "penetrated">>
					<<case "anusentrancedouble">>
						<<set $NPCList[_otherNPCindex].penis to "anusentrance">>
						<<set $anusstate to "entrance">>
					<<case "anusimminentdouble">>
						<<set $NPCList[_otherNPCindex].penis to "anusimminent">>
						<<set $anusstate to "imminent">>
				<</switch>>
			<</if>>
		<</if>>

		<<if $anusaction is "doublecooperate">>
			<<set $anusaction to 0>><<set $anusactiondefault to "doublecooperate">><<actionsanusdoublethrust $anustarget $anusdoubletarget>><<submission 15>><<analskilluse>>
		<</if>>

		<<if $anusaction is "penisDoubleEdging">>
			<<set $anusaction to 0>><<set $anusactiondefault to "penisDoubleEdging">><<actionsanusdoubleedging $anustarget $anusdoubletarget>><<submission 5>><<sexControl 5 `currentSkillValue("analskill")` $anustarget $anusdoubletarget>><<analskilluse>>
		<</if>>

		<<if $anusaction is "doubletake">>
			<<set $anusaction to 0>><<set $anusactiondefault to "doubletake">><<actionsanusdoubletake $anustarget $anusdoubletarget>>
		<</if>>

		<<if $cheekaction is "rub" or $anusaction is "otherAnusRub">>
			<<if $cheekaction is "rub">>
				<<set $cheekaction to 0>>
			<</if>>
			<<if $anusaction is "otherAnusRub">>
				<<set $anusaction to 0>>
			<</if>>
			<<bottomskilluse>><<set $cheekactiondefault to "rub">>
			<<if combatSkillCheck("bottom", $anustarget)>>
				<<actionscheekrub $anustarget>><<set $cheekactiondefault to "rub">><<submission 3>><<bottomstat>>
			<<elseif $NPCList[$anustarget].penis is "cheeks">>
				<<set $cheekactiondefault to "cheeks">>
				<<personselect $anustarget>>
				<<set $NPCList[$anustarget].penis to "anusentrance">><<set $bottomuse to 0>><<set $anusstate to "entrance">>
				<span class="blue">You try to rub <<hisselect $anustarget>> penis between your cheeks, but <<he>> is not interested.</span>
			<</if>>
		<</if>>

		<<if $cheekaction is "stop" or $anusaction is "otherAnusStop" and $NPCList[$anustarget].penis is "cheeks">>
			<<if $cheekaction is "stop">>
				<<set $cheekaction to 0>>
			<</if>>
			<<if $anusaction is "otherAnusStop">>
				<<set $anusaction to 0>>
			<</if>>
			<<set $cheekaction to 0>><<set $cheekactiondefault to "stop">>
			<<personselect $anustarget>>
			<<set $NPCList[$anustarget].penis to "anusentrance">><<set $bottomuse to 0>><<set $anusstate to "entrance">>
			<span class="blue">You stop holding <<hisselect $anustarget>> penis between your cheeks. <<He>> angles <<his>> $NPCList[$anustarget].penisdesc toward your anus.</span>
		<</if>>

		<<if $cheekaction is "handrub" or $anusaction is "bottomhandbay">>
			<<set $cheekaction to 0>><<set $cheekactiondefault to "handrub">><<bottomskilluse>>
			<<if combatSkillCheck("bottom", $anustarget)>>
				<<set $cheekactiondefault to "handrub">><<bottomstat>><<sex 5 "anus">>
				<<actionsmouthbottomrub $anustarget>>
			<<else>>
				<<if $anususe is 0>>
					<<set $anususe to "hand">><<set $anusstate to "handentrance">><<set $anusactiondefault to "bottomhandbay">><<set $bottomuse to 0>>
					<<if $NPCList[$anustarget].lefthand is "anusentrance" or $NPCList[$anustarget].lefthand is "anus">>
						<<personselect $anustarget>><<set $NPCList[$anustarget].lefthand to "anusentrance">>
					<<else>>
						<<personselect $anustarget>><<set $NPCList[$anustarget].righthand to "anusentrance">>
					<</if>>
					<span class="blue">You press your <<bottom>> against <<hisselect $anustarget>> hand, but instead <<he>> shoves <<his>> fingers between your cheeks.</span>
				<<else>>
					<<if $NPCList[$anustarget].penis is "hand">>
						<<set $NPCList[$anustarget].penis to 0>>
					<</if>>
					<<if $NPCList[$anustarget].vagina is "hand">>
						<<set $NPCList[$anustarget].vagina to 0>>
					<</if>>
					<span class="lblue">You clench your <<bottom>> cheeks against <<hisselect $anustarget>> hand, but <<he>> moves <<his>> hand away from you.</span>
					<<if $NPCList[$anustarget].lefthand is "anus" or $NPCList[$anustarget].lefthand is "anusentrance">>
						<<set $NPCList[$anustarget].lefthand to 0>><<set $bottomuse to 0>><<set $NPCList[$anustarget].location.lefthand to 0>>
					<<else>>
						<<set $NPCList[$anustarget].righthand to 0>><<set $bottomuse to 0>><<set $NPCList[$anustarget].location.righthand to 0>>
					<</if>>
				<</if>>
			<</if>>
		<</if>>

		<<if $cheekaction is "handstop" or $anusaction is "handAnusStop">>
			<<set $cheekaction to 0>><<set $cheekactiondefault to "stop">><<set $bottomuse to 0>>
			<<if $anususe is 0>>
				<<if $NPCList[$anustarget].lefthand is "anus" or $NPCList[$anustarget].lefthand is "anusentrance">>
					<<personselect $anustarget>><<set $NPCList[$anustarget].lefthand to "anusentrance">><<set $anusstate to "handentrance">><<set $anususe to "hand">>
				<<else>>
					<<personselect $anustarget>><<set $NPCList[$anustarget].righthand to "anusentrance">><<set $anusstate to "handentrance">><<set $anususe to "hand">>
				<</if>>
				<span class="blue">You stop clenching your <<bottom>> cheeks, allowing <<hisselect $anustarget>> hand to reach your crack.</span>
			<<else>>
				<<personselect $anustarget>>
				<<if $NPCList[$anustarget].penis is "hand">>
					<<set $NPCList[$anustarget].penis to 0>>
				<</if>>
				<<if $NPCList[$anustarget].vagina is "hand">>
					<<set $NPCList[$anustarget].vagina to 0>>
				<</if>>
				<<if $NPCList[$anustarget].lefthand is "anus" or $NPCList[$anustarget].lefthand is "anusentrance">>
					<<set $NPCList[$anustarget].lefthand to 0>><<set $NPCList[$anustarget].location.lefthand to 0>>
				<<else>>
					<<set $NPCList[$anustarget].righthand to 0>><<set $NPCList[$anustarget].location.righthand to 0>>
				<</if>>
				<span class="blue">You stop clenching your <<bottom>> cheeks, allowing <<hisselect $anustarget>> hand to reach your crack.</span>
			<</if>>
		<</if>>

		<<if $cheekaction is "othermouthrub" or $anusaction is "otherMouthAnusRub">>
			<<set $cheekaction to 0>><<set $cheekactiondefault to "othermouthrub">><<bottomskilluse>>
			<<if combatSkillCheck("bottom", $anustarget)>>
				<<set $cheekactiondefault to "othermouthrub">><<bottomstat>><<sex 5 "anus">>
				<<actionsmouthbottomrub $anustarget>>
			<<elseif $NPCList[$anustarget].mouth is "bottom">>
				<<if $anususe is 0>>
					<<set $anususe to "othermouth">><<set $anusstate to "othermouthentrance">><<set $anusactiondefault to "bottombay">><<set $bottomuse to 0>>
					<<personselect $anustarget>><<set $NPCList[$anustarget].mouth to "anusentrance">>
					<span class="blue">You press your <<bottom>> against <<hisselect $anustarget>> mouth, but instead <<he>> moves <<his>> head between your cheeks.</span>
				<<else>>
					<<if $NPCList[$anustarget].penis is "othermouth">>
						<<set $NPCList[$anustarget].penis to 0>>
					<</if>>
					<<if $NPCList[$anustarget].vagina is "othermouth">>
						<<set $NPCList[$anustarget].vagina to 0>>
					<</if>>
					<span class="lblue">You press your <<bottom>> against <<hisselect $anustarget>> mouth, but <<he>> moves <<his>> head away from you.</span>
					<<set $NPCList[$anustarget].mouth to 0>><<set $bottomuse to 0>><<set $NPCList[$anustarget].location.head to 0>>
				<</if>>
			<</if>>
		<</if>>

		<<if ($cheekaction is "othermouthstop" or $anusaction is "otherMouthAnusStop") and $NPCList[$anustarget].mouth is "bottom">>
			<<set $cheekaction to 0>><<set $cheekactiondefault to "stop">><<set $bottomuse to 0>>
			<<if $anususe is 0>>
				<<personselect $anustarget>><<set $NPCList[$anustarget].mouth to "anusentrance">><<set $anusstate to "othermouthentrance">><<set $anususe to "othermouth">>
				<span class="blue">You stop pressing your <<bottom>> against <<hisselect $anustarget>> mouth.</span>
			<<else>>
				<<personselect $anustarget>>
				<<if $NPCList[$anustarget].penis is "othermouth">>
					<<set $NPCList[$anustarget].penis to 0>>
				<</if>>
				<<if $NPCList[$anustarget].vagina is "othermouth">>
					<<set $NPCList[$anustarget].vagina to 0>>
				<</if>>
				<<set $NPCList[$anustarget].mouth to 0>><<set $NPCList[$anustarget].location.head to 0>>
				<span class="blue">You stop pressing your <<bottom>> against <<hisselect $anustarget>> mouth.</span>
			<</if>>
		<</if>>

		<<effectsinsertions>>

		/***
		*    ███████ ██   ██ ███████  █████  ██   ██
		*      ███   ██   ██   ███   ██      ██   ██
		*      ███   ███████   ███   ██ ████ ███████
		*      ███   ██   ██   ███   ██   ██ ██   ██
		*      ███   ██   ██ ███████  █████  ██   ██
		*
		*/
		<<if $newtarget isnot undefined>>
			<<setnewtarget>>
		<</if>>

		<<if $thighaction is "rub">>
			<<set $thighaction to 0>><<thighskilluse>><<set $thighactiondefault to "rub">>
			<<if combatSkillCheck("thigh", $thightarget)>>
				<<set $thighactiondefault to "rub">><<actionsthighrub $thightarget>><<thighstat>><<sex 5 "genital" $thightarget>>
			<<elseif $NPCList[$thightarget].penis is "thighs">>
				<<set $thighactiondefault to "thighs">><<set $thighuse to 0>>
				<<if $vaginause is 0>><<set $vaginause to "penis">>
					<<personselect $thightarget>>
					<<set $NPCList[$thightarget].penis to "vaginaentrance">><<set $vaginastate to "entrance">>
					<span class="blue">You try to hold <<hisselect $thightarget>> penis between your thighs, but <<he>> instead angles it towards your <<genitals>>.</span>
				<<else>>
					<<personselect $thightarget>>
					<<set $NPCList[$thightarget].penis to 0>><<set $NPCList[$thightarget].location.genitals to 0>>
					<span class="blue">You try to hold <<hisselect $thightarget>> penis between your thighs, but <<he>> moves it away.</span>
				<</if>>
			<</if>>
		<</if>>

		<<if $thighaction is "stop" and $NPCList[$thightarget].penis is "thighs">>
			<<set $thighaction to 0>><<set $thighactiondefault to "stop">>
			You stop holding <<hisselect $thightarget>> penis between your thighs.
			<<set $thighuse to 0>>
			<<if $vaginause is 0>>
				<<personselect $thightarget>>
				<<set $NPCList[$thightarget].penis to "vaginaentrance">><<set $vaginastate to "entrance">><<set $vaginause to "penis">>
				<span class="blue"><<He>> angles towards your <<genitals>>.</span>
			<<else>>
				<<set $NPCList[$thightarget].penis to 0>><<set $NPCList[$thightarget].location.genitals to 0>>
			<</if>>
		<</if>>

		<<if $thighaction is "othermouthrub">>
			<<set $thighaction to 0>><<set $thighactiondefault to "othermouthrub">><<thighskilluse>>
			<<if combatSkillCheck("thigh", $thightarget)>>
				<<set $thighactiondefault to "othermouthrub">><<thighstat>><<sex 5 "genital" $thightarget>>
				<<actionsmouththighrub $thightarget>>
			<<elseif $NPCList[$thightarget].mouth is "thigh">>
				<<if $penisuse is 0 and (!$player.vaginaExist or $vaginause isnot 0 or random(0,100) gte 50)>>
					<<set $penisuse to "othermouth">><<set $penisstate to "othermouthentrance">><<set $penisactiondefault to "thighbay">><<set $thighuse to 0>>
					<<personselect $thightarget>>
					<<set $NPCList[$thightarget].mouth to "penisentrance">>
					<span class="blue">You press your thigh against <<hisselect $thightarget>> mouth, but <<he>> would prefer the main course and moves <<his>> head closer to your <<penis>>.</span>
				<<elseif $vaginause is 0>>
					<<set $vaginause to "othermouth">><<set $vaginastate to "othermouthentrance">><<set $vaginaactiondefault to "thighbay">><<set $thighuse to 0>>
					<<personselect $thightarget>>
					<<set $NPCList[$thightarget].mouth to "vaginaentrance">>
					<span class="blue">You press your thigh against <<hisselect $thightarget>> mouth, but <<he>> would prefer the main course and moves <<his>> head closer to your <<pussy>>.</span>
				<<else>>
					<<personselect $thightarget>>
					<<if $NPCList[$thightarget].penis is "othermouth">>
						<<set $NPCList[$thightarget].penis to 0>>
					<</if>>
					<<if $NPCList[$thightarget].vagina is "othermouth">>
						<<set $NPCList[$thightarget].vagina to 0>>
					<</if>>
					<span class="lblue">You press your thigh against <<hisselect $thightarget>> mouth, but <<he>> moves <<his>> head away from you.</span>
					<<set $NPCList[$thightarget].mouth to 0>><<set $thighuse to 0>><<set $NPCList[$thightarget].location.head to 0>>
				<</if>>
			<</if>>
		<</if>>

		<<if $thighaction is "othermouthstop" and $NPCList[$thightarget].mouth is "thigh">>
			<<set $thighaction to 0>><<set $thighactiondefault to "stop">><<set $thighuse to 0>>
			<<if $penisuse is 0 and (!$player.vaginaExist or $vaginause isnot 0 or random(0,100) gte 50)>>
				<<personselect $thightarget>><<set $NPCList[$thightarget].mouth to "penisentrance">><<set $penisstate to "othermouthentrance">><<set $penisuse to "othermouth">>
				<span class="blue">You stop pressing your thigh against <<hisselect $thightarget>> mouth.</span>
			<<elseif $vaginause is 0>>
				<<personselect $thightarget>><<set $NPCList[$thightarget].mouth to "vaginaentrance">><<set $vaginastate to "othermouthentrance">><<set $vaginause to "othermouth">>
				<span class="blue">You stop pressing your thigh against <<hisselect $thightarget>> mouth.</span>
			<<else>>
				<<personselect $thightarget>>
				<<if $NPCList[$thightarget].penis is "othermouth">>
					<<set $NPCList[$thightarget].penis to 0>>
				<</if>>
				<<if $NPCList[$thightarget].vagina is "othermouth">>
					<<set $NPCList[$thightarget].vagina to 0>>
				<</if>>
				<<set $NPCList[$thightarget].mouth to 0>><<set $NPCList[$thightarget].location.head to 0>>
				<span class="blue">You stop pressing your thigh against <<hisselect $thightarget>> mouth.</span>
			<</if>>
		<</if>>

		/***
		*    ███████ ██████ ██   ██ ███████ ███████
		*    ██   ██ ██     ███  ██   ███   ██
		*    ███████ ██████ ██ █ ██   ███   ███████
		*    ██      ██     ██  ███   ███        ██
		*    ██      ██████ ██   ██ ███████ ███████
		*
		*/
		<<if $newtarget isnot undefined>>
			<<setnewtarget>>
		<</if>>

		<<rng>>
		<<effectspenistovagina>>
		<<rng>>
		<<effectspenisvaginafuck>>
		<<rng>>
		<<effectspenisanusfuck>>
		<<rng>>
		<<effectspenistoanus>>
		<<rng>>
		<<effectspenistopenisfuck>>
		<<rng>>
		<<effectspenistopenis>>


		<<if $penisaction is "rest">>
			<<set $penisaction to 0>><<set $penisactiondefault to "rest">>
		<</if>>
		/* 北极星模组 */
		<<if $penisaction is "endure">>
			<<set $penisaction to 0>><<set $penisactiondefault to "endure">>
			<span class="lblue">你<<peniletext>>忍耐着阴茎传来的快感。</span>
		    <<set $arousal -= Math.trunc(200 + $penileskill)>><<penileskill 5>><<set $penileskillup to 1>>
		<</if>>
		/* 北极星 */

		<<if $penisaction is "bay" and $NPCList[$penistarget].vagina is "penisentrance">>
			<<set $penisaction to 0>><<meek 1 $penistarget>><<penileskilluse>><<set $penisactiondefault to "bay">><<combatpromiscuity4>>
			<<if combatSkillCheck("penile", $penistarget)>>
				<<set $penisactiondefault to "rub">>
				<<personselect $penistarget>>
				<span class="lblue">You <<peniletext>> press your penis against <<hisselect $penistarget>> clit.</span>
				<<set $NPCList[$penistarget].vagina to "frot">><<set $penisuse to "clit">><<sex 5 "genitals" $penistarget>><<set $penisstate to "clit">>
			<<else>>
				You try to keep the vagina menacing your <<penis>> at bay by rubbing against the clit, but <<theowner>> has other ideas.
			<</if>>
		<</if>>

		<<if $penisaction is "clitrub">><<set $penisaction to 0>><<set $penisactiondefault to "rub">><<penileskilluse>>
			<<if combatSkillCheck("penile", $penistarget)>>
				<<set $penisactiondefault to "rub">><<sex 5 "genitals" $penistarget>>
				<<actionsclitrub $penistarget>>
			<<elseif $NPCList[$penistarget].vagina is "frot">>
				<<set $penisactiondefault to "bay">>
				<<set $penisuse to "othervagina">><<set $penisstate to "entrance">>
				<<personselect $penistarget>>
				<<set $NPCList[$penistarget].vagina to "penisentrance">>
				<span class="blue">You rub your <<penis>> against <<hisselect $penistarget>> clit, but <<he>> would prefer the main course and moves <<his>> labia closer to your tip.</span>
			<</if>>
		<</if>>

		<<if $penisaction is "stop" and $NPCList[$penistarget].vagina is "frot">>
			<<set $penisaction to 0>><<set $penisactiondefault to "stop">>
			<<personselect $penistarget>>
			<<set $NPCList[$penistarget].vagina to "penisentrance">><<set $penisstate to "entrance">><<set $penisuse to "othervagina">>
			<span class="blue">You stop rubbing <<hisselect $penistarget>> clit with your <<penis>>.</span>
		<</if>>

		<<if $penisaction is "tease">>
			<<set $penisaction to 0>><<set $penisactiondefault to "tease">><<actionspussytease $penistarget>><<sex 5 "genitals">><<penileskilluse>>
		<</if>>

		<<if $penisaction is "rub">>
			<<set $penisaction to 0>><<set $penisactiondefault to "rub">><<actionspussyrub $penistarget>><<sex 10 "genitals" $penistarget>><<penileskilluse>>
		<</if>>

		<<if $penisaction is "cooperate">>
			<<set $penisaction to 0>><<set $penisactiondefault to "cooperate">><<actionspussythrust $penistarget>><<submission 20>><<penileskilluse>>
		<</if>>

		<<if $penisaction is "forceImpregnation">>
			<<set _npcForceImpregnation to true>>
			<<set $penisaction to 0>><<set $penisactiondefault to "cooperate">><<actionspussythrust $penistarget>><<submission 30>><<penileskilluse>><<arousal 1000 "penis">>
		<</if>>

		<<if $penisaction is "vaginaEdging">>
			<<set $penisaction to 0>><<set $penisactiondefault to "vaginaEdging">><<actionspussyedging $penistarget>><<submission 5>><<sexControl 5 `currentSkillValue("penileskill")` $penistarget>><<penileskilluse>>
		<</if>>

		<<if $penisaction is "take">>
			<<set $penisaction to 0>><<set $penisactiondefault to "take">><<actionspussytake $penistarget>>
		<</if>>

		<<if $penisaction is "escape" and $NPCList[$penistarget].vagina is "penisimminent">>
			<<set $penisaction to 0>><<set $penisactiondefault to "escape">><<actionspenisescape $penistarget>><<brat 10 $penistarget>><<set $penisuse to "othervagina">><<set $penisstate to "entrance">>
			<<personselect $penistarget>>
			<<set $NPCList[$penistarget].vagina to "penisentrance">><<set $NPCList[$penistarget].speechpenisescape to 1>>
		<</if>>

		<<if $penisaction is "pullOut">>
			<<set $penisaction to 0>><<set $penisactiondefault to "pullOut">><<penileskilluse>>
			<<sex 5 "genitals">><<brat 10 $penistarget>>
			<<set $_pullOutDif to Math.floor((100 - $NPCList[$penistarget].pregnancyAvoidance) * 15)>>
			<<if $leftleg is "bound" or $rightleg is "bound">>
				You try to pull out, <span class="red">but your bound legs prevent you from doing so.</span>
			<<elseif combatSkillCheck("penile", $penistarget, $_pullOutDif)>>
				<<personselect $penistarget>>
				<<if $penisstate is "penetrated">>
					<<if $NPCList[$penistarget].pregnancyAvoidance lte 15>>
						As you try to pull out, <span class="red"><<combatperson>> locks <<his>> legs around you!</span>
						<<if currentSkillValue('physique') gte random(1, 64000)>>
							<<set $penisstate to "entrance">>
							<<if $NPCList[$penistarget].vagina is "penis">>
								<<set $NPCList[$penistarget].vagina to "penisentrance">>However, you're able to <span class="green"> force yourself free,</span> and <<peniletext>> pull your <<penis>> from <<his>> pussy.
							<</if>>
						<<else>>
							You're prevented from pulling out!
						<</if>>
						<<sex 5 "genitals">>
					<<else>>
						<<set $penisstate to "entrance">>
						<<if $NPCList[$penistarget].vagina is "penis">>
							<<set $NPCList[$penistarget].vagina to "penisentrance">><span class="lblue">You <<peniletext>> pull your <<penis>> from <<his>> pussy.</span>
						<</if>>
					<</if>>
				<</if>>
				<<if $penisstate is "otheranus">>
					<<set $penisstate to "otheranusentrance">>
					<<if $NPCList[$penistarget].penis is "otheranus">>
						<<set $NPCList[$penistarget].penis to "otheranusentrance">><span class="lblue">You <<peniletext>> pull your <<penis>> from <<his>> anus.</span>
					<</if>>
				<</if>>
				<<if $penisstate is "othermouth">>
					<<set $penisstate to "othermouthentrance">>
					<<if $NPCList[$penistarget].mouth is "penis">>
						<<set $NPCList[$penistarget].mouth to "penisentrance">><span class="lblue">You <<peniletext>> pull your <<penis>> from <<his>> mouth.</span>
					<</if>>
				<</if>>
			<<else>>
				<<personselect $penistarget>>
				You try to pull out, but <span class="red">can't move away from <<him>>.</span>
			<</if>>
			<<set $NPCList[$penistarget].speechpenisescape to 1>>
		<</if>>

		<<if $penisaction is "fencingtease">>
			<<set $penisaction to 0>><<set $penisactiondefault to "fencingtease">><<actionsfencingtease $penistarget>><<sex 10 "genitals" $penistarget>><<penileskilluse>>
		<</if>>

		<<if $penisaction is "fencingcooperate">>
			<<set $penisaction to 0>><<set $penisactiondefault to "fencingcooperate">><<actionsfencingcooperate $penistarget>><<submission 20>><<penileskilluse>>
		<</if>>

		<<if $penisaction is "fencingtake">>
			<<set $penisaction to 0>><<set $penisactiondefault to "fencingtake">><<actionsfencingtake $penistarget>>
		<</if>>

		<<if $penisaction is "fencingrest">>
			<<set $penisaction to 0>><<set $penisactiondefault to "rest">>
		<</if>>

		<<if $penisaction is "fencingescape">>
			<<set $penisaction to 0>><<set $penisactiondefault to "fencingescape">><<actionsfencingescape $penistarget>><<brat 10 $penistarget>>
			<<if $penisstate is "otherpenis">>
				<<set $penisstate to "otherpenisimminent">>
			<<else>>
				<<set $penisstate to "otherpenisentrance">>
			<</if>>
			<<if $NPCList[$penistarget].penis is "penis">>
				<<set $NPCList[$penistarget].penis to "penisimminent">>
			<<elseif $NPCList[$penistarget].penis is "penisimminent">>
				<<set $NPCList[$penistarget].penis to "penisentrance">>
			<</if>>
		<</if>>

		<<if $penisaction is "otherpenisrub">>
			<<set $penisaction to 0>><<set $penisactiondefault to "otherpenisrub">><<actionsotherpenispenisrub $penistarget>><<sex 10 "genitals" $penistarget>><<penileskilluse>>
		<</if>>

		<<if $penisaction is "thighbay" and $NPCList[$penistarget].mouth is "penisentrance">>
			<<set $penisaction to 0>><<meek 1 $penistarget>><<thighskilluse>><<set $penisactiondefault to "thighbay">><<combatpromiscuity1>>
			<<if combatSkillCheck("thigh", $penistarget)>>
				<<set $thighactiondefault to "othermouthrub">>
				<<personselect $penistarget>>
				<span class="lblue">You <<thightext>> press your thigh against <<hisselect $penistarget>> mouth.</span>
				<<set $NPCList[$penistarget].mouth to "thigh">><<set $penisuse to 0>><<thighstat>><<neutral 5 $penistarget>><<set $penisstate to 0>><<set $thighuse to "mouth">>
			<<else>>
				You try to keep the mouth menacing your <<penis>> at bay by pressing your thigh against it, but <<theowner>> has other ideas.
			<</if>>
		<</if>>

		<<if $penisaction is "othermouthtease">>
			<<set $penisaction to 0>><<set $penisactiondefault to "othermouthtease">><<actionsothermouthpenistease $penistarget>><<sex 5 "genitals">><<penileskilluse>>
		<</if>>

		<<if $penisaction is "othermouthrub">>
			<<set $penisaction to 0>><<set $penisactiondefault to "othermouthrub">><<actionsothermouthpenisrub $penistarget>><<sex 10 "genitals" $penistarget>><<penileskilluse>>
		<</if>>

		<<if $penisaction is "othermouthcooperate">>
			<<set $penisaction to 0>><<set $penisactiondefault to "othermouthcooperate">><<actionsothermouthpenisthrust $penistarget>><<submission 20>><<penileskilluse>>
		<</if>>

		<<if $penisaction is "othermouthescape">>
			<<set $penisaction to 0>><<set $penisactiondefault to "othermouthescape">><<actionsothermouthpenisescape $penistarget>><<brat 10 $penistarget>>
			<<set $penisuse to "othermouth">><<set $penisstate to "othermouthentrance">>
			<<if $NPCList[$penistarget].mouth is "penisimminent">>
				<<set $NPCList[$penistarget].mouth to "penisentrance">>
			<</if>>
		<</if>>

		<<if $penisaction is "otheranusbay">>
			<<set $penisaction to 0>><<meek 1 $penistarget>><<penileskilluse>><<set $penisactiondefault to "otheranusbay">><<combatpromiscuity4>>
			<<if combatSkillCheck("penile", $penistarget)>>
				<<set $penisactiondefault to "otheranusrub">><<personselect $penistarget>>
				<<if $NPCList[$penistarget].vagina is "otheranusentrance">>
					<span class="lblue">You <<peniletext>> point your <<penis>> away from <<hisselect $penistarget>> anus, rubbing between <<his>> cheeks.</span>
					<<set $NPCList[$penistarget].vagina to "otheranusfrot">><<set $penisuse to "otheranusrub">><<sex 5 "genitals" $penistarget>><<set $penisstate to "otheranusrub">>
				<</if>>
				<<if $NPCList[$penistarget].penis is "otheranusentrance">>
					<span class="lblue">You <<peniletext>> point your <<penis>> away from <<hisselect $penistarget>> anus, rubbing between <<his>> cheeks.</span>
					<<set $NPCList[$penistarget].penis to "otheranusfrot">><<set $penisuse to "otheranusrub">><<sex 5 "genitals" $penistarget>><<set $penisstate to "otheranusrub">>
				<</if>>
			<<else>>
				You try to move your <<penis>> away from the anus pressing against it, but <<theowner>> has other ideas.
			<</if>>
		<</if>>

		<<if $penisaction is "otheranusrub">>
			<<set $penisaction to 0>><<set $penisactiondefault to "otheranusrub">><<penileskilluse>>
			<<if combatSkillCheck("penile", $penistarget)>>
				<<set $penisactiondefault to "otheranusrub">><<sex 5 "genitals" $penistarget>>
				<<actionsotheranusrub $penistarget>>
			<<else>>
				<<set $penisactiondefault to "otheranusbay">>
				<<set $penisuse to "otheranus">><<set $penisstate to "otheranusentrance">>
				<<personselect $penistarget>>
				<<if $NPCList[$penistarget].vagina is "otheranusfrot">>
					<<set $NPCList[$penistarget].vagina to "otheranusentrance">>
					<span class="blue">You rub your <<penisSimple>> between <<hisselect $penistarget>> cheeks, but <<he>> would prefer the main course and presses <<his>> anus against your tip.</span>
				<</if>>
				<<if $NPCList[$penistarget].penis is "otheranusfrot">>
					<<set $NPCList[$penistarget].penis to "otheranusentrance">>
					<span class="blue">You rub your <<penisSimple>> between <<hisselect $penistarget>> cheeks, but <<he>> would prefer the main course and presses <<his>> anus against your tip.</span>
				<</if>>
			<</if>>
		<</if>>

		<<if $penisaction is "otheranusstop">>
			<<set $penisaction to 0>><<set $penisactiondefault to "stop">>
			<<personselect $penistarget>>
			<<if $NPCList[$penistarget].vagina is "otheranusfrot">>
				<<set $NPCList[$penistarget].vagina to "otheranusentrance">><<set $penisstate to "otheranusentrance">><<set $penisuse to "otheranus">>
				<span class="blue">You stop rubbing your <<penis>> between <<hisselect $penistarget>> cheeks.</span>
			<</if>>
			<<if $NPCList[$penistarget].penis is "otheranusfrot">>
				<<set $NPCList[$penistarget].penis to "otheranusentrance">><<set $penisstate to "otheranusentrance">><<set $penisuse to "otheranus">>
				<span class="blue">You stop rubbing your <<penis>> between <<hisselect $penistarget>> cheeks.</span>
			<</if>>
		<</if>>

		<<if $penisaction is "otheranustease">>
			<<set $penisaction to 0>><<set $penisactiondefault to "otheranustease">><<actionsotheranustease $penistarget>><<sex 5 "genitals">><<penileskilluse>>
		<</if>>

		<<if $penisaction is "otheranuscooperate">>
			<<set $penisaction to 0>><<set $penisactiondefault to "otheranuscooperate">><<actionsotheranusthrust $penistarget>><<submission 20>><<penileskilluse>>
		<</if>>

		<<if $penisaction is "otheranusEdging">>
			<<set $penisaction to 0>><<set $penisactiondefault to "otheranusEdging">><<actionsotheranusedging $penistarget>><<submission 5>><<sexControl 5 `currentSkillValue("penileskill")` $penistarget>><<penileskilluse>>
		<</if>>

		<<if $penisaction is "otheranustake">>
			<<set $penisaction to 0>><<set $penisactiondefault to "otheranustake">><<actionsotheranustake $penistarget>>
		<</if>>

		<<if $penisaction is "otheranusescape">>
			<<set $penisaction to 0>><<set $penisactiondefault to "otheranusescape">><<actionsotheranusescape>><<brat 10 $penistarget>>
			<<set $penisuse to "otheranus">><<set $penisstate to "otheranusentrance">>
			<<if $NPCList[$penistarget].vagina is "otheranusimminent">>
				<<set $NPCList[$penistarget].vagina to "otheranusentrance">><<print '<<set $speechotheranusescape'+ ($penistarget + 1) +' to 1>>'>>
			<</if>>
			<<if $NPCList[$penistarget].penis is "otheranusimminent">>
				<<set $NPCList[$penistarget].penis to "otheranusentrance">><<print '<<set $speechotheranusescape'+ ($penistarget + 1) +' to 1>>'>>
			<</if>>
		<</if>>

		<<if $penisaction is "penisthighs"and $NPCList[$penistarget].penis is "penisentrance">>
			<<set $penisaction to 0>><<meek 1 $penistarget>><<thighskilluse>><<set $penisactiondefault to "penisthighs">><<combatpromiscuity4>>
			<<if combatSkillCheck("thigh", $penistarget)>>
				<<set $thighactiondefault to "rub">>
				<<personselect $penistarget>>
				<span class="lblue">You <<thightext>> grab <<hisselect $penistarget>> $NPCList[$penistarget].penisdesc between your thighs.</span>
				<<set $NPCList[$penistarget].penis to "thighs">><<set $thightarget to $penistarget>>
				<<set $penisuse to 0>><<set $thighuse to "penis">><<thighstat>><<sex 5 "genitals" $penistarget>><<set $penisstate to 0>>
			<<else>>
				You try to hold <<hisselect $penistarget>> penis between your thighs, but <<he>> is intent on your cock.
			<</if>>
		<</if>>

		<<if $penisaction is "penisanus" and ["penisentrance", "penisimminent"].includes($NPCList[$penistarget].penis)>>
			<<set $penisaction to 0>><<meek 5 $penistarget>><<analskilluse>><<set $penisactiondefault to "penisanus">>
			<<if combatSkillCheck("anal", $penistarget)>>
				<<personselect $penistarget>><<set $anustarget to $penistarget>>
				<span class="blue">You give your <<bottom>> a little wiggle, <<combatperson>> responds to the provocation and moves <<his>> <<npcPenis $penistarget>> in front of your butt.</span>
				<<if $NPCList[$penistarget].type is "plant" and $NPCList[$penistarget].penissize gte 4 and canImpregnateParasite("anus")>>
					<span class="red">Something about it scares you.</span>
				<</if>>
				<<submission 2>><<set $anususe to "penis">><<set $NPCList[$penistarget].penis to "anusentrance">><<set $penisuse to 0>><<set $anusstate to "entrance">><<set $penisstate to 0>>
			<<else>>
				You give your <<bottom>> a little wiggle, but you just receive a slap.
				<<violence 2>><<hitstat>><<bruise bottom>>
			<</if>>
		<</if>>

		<<rng>>
		<<if $penisaction is "penisanusdouble">>
			<<set $penisaction to 0>><<meek 5 $penistarget>><<analskilluse>>
			<<if combatSkillCheck("anal", $penistarget) and $anususe is "penis">>
				<<personselect $penistarget>><<set $penisactiondefault to "rest">>
				<span class="blue">You give your <<bottom>> a little wiggle, <<combatperson>> responds to the provocation and moves <<his>> penis to join the phallus in front of your butt.</span>
				<<submission 2>><<set $anususe to "penisdouble">><<set $NPCList[$penistarget].penis to "anusentrancedouble">><<set $penisuse to 0>><<set $anusstate to "doubleentrance">><<set $penisstate to 0>>
				<<set $anusdoubletarget to $penistarget>>
				<<if $NPCList[$anustarget].penis is "anus">>
					<<set $NPCList[$anustarget].penis to "anusdouble">>
				<<elseif $NPCList[$anustarget].penis is "anusimminent">>
					<<set $NPCList[$anustarget].penis to "anusimminentdouble">>
				<<elseif $NPCList[$anustarget].penis is "anusentrance">>
					<<set $NPCList[$anustarget].penis to "anusentrancedouble">>
				<<elseif $NPCList[$anustarget].penis is "cheeks">>
					<<set $NPCList[$anustarget].penis to "anusentrance">>
					<<set $bottomuse to 0>> /* Issues with ass cheeks likely stem from this culprit right here */
				<</if>>
				<<set $NPCList[$anustarget].location.genitals to "genitals">>
			<<else>>
				You give your <<bottom>> a little wiggle, but you just receive a slap.
				<<violence 2>><<hitstat>><<bruise bottom>><<set $penisactiondefault to "penisanusdouble">>
			<</if>>
		<</if>>

		<<if $penisaction is "penispussy">>
			<!-- Check the player is not attempting to straddle and offer pussy at the same time. If so, switch to double or fail correctly -->
			<<if $vaginastate isnot 0 and !$vaginastate.includes("double") and ($vaginastate is "entrance" or $vaginastate is "imminent" or $vaginastate is "penetrated")>>
				<!-- Note that this action requires "penispussydouble" to come after "penispussy", else it will not work as expected -->
				<<if random(0,2) isnot 0 and $vaginaldoubledisable is "f">>
					<<set $penisaction to "penispussydouble">>
				<<else>>
					You spread your thighs, but fail to garner further interest.
				<</if>>
			<<elseif $vaginastate isnot 0 and $vaginastate.includes("double")>>
				You spread your thighs, but just receive a slap. "Settle down, <<bitch>>."
				<<violence 2>><<hitstat>><<bruise bottom>>
			<<elseif ["penisentrance", "penisimminent"].includes($NPCList[$penistarget].penis)>>
				<<set $penisaction to 0>><<meek 10 $penistarget>><<penileskill>><<set $penisactiondefault to "penispussy">>
				<<if combatSkillCheck("vaginal", $penistarget)>>
					<<personselect $penistarget>>
					<<submission 2>><<set $vaginause to "penis">><<set $NPCList[$penistarget].penis to "vaginaentrance">><<set $penisuse to 0>>
					<<set $vaginastate to "entrance">><<set $penisstate to 0>><<set $vaginatarget to $penistarget>><<set $penistarget to 0>>
					<span class="lblue">You spread your thighs, giving clear access to your pussy, and <<combatperson>> takes advantage and moves <<his>> penis away from your <<penis>>.</span>
				<<else>>
					You spread your thighs, but fail to garner interest.
				<</if>>
			<</if>>
		<</if>>

		<<rng>>
		<<if $penisaction is "penispussydouble">>
			<<set $penisaction to 0>><<meek 10>><<penileskilluse>><<set $penisactiondefault to "penispussydouble">>
			<<if combatSkillCheck("vaginal", $penistarget) and $vaginause is "penis">>
				<<for _j = 0; _j lt $enemyno; _j++>>
					<<if $NPCList[_j].penis is "penisentrance" or $NPCList[_j].penis is "penisimminent">>
						<<personselect _j>>
						<<submission 2>><<set $vaginause to "penisdouble">><<set $NPCList[_j].penis to "vaginaentrancedouble">><<set $penisuse to 0>><<set $vaginastate to "doubleentrance">><<set $penisstate to 0>>
						<span class="lblue">You spread your thighs, giving clear access to your pussy, and <<combatperson>> takes advantage and moves <<his>> penis away from your <<penis>> to join the phallus in front of your pussy.</span>

						<<set $vaginatarget to _n>>
						<<set $vaginadoubletarget to "f">>
						<<for _k = 0; _k lt $enemyno; _k++>>
							<<if $NPCList[_k].penis is "vagina">>
								<<set $NPCList[_k].penis to "vaginadouble">>
								<<set $vaginadoubletarget to _k>>
								<<break>>
							<<elseif $NPCList[_k].penis is "vaginaimminent">>
								<<set $NPCList[_k].penis to "vaginaimminentdouble">>
								<<set $vaginadoubletarget to _k>>
								<<break>>
							<<elseif $NPCList[_k].penis is "vaginaentrance">>
								<<set $NPCList[_k].penis to "vaginaentrancedouble">>
								<<set $vaginadoubletarget to _k>>
								<<break>>
							<</if>>
						<</for>>
						<<break>>
					<</if>>
				<</for>>
			<<else>>
				You spread your thighs, but fail to garner interest.
			<</if>>
		<</if>>

		<<if $penisaction is "strokerCooperate">>
			<<set $penisaction to 0>><<set $penisactiondefault to "strokerCooperate">><<actionsStrokerCooperate $penistarget>><<submission 20>>
		<</if>>
		<<if $penisaction is "strokerRest">>
			<<set $penisaction to 0>><<set $penisactiondefault to "strokerRest">><<actionsStrokerRest $penistarget>><<neutral 5>>
		<</if>>

		/***
		*     ██████ ██   ██ ███████ ███████ ███████
		*    ██      ██   ██ ██      ██        ███
		*    ██      ███████ ███████ ███████   ███
		*    ██      ██   ██ ██           ██   ███
		*     ██████ ██   ██ ███████ ███████   ███
		*
		*/
		<<if $newtarget isnot undefined>>
			<<setnewtarget>>
		<</if>>

		<<if $chestaction is "rub">>
			<<set $chestaction to 0>><<set $chestactiondefault to "rub">>
			<<if combatSkillCheck("chest", $chesttarget)>>
				<<if $player.breastsize is 0>>
					You <<chesttext>> rub your <<breasts>> against <<hisselect $chesttarget>> penis.
				<<else>>
					You <<chesttext>> rub <<hisselect $chesttarget>> penis between your <<breasts>>.
				<</if>>
				<<submission 3>><<chestskilluse>>
			<<elseif $NPCList[$chesttarget].penis is "chest">>
				<<set $chestuse to 0>><<personselect $chesttarget>>
				<<if $mouthuse is 0>>
					<<set $mouthactiondefault to "grasp">><<set $mouthstate to "entrance">><<set $mouthuse to "penis">>
					<<set $NPCList[$chesttarget].penis to "mouthentrance">>
					<span class="purple">You try to rub your <<breasts>> against <<hisselect $chesttarget>> $NPCList[$chesttarget].penisdesc, but <<he>> moves <<his>> penis to your mouth.</span>
				<<else>>
					<<set $NPCList[$chesttarget].penis to 0>>
					<span class="blue">You try to rub your <<breasts>> against <<hisselect $chesttarget>> penis, but <<he>> pulls away.</span>
				<</if>>
			<</if>>
		<</if>>

		<<if $chestaction is "stop" and $NPCList[$chesttarget].penis is "chest">>
			<<set $chestuse to 0>><<set $chestaction to 0>><<personselect $chesttarget>><<personselect $chesttarget>>
			<<if $mouthuse is 0>>
				<<set $mouthactiondefault to "grasp">><<set $mouthstate to "entrance">><<set $mouthuse to "penis">>
				<<set $NPCList[$chesttarget].penis to "mouthentrance">>
				<span class="purple">As you stop rubbing, <<combatperson>> moves <<his>> penis to your mouth.</span>
			<<else>>
				<<set $NPCList[$chesttarget].penis to 0>>
				<span class="blue">As you stop rubbing, <<combatperson>> pulls away.</span>
			<</if>>
		<</if>>

		<<set $NPCList[0].intro to 0>>
		<<set $NPCList[1].intro to 0>>
		<<set $NPCList[2].intro to 0>>
		<<set $NPCList[3].intro to 0>>
		<<set $NPCList[4].intro to 0>>
		<<set $NPCList[5].intro to 0>>

		<<combat_lewdity_text>>

	</div>
<</widget>>

<<widget "useLube">>
	<<set $_lube to $player.inventory.sextoys["lube"][0]>>
	<<set $_lube.uses -= 1>>
	<<run console.log("using lube? " + V.player.inventory.sextoys["lube"][0].name + " " + V.player.inventory.sextoys["lube"][0].uses)>>
	<<if $_lube.uses lte 0>>
		<<run V.player.inventory.sextoys["lube"].splice(0,1)>>
		<<run console.log("used up all the lube")>>
		You squeeze the last of the lube out of the bottle.
	<</if>>
<</widget>>

<<widget "wheeze">>
	<<set _action to _args[0] or "say something">>
	<<switch _args[1]>>
		<<case 1>>
			You try to _action, <span class="purple">but only a wheeze comes out because you are already being choked.</span>
		<<case 2>>
			You try to _action, <span class="lewd">but only a lewd moan comes out because the hand around your throat prevents you from talking.</span>
		<<default>>
			You try to _action, <span class="red">but only a choked wheeze comes out because of the hand squeezing your throat.</span><<gwillpower>><<willpower 1>>
			<<set $speechwheeze to 1>>
	<</switch>>
<</widget>>

<<widget "effectsinsertions">>
	/* Check anal toy insertions */
	<<set _insertions to []>>
	<<for _i = 0; _i < $NPCList.length; _i++>>
		<<if $NPCList[_i].lefthand is "anusdildo">>
			<<personselect _i>>
			<<if $npc_named is 1>>
				<<set _npcDescription to $NPCList[_i].fullDescription>>
			<<else>>
				<<set _npcDescription to "the "+$NPCList[_i].fullDescription>>
			<</if>>
			<<set _insertions.push(_npcDescription + "'s " + $NPCList[_i].lefttool)>>
		<</if>>
		<<if $NPCList[_i].righthand is "anusdildo">>
			<<personselect _i>>
			<<if $npc_named is 1>>
				<<set _npcDescription to $NPCList[_i].fullDescription>>
			<<else>>
				<<set _npcDescription to "the "+$NPCList[_i].fullDescription>>
			<</if>>
			<<set _insertions.push(_npcDescription + "'s " + $NPCList[_i].righttool)>>
		<</if>>
	<</for>>
	<<if _insertions isnot undefined>>
		<<if _insertions.length gte 2>>
			Your anus is fucked by the sex toys<<if playerHasButtPlug()>>, rubbing against your $worn.butt_plug.name<</if>>.
		<<elseif _insertions.length is 1>>
			Your anus is fucked by _insertions[0]<<if playerHasButtPlug()>>, rubbing against your $worn.butt_plug.name<</if>>.
		<</if>>
	<</if>>
	/* Check vaginal toy insertions */
	<<if $player.vaginaExist>>
		<<set _insertions to []>>
		<<for _i = 0; _i < $NPCList.length; _i++>>
			<<if $NPCList[_i].lefthand is "vaginadildo">>
				<<personselect _i>>
				<<if $npc_named is 1>>
					<<set _npcDescription to $NPCList[_i].fullDescription>>
				<<else>>
					<<set _npcDescription to "the "+$NPCList[_i].fullDescription>>
				<</if>>
				<<set _insertions.push(_npcDescription + "'s " + $NPCList[_i].lefttool)>>
			<</if>>
			<<if $NPCList[_i].righthand is "vaginadildo">>
				<<set _insertions.push($NPCList[_i].righttool)>>
			<</if>>
		<</for>>
		<<if _insertions isnot undefined>>
			<<if _insertions.length gte 2>>
				Your <<pussy>> is fucked by the sex toys.
			<<elseif _insertions.length is 1>>
				Your <<pussy>> is fucked by the _insertions[0].
			<</if>>
		<</if>>
	<</if>>
	<<if $player.penisExist>>
		/* Dildo rubbing on penis */
		<<for _i = 0; _i < $NPCList.length; _i++>>
			<<if $NPCList[_i].lefthand is "penisdildo">>
				Your <<penis>> is rubbed by the $NPCList[_i].lefttool.
				<<break>>
			<</if>>
			<<if $NPCList[_i].righthand is "penisdildo">>
				Your <<penis>> is rubbed by the $NPCList[_i].righttool.
				<<break>>
			<</if>>
		<</for>>
	<</if>>
<</widget>>
